# Changelog

All notable changes to Azure Pipeline Studio will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.0.5] - 2025-12-20

### Changed
- Updated pre-commit configuration to use local repo and WSL path for formatter
- Improved Node App launch configuration for WSL compatibility

### Fixed
- Ensured extension-bundle.js is excluded from pre-commit formatting
- Cleaned up devDependencies and removed unused Babel and loader packages

[1.0.5]: https://github.com/HPInc/azure-pipeline-studio/releases/tag/v1.0.5

## [1.0.4] - 2025-12-20

### Changed
- Webpack minimization is now enabled safely for CLI bundles (Terser with reserved names)
- Removed all Babel-related dependencies and loaders for a cleaner, faster build
- Improved CLI bundle reliability and output consistency
- Updated image

### Fixed
- Fixed expansion in Standard mode
- CLI bundle now works identically to the raw extension.js

[1.0.4]: https://github.com/HPInc/azure-pipeline-studio/releases/tag/v1.0.4

## [1.0.3] - 2025-12-19

### Added
- **Expand Pipeline (Azure Compatible)** command - explicit Azure DevOps-compatible output formatting
- `azureCompatible` setting - controls literal blocks (|), capitalized booleans, trailing blank lines
- Quote preservation through template expansion with context-aware tracking
- `condition: false` added to `checkout: none` for Azure DevOps compatibility
- Test coverage for block scalars, quote preservation, boolean capitalization, and Azure compatibility

### Changed
- **Menu UI**: Removed "Azure Pipeline Studio:" prefix from all commands for cleaner appearance
- Renamed "Show Rendered YAML" â†’ "Expand Pipeline (Standard)"
- Removed ANTLR dependency - now uses pure `yaml` package for all parsing (~1,300 lines removed)
- Simplified build process - direct webpack output, no dist folder copying
- Azure-specific transformations (literal blocks, blank lines) now only apply when `azureCompatible: true`

### Fixed
- Heredocs/scripts with `${{ }}` expressions use literal style (|) in standard mode to preserve formatting
- Trailing spaces in multi-line scalars handled with double-quoted format
- Nested conditional directives in arrays properly resolved
- Quote styles preserved through multi-level template expansion

[1.0.3]: https://github.com/HPInc/azure-pipeline-studio/releases/tag/v1.0.3

## [1.0.2] - 2025-12-11

### Added
- Enhanced template parameter validation with type checking (string, number, boolean, object, step, stepList, stage, stageList, job, jobList, deployment, deploymentList)
- Added validation for allowed parameter values when `values` array is defined
- Template stack tracking for better error reporting in nested template calls
- Comprehensive idempotency test suite for real-world pipeline files
- Test coverage for multi-line block blank line handling
- Test coverage for trailing comments formatting behavior
- Updated menu screenshot showing context menu options
- Enhanced demo pipeline with build and deploy job examples

### Fixed
- Fixed formatter idempotency issues with blank lines in steps sections
- Resolved trailing comments spacing that was adding extra blank lines on each format pass
- Fixed blank line handling in multi-line blocks (bash: |, script: |) to prevent oscillation
- Improved trailing comments rule to ensure exactly one blank line before EOF comments

[1.0.2]: https://github.com/HPInc/azure-pipeline-studio/releases/tag/v1.0.2

## [1.0.1] - 2025-12-09

### Added
- Automatic validation to ensure all required template parameters (those without default values) are provided when calling a template
- Validates passed parameters aganist the allowed values for a parameter, when defined in parameters with values

### Fixed
- Fixed template parameter handling when runtime variables are passed through template chains
- Fixed issue where compile-time expressions using runtime variable parameters would evaluate incorrectly

[1.0.1]: https://github.com/HPInc/azure-pipeline-studio/releases/tag/v1.0.1

## [1.0.0] - 2025-12-03

### Added
- Initial release of Azure Pipeline Studio
- Template expansion with repository resources support
- Complete Azure DevOps expression support (33 functions across ${{ }}, $[], $() formats)
- Advanced YAML formatting with customizable options:
  - Configurable indentation (1-8 spaces)
  - Line width control
  - Array indentation options
  - Step spacing between pipeline elements
  - Section spacing with `blankLinesBetweenSections` (0-4) and `firstBlockBlankLines` (0-4)
- Modern yaml package (v2.x) with native comment preservation
- CLI tool with batch processing and recursive formatting
- Pre-commit hook integration for automated formatting
- VS Code extension with:
  - Side-by-side YAML rendering
  - Format on save support
  - Repository location configuration
  - Context menu integration
- File-level formatting directives (# ado-yaml-format)
- Comprehensive test suite with 57 tests covering:
  - YAML parsing and formatting
  - Expression evaluation
  - Template expansion
  - Edge cases and error handling

### Changed
- Refactored code into separate modules (formatter.js, utils.js, extension.js)
- Improved section spacing logic for cleaner pipeline formatting
- Updated maximum blank line ranges from 0-6 to 0-4 for better consistency

### Fixed
- Correct section spacing logic for Azure Pipeline YAML formatter
- Proper handling of template expressions and conditional blocks
- Empty value preservation in formatted output

[1.0.0]: https://github.com/HPInc/azure-pipeline-studio/releases/tag/v1.0.0
