resources:
  repositories:
  - repository: self
    type: git
    name: MyProject/MyRepo

variables:
- name: buildConfiguration
  value: Release
- name: targetEnvironment
  value: production

stages:
- stage: Build
  displayName: Build Stage

  jobs:
  - job: BuildJob
    displayName: Build Job

    steps:
    # Call build template with preSteps that reference another template via @self
    - template: build-template.yml@self
      parameters:
        buildConfig: $(buildConfiguration)
        preSteps:

        - template: nested-template.yml@self
          parameters:
            environment: $(targetEnvironment)
