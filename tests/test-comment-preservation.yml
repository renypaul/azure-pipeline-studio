parameters:
- name: terraformVersion
  type: string
  default: 1.0.0
- name: postPRMessage
  type: boolean
  default: false


steps:
# This comment should be preserved
- bash: |
    terraform validate
  displayName: Validate Terraform
  failOnStderr: true
  # Comment on PR if previous command fails

- ${{ if eq(parameters.postPRMessage, True) }}:
  - task: GitHubComment@0
    displayName: Post PR Comment
    inputs:
      gitHubConnection: github-connection
      repositoryName: repo-name
      comment: Validation failed
  # Final cleanup step

- bash: echo "Done"
  displayName: Cleanup
