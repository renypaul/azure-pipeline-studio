#!/usr/bin/env node
(()=>{var e={18:(e,t,s)=>{"use strict";var n=s(484),r=s(9714),i=s(1755),o=s(6010),a=s(7434),c=s(483),l=s(2291);function resolveCollection(e,t,s,n,r,i){const o="block-map"===s.type?a.resolveBlockMap(e,t,s,n,i):"block-seq"===s.type?c.resolveBlockSeq(e,t,s,n,i):l.resolveFlowCollection(e,t,s,n,i),u=o.constructor;return"!"===r||r===u.tagName?(o.tag=u.tagName,o):(r&&(o.tag=r),o)}t.composeCollection=function composeCollection(e,t,s,a,c){const l=a.tag,u=l?t.directives.tagName(l.source,e=>c(l,"TAG_RESOLVE_FAILED",e)):null;if("block-seq"===s.type){const{anchor:e,newlineAfterProp:t}=a,s=e&&l?e.offset>l.offset?e:l:e??l;if(s&&(!t||t.offset<s.offset)){c(s,"MISSING_CHAR","Missing newline after block sequence props")}}const p="block-map"===s.type?"map":"block-seq"===s.type?"seq":"{"===s.start.source?"map":"seq";if(!l||!u||"!"===u||u===i.YAMLMap.tagName&&"map"===p||u===o.YAMLSeq.tagName&&"seq"===p)return resolveCollection(e,t,s,c,u);let f=t.schema.tags.find(e=>e.tag===u&&e.collection===p);if(!f){const n=t.schema.knownTags[u];if(n?.collection!==p)return n?c(l,"BAD_COLLECTION_TYPE",`${n.tag} used for ${p} collection, but expects ${n.collection??"scalar"}`,!0):c(l,"TAG_RESOLVE_FAILED",`Unresolved tag: ${u}`,!0),resolveCollection(e,t,s,c,u);t.schema.tags.push(Object.assign({},n,{default:!1})),f=n}const h=resolveCollection(e,t,s,c,u,f),d=f.resolve?.(h,e=>c(l,"TAG_RESOLVE_FAILED",e),t.options)??h,m=n.isNode(d)?d:new r.Scalar(d);return m.range=h.range,m.tag=u,f?.format&&(m.format=f.format),m}},81:(e,t,s)=>{"use strict";var n=s(484),r=s(3793),i=s(248);function stringifyBlockCollection({comment:e,items:t},s,{blockItemPrefix:o,flowChars:a,itemIndent:c,onChompKeep:l,onComment:u}){const{indent:p,options:{commentString:f}}=s,h=Object.assign({},s,{indent:c,type:null});let d=!1;const m=[];for(let e=0;e<t.length;++e){const a=t[e];let l=null;if(n.isNode(a))!d&&a.spaceBefore&&m.push(""),addCommentBefore(s,m,a.commentBefore,d),a.comment&&(l=a.comment);else if(n.isPair(a)){const e=n.isNode(a.key)?a.key:null;e&&(!d&&e.spaceBefore&&m.push(""),addCommentBefore(s,m,e.commentBefore,d))}d=!1;let u=r.stringify(a,h,()=>l=null,()=>d=!0);l&&(u+=i.lineComment(u,c,f(l))),d&&l&&(d=!1),m.push(o+u)}let g;if(0===m.length)g=a.start+a.end;else{g=m[0];for(let e=1;e<m.length;++e){const t=m[e];g+=t?`\n${p}${t}`:"\n"}}return e?(g+="\n"+i.indentComment(f(e),p),u&&u()):d&&l&&l(),g}function stringifyFlowCollection({items:e},t,{flowChars:s,itemIndent:o}){const{indent:a,indentStep:c,flowCollectionPadding:l,options:{commentString:u}}=t;o+=c;const p=Object.assign({},t,{indent:o,inFlow:!0,type:null});let f=!1,h=0;const d=[];for(let s=0;s<e.length;++s){const a=e[s];let c=null;if(n.isNode(a))a.spaceBefore&&d.push(""),addCommentBefore(t,d,a.commentBefore,!1),a.comment&&(c=a.comment);else if(n.isPair(a)){const e=n.isNode(a.key)?a.key:null;e&&(e.spaceBefore&&d.push(""),addCommentBefore(t,d,e.commentBefore,!1),e.comment&&(f=!0));const s=n.isNode(a.value)?a.value:null;s?(s.comment&&(c=s.comment),s.commentBefore&&(f=!0)):null==a.value&&e?.comment&&(c=e.comment)}c&&(f=!0);let l=r.stringify(a,p,()=>c=null);s<e.length-1&&(l+=","),c&&(l+=i.lineComment(l,o,u(c))),!f&&(d.length>h||l.includes("\n"))&&(f=!0),d.push(l),h=d.length}const{start:m,end:g}=s;if(0===d.length)return m+g;if(!f){const e=d.reduce((e,t)=>e+t.length+2,2);f=t.options.lineWidth>0&&e>t.options.lineWidth}if(f){let e=m;for(const t of d)e+=t?`\n${c}${a}${t}`:"\n";return`${e}\n${a}${g}`}return`${m}${l}${d.join(" ")}${l}${g}`}function addCommentBefore({indent:e,options:{commentString:t}},s,n,r){if(n&&r&&(n=n.replace(/^\n+/,"")),n){const r=i.indentComment(t(n),e);s.push(r.trimStart())}}t.stringifyCollection=function stringifyCollection(e,t,s){return(t.inFlow??e.flow?stringifyFlowCollection:stringifyBlockCollection)(e,t,s)}},132:e=>{"use strict";class Jsep{static get version(){return"1.4.0"}static toString(){return"JavaScript Expression Parser (JSEP) v"+Jsep.version}static addUnaryOp(e){return Jsep.max_unop_len=Math.max(e.length,Jsep.max_unop_len),Jsep.unary_ops[e]=1,Jsep}static addBinaryOp(e,t,s){return Jsep.max_binop_len=Math.max(e.length,Jsep.max_binop_len),Jsep.binary_ops[e]=t,s?Jsep.right_associative.add(e):Jsep.right_associative.delete(e),Jsep}static addIdentifierChar(e){return Jsep.additional_identifier_chars.add(e),Jsep}static addLiteral(e,t){return Jsep.literals[e]=t,Jsep}static removeUnaryOp(e){return delete Jsep.unary_ops[e],e.length===Jsep.max_unop_len&&(Jsep.max_unop_len=Jsep.getMaxKeyLen(Jsep.unary_ops)),Jsep}static removeAllUnaryOps(){return Jsep.unary_ops={},Jsep.max_unop_len=0,Jsep}static removeIdentifierChar(e){return Jsep.additional_identifier_chars.delete(e),Jsep}static removeBinaryOp(e){return delete Jsep.binary_ops[e],e.length===Jsep.max_binop_len&&(Jsep.max_binop_len=Jsep.getMaxKeyLen(Jsep.binary_ops)),Jsep.right_associative.delete(e),Jsep}static removeAllBinaryOps(){return Jsep.binary_ops={},Jsep.max_binop_len=0,Jsep}static removeLiteral(e){return delete Jsep.literals[e],Jsep}static removeAllLiterals(){return Jsep.literals={},Jsep}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new Jsep(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(e=>e.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return Jsep.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!Jsep.binary_ops[String.fromCharCode(e)]||Jsep.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return Jsep.isIdentifierStart(e)||Jsep.isDecimalDigit(e)}throwError(e){const t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(Jsep.hooks[e]){const s={context:this,node:t};return Jsep.hooks.run(e,s),s.node}return t}searchHook(e){if(Jsep.hooks[e]){const t={context:this};return Jsep.hooks[e].find(function(e){return e.call(t.context,t),t.node}),t.node}}gobbleSpaces(){let e=this.code;for(;e===Jsep.SPACE_CODE||e===Jsep.TAB_CODE||e===Jsep.LF_CODE||e===Jsep.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");const e=this.gobbleExpressions(),t=1===e.length?e[0]:{type:Jsep.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t,s,n=[];for(;this.index<this.expr.length;)if(t=this.code,t===Jsep.SEMCOL_CODE||t===Jsep.COMMA_CODE)this.index++;else if(s=this.gobbleExpression())n.push(s);else if(this.index<this.expr.length){if(t===e)break;this.throwError('Unexpected "'+this.char+'"')}return n}gobbleExpression(){const e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,Jsep.max_binop_len),t=e.length;for(;t>0;){if(Jsep.binary_ops.hasOwnProperty(e)&&(!Jsep.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!Jsep.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,s,n,r,i,o,a,c;if(i=this.gobbleToken(),!i)return i;if(t=this.gobbleBinaryOp(),!t)return i;for(r={value:t,prec:Jsep.binaryPrecedence(t),right_a:Jsep.right_associative.has(t)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+t),n=[i,r,o];t=this.gobbleBinaryOp();){if(s=Jsep.binaryPrecedence(t),0===s){this.index-=t.length;break}r={value:t,prec:s,right_a:Jsep.right_associative.has(t)},c=t;const comparePrev=e=>r.right_a&&e.right_a?s>e.prec:s<=e.prec;for(;n.length>2&&comparePrev(n[n.length-2]);)o=n.pop(),t=n.pop().value,i=n.pop(),e={type:Jsep.BINARY_EXP,operator:t,left:i,right:o},n.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+c),n.push(r,e)}for(a=n.length-1,e=n[a];a>1;)e={type:Jsep.BINARY_EXP,operator:n[a-1].value,left:n[a-2],right:e},a-=2;return e}gobbleToken(){let e,t,s,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(e=this.code,Jsep.isDecimalDigit(e)||e===Jsep.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===Jsep.SQUOTE_CODE||e===Jsep.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(e===Jsep.OBRACK_CODE)n=this.gobbleArray();else{for(t=this.expr.substr(this.index,Jsep.max_unop_len),s=t.length;s>0;){if(Jsep.unary_ops.hasOwnProperty(t)&&(!Jsep.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!Jsep.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=s;const e=this.gobbleToken();return e||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:Jsep.UNARY_EXP,operator:t,argument:e,prefix:!0})}t=t.substr(0,--s)}Jsep.isIdentifierStart(e)?(n=this.gobbleIdentifier(),Jsep.literals.hasOwnProperty(n.name)?n={type:Jsep.LITERAL,value:Jsep.literals[n.name],raw:n.name}:n.name===Jsep.this_str&&(n={type:Jsep.THIS_EXP})):e===Jsep.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===Jsep.PERIOD_CODE||t===Jsep.OBRACK_CODE||t===Jsep.OPAREN_CODE||t===Jsep.QUMARK_CODE;){let s;if(t===Jsep.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==Jsep.PERIOD_CODE)break;s=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===Jsep.OBRACK_CODE?((e={type:Jsep.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()}).property||this.throwError('Unexpected "'+this.char+'"'),this.gobbleSpaces(),t=this.code,t!==Jsep.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===Jsep.OPAREN_CODE?e={type:Jsep.CALL_EXP,arguments:this.gobbleArguments(Jsep.CPAREN_CODE),callee:e}:(t===Jsep.PERIOD_CODE||s)&&(s&&this.index--,this.gobbleSpaces(),e={type:Jsep.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),s&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e,t,s="";for(;Jsep.isDecimalDigit(this.code);)s+=this.expr.charAt(this.index++);if(this.code===Jsep.PERIOD_CODE)for(s+=this.expr.charAt(this.index++);Jsep.isDecimalDigit(this.code);)s+=this.expr.charAt(this.index++);if(e=this.char,"e"===e||"E"===e){for(s+=this.expr.charAt(this.index++),e=this.char,"+"!==e&&"-"!==e||(s+=this.expr.charAt(this.index++));Jsep.isDecimalDigit(this.code);)s+=this.expr.charAt(this.index++);Jsep.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+s+this.char+")")}return t=this.code,Jsep.isIdentifierStart(t)?this.throwError("Variable names cannot start with a number ("+s+this.char+")"):(t===Jsep.PERIOD_CODE||1===s.length&&s.charCodeAt(0)===Jsep.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:Jsep.LITERAL,value:parseFloat(s),raw:s}}gobbleStringLiteral(){let e="";const t=this.index,s=this.expr.charAt(this.index++);let n=!1;for(;this.index<this.expr.length;){let t=this.expr.charAt(this.index++);if(t===s){n=!0;break}if("\\"===t)switch(t=this.expr.charAt(this.index++),t){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return n||this.throwError('Unclosed quote after "'+e+'"'),{type:Jsep.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(Jsep.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,Jsep.isIdentifierPart(e));)this.index++;return{type:Jsep.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){const t=[];let s=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let r=this.code;if(r===e){s=!0,this.index++,e===Jsep.CPAREN_CODE&&n&&n>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}if(r===Jsep.COMMA_CODE){if(this.index++,n++,n!==t.length)if(e===Jsep.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===Jsep.CBRACK_CODE)for(let e=t.length;e<n;e++)t.push(null)}else if(t.length!==n&&0!==n)this.throwError("Expected comma");else{const e=this.gobbleExpression();e&&e.type!==Jsep.COMPOUND||this.throwError("Expected comma"),t.push(e)}}return s||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(Jsep.CPAREN_CODE);if(this.code===Jsep.CPAREN_CODE)return this.index++,1===e.length?e[0]:!!e.length&&{type:Jsep.SEQUENCE_EXP,expressions:e};this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:Jsep.ARRAY_EXP,elements:this.gobbleArguments(Jsep.CBRACK_CODE)}}}const t=new class Hooks{add(e,t,s){if("string"!=typeof arguments[0])for(let e in arguments[0])this.add(e,arguments[0][e],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(e){this[e]=this[e]||[],t&&this[e][s?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(e){e.call(t&&t.context?t.context:t,t)})}};Object.assign(Jsep,{hooks:t,plugins:new class Plugins{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(e=>{if("object"!=typeof e||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)})}}(Jsep),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"??":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10,"**":11},right_associative:new Set(["**"]),additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),Jsep.max_unop_len=Jsep.getMaxKeyLen(Jsep.unary_ops),Jsep.max_binop_len=Jsep.getMaxKeyLen(Jsep.binary_ops);const jsep=e=>new Jsep(e).parse(),s=Object.getOwnPropertyNames(class Test{});Object.getOwnPropertyNames(Jsep).filter(e=>!s.includes(e)&&void 0===jsep[e]).forEach(e=>{jsep[e]=Jsep[e]}),jsep.Jsep=Jsep;var n={name:"ternary",init(e){e.hooks.add("after-expression",function gobbleTernary(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;const s=t.node,n=this.gobbleExpression();if(n||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;const r=this.gobbleExpression();if(r||this.throwError("Expected expression"),t.node={type:"ConditionalExpression",test:s,consequent:n,alternate:r},s.operator&&e.binary_ops[s.operator]<=.9){let n=s;for(;n.right.operator&&e.binary_ops[n.right.operator]<=.9;)n=n.right;t.node.test=n.right,n.right=t.node,t.node=s}}else this.throwError("Expected :")}})}};jsep.plugins.register(n),e.exports=jsep},181:e=>{"use strict";e.exports=require("buffer")},248:(e,t)=>{"use strict";function indentComment(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}t.indentComment=indentComment,t.lineComment=(e,t,s)=>e.endsWith("\n")?indentComment(s,t):s.includes("\n")?"\n"+indentComment(s,t):(e.endsWith(" ")?"":" ")+s,t.stringifyComment=e=>e.replace(/^(?!$)(?: $)?/gm,"#")},483:(e,t,s)=>{"use strict";var n=s(6010),r=s(1386),i=s(8644);t.resolveBlockSeq=function resolveBlockSeq({composeNode:e,composeEmptyNode:t},s,o,a,c){const l=new(c?.nodeClass??n.YAMLSeq)(s.schema);s.atRoot&&(s.atRoot=!1),s.atKey&&(s.atKey=!1);let u=o.offset,p=null;for(const{start:n,value:c}of o.items){const f=r.resolveProps(n,{indicator:"seq-item-ind",next:c,offset:u,onError:a,parentIndent:o.indent,startOnNewline:!0});if(!f.found){if(!(f.anchor||f.tag||c)){p=f.end,f.comment&&(l.comment=f.comment);continue}"block-seq"===c?.type?a(f.end,"BAD_INDENT","All sequence items must start at the same column"):a(u,"MISSING_CHAR","Sequence item without - indicator")}const h=c?e(s,c,f,a):t(s,f.end,n,null,f,a);s.schema.compat&&i.flowIndentCheck(o.indent,c,a),u=h.range[2],l.items.push(h)}return l.range=[o.offset,u,p??u],l}},484:(e,t)=>{"use strict";const s=Symbol.for("yaml.alias"),n=Symbol.for("yaml.document"),r=Symbol.for("yaml.map"),i=Symbol.for("yaml.pair"),o=Symbol.for("yaml.scalar"),a=Symbol.for("yaml.seq"),c=Symbol.for("yaml.node.type"),isScalar=e=>!!e&&"object"==typeof e&&e[c]===o;function isCollection(e){if(e&&"object"==typeof e)switch(e[c]){case r:case a:return!0}return!1}t.ALIAS=s,t.DOC=n,t.MAP=r,t.NODE_TYPE=c,t.PAIR=i,t.SCALAR=o,t.SEQ=a,t.hasAnchor=e=>(isScalar(e)||isCollection(e))&&!!e.anchor,t.isAlias=e=>!!e&&"object"==typeof e&&e[c]===s,t.isCollection=isCollection,t.isDocument=e=>!!e&&"object"==typeof e&&e[c]===n,t.isMap=e=>!!e&&"object"==typeof e&&e[c]===r,t.isNode=function isNode(e){if(e&&"object"==typeof e)switch(e[c]){case s:case r:case o:case a:return!0}return!1},t.isPair=e=>!!e&&"object"==typeof e&&e[c]===i,t.isScalar=isScalar,t.isSeq=e=>!!e&&"object"==typeof e&&e[c]===a},625:(e,t,s)=>{"use strict";var n=s(484),r=s(3334),i=s(1919),o=s(8531),a=s(975);const sortMapEntriesByKey=(e,t)=>e.key<t.key?-1:e.key>t.key?1:0;class Schema{constructor({compat:e,customTags:t,merge:s,resolveKnownTags:c,schema:l,sortMapEntries:u,toStringDefaults:p}){this.compat=Array.isArray(e)?a.getTags(e,"compat"):e?a.getTags(null,e):null,this.name="string"==typeof l&&l||"core",this.knownTags=c?a.coreKnownTags:{},this.tags=a.getTags(t,this.name,s),this.toStringOptions=p??null,Object.defineProperty(this,n.MAP,{value:r.map}),Object.defineProperty(this,n.SCALAR,{value:o.string}),Object.defineProperty(this,n.SEQ,{value:i.seq}),this.sortMapEntries="function"==typeof u?u:!0===u?sortMapEntriesByKey:null}clone(){const e=Object.create(Schema.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}t.Schema=Schema},652:(e,t,s)=>{const n=s(1198);function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function parseDirectiveOptions(e){const t={},s=e.split(",");for(const e of s){const[s,n]=e.split("=").map(e=>e.trim());if(s&&void 0!==n)switch(s.toLowerCase()){case"newline":case"newlineformat":t.newlineFormat=n.replace(/\\r\\n/g,"\r\n").replace(/\\n/g,"\n").replace(/\\r/g,"\r");break;case"linewidth":const e=parseInt(n,10);isNaN(e)||(t.lineWidth=e);break;case"indent":const s=parseInt(n,10);!isNaN(s)&&s>0&&s<=8&&(t.indent=s);break;case"noarrayindent":t.noArrayIndent="true"===n.toLowerCase();break;case"forcequotes":t.forceQuotes="true"===n.toLowerCase();break;case"sortkeys":t.sortKeys="true"===n.toLowerCase();break;case"preservecomments":t.preserveComments="true"===n.toLowerCase();break;case"stepspacing":t.stepSpacing="true"===n.toLowerCase();break;case"sectionspacing":t.sectionSpacing="true"===n.toLowerCase();break;case"normalizepaths":t.normalizePaths="true"===n.toLowerCase();break;case"expandtemplates":t.expandTemplates="true"===n.toLowerCase()}}return t}function findNextNonBlankLine(e,t){for(let s=t;s<e.length;s++)if(""!==e[s].trim())return s;return null}e.exports={formatYaml:function formatYaml(e,t={}){const s={text:e,warning:void 0,error:void 0};if(!e)return s;const r=function parseFormatDirectives(e){const t={disabled:!1,options:null},s=e.split(/\r?\n/).slice(0,5);for(const e of s){const s=e.trim();if("# ado-yaml-format=false"===s||"# ado-yaml-format: false"===s)return t.disabled=!0,t;const n=s.match(/^#\s*ado-yaml-format[:\s]+(.+)$/);if(n){const e=n[1].trim();t.options=parseDirectiveOptions(e)}if(s.length>0&&!s.startsWith("#"))break}return t}(e);if(r.disabled)return s;r.options&&(t={...t,...r.options});const i={noArrayIndent:!t||"boolean"!=typeof t.noArrayIndent||t.noArrayIndent,indent:t&&Number.isInteger(t.indent)&&t.indent>0?t.indent:2,lineWidth:t&&"number"==typeof t.lineWidth&&t.lineWidth>=0?0===t.lineWidth?-1:t.lineWidth:-1,forceQuotes:!(!t||"boolean"!=typeof t.forceQuotes)&&t.forceQuotes,sortKeys:!(!t||"boolean"!=typeof t.sortKeys)&&t.sortKeys,expandTemplates:!(!t||"boolean"!=typeof t.expandTemplates)&&t.expandTemplates,newlineFormat:!t||"string"!=typeof t.newlineFormat||"\n"!==t.newlineFormat&&"\r\n"!==t.newlineFormat?"\n":t.newlineFormat,fileName:t&&t.fileName?t.fileName:void 0,stepSpacing:!t||"boolean"!=typeof t.stepSpacing||t.stepSpacing,firstBlockBlankLines:t&&Number.isInteger(t.firstBlockBlankLines)&&t.firstBlockBlankLines>=0?Math.min(t.firstBlockBlankLines,4):2,betweenSectionBlankLines:t&&Number.isInteger(t.betweenSectionBlankLines)&&t.betweenSectionBlankLines>=0?Math.min(t.betweenSectionBlankLines,4):t&&Number.isInteger(t.blankLinesBetweenSections)&&t.blankLinesBetweenSections>=0?Math.min(t.blankLinesBetweenSections,4):1,sectionSpacing:!(!t||"boolean"!=typeof t.sectionSpacing)&&t.sectionSpacing,wasExpanded:!(!t||"boolean"!=typeof t.wasExpanded)&&t.wasExpanded};try{let t=e;const{content:s,placeholderMap:r}=i.expandTemplates?{content:t,placeholderMap:new Map}:function replaceTemplateExpressionsWithPlaceholders(e){if(!e)return{content:e,placeholderMap:new Map};const t=new Map;let s=0;return{content:e.replace(/(\$\{\{[^}]+\}\}|\$\[[^\]]+\])/g,e=>{const n="__EXPR_PLACEHOLDER_"+s+"__";return t.set(n,e),s++,n}),placeholderMap:t}}(t),{content:o,commentMap:a}=function protectEmptyValues(e){if(!e)return e;const t=e.split(/\r?\n/),s=[],n=new Map;let r=0;const i=/^(\s*)([^:]+):\s*$/;for(let e=0;e<t.length;e++){const o=t[e],a=o.trim();if(!a||a.startsWith("#")||a.startsWith("-")){s.push(o);continue}const c=o.match(i);if(!c){s.push(o);continue}const l=c[1],u=c[2];let p=e+1,f=!1;for(;p<t.length;){const e=t[p],s=e.trim(),n=e.length-e.trimStart().length;if(""!==s&&!s.startsWith("#")){f=s.startsWith("-")&&n>=l.length||n>l.length;break}p++}if(!f){const i=[];let o=e+1;for(;o<t.length;){const e=t[o],s=e.trim();if(""!==s){if(!s.startsWith("#"))break;if(!(e.length-e.trimStart().length>=l.length))break;i.push(e),o++}else i.push(e),o++}if(i.length>0){const t=`__COMMENT_${r}__`;n.set(t,i),r++,s.push(`${l}${u}: __EMPTY_VALUE_PLACEHOLDER__${t}`),e=o-1}else s.push(`${l}${u}: __EMPTY_VALUE_PLACEHOLDER__`);continue}s.push(o)}return{content:s.join("\n"),commentMap:n}}(s),c=n.parseDocument(o,{strict:!1,uniqueKeys:!1});if(c.errors&&c.errors.length>0){const t=c.errors.filter(e=>!e.message||!e.message.includes("Invalid escape sequence"));if(t.length>0){const s=t.map(e=>e.message).join(", "),n=i.fileName?`[${i.fileName}] `:"";return console.error(`${n}YAML parsing error:`,s),{text:e,warning:void 0,error:s.length>100?s.substring(0,100)+"...":s}}}c.errors=[],c.warnings=[];let l=c.toString({indent:i.indent,indentSeq:!i.noArrayIndent,lineWidth:-1,doubleQuotedAsJSON:!0,doubleQuotedMinMultiLineLength:1/0,singleQuote:null,blockQuote:!0,defaultStringType:"PLAIN",aliasDuplicateObjects:!1});l=function restoreTemplateExpressions(e,t){if(!e||!t||0===t.size)return e;let s=e;for(const[e,n]of t)s=s.replace(new RegExp(escapeRegExp(e),"g"),n);return s}(l,r),l=function restoreEmptyValues(e,t){if(!e)return e;if(!t||0===t.size)return e.replace(/:\s*__EMPTY_VALUE_PLACEHOLDER__\s*$/gm,":");const s=e.split(/\r?\n/),n=[];for(const e of s){const s=e.match(/^(\s*)([^:]+):\s*__EMPTY_VALUE_PLACEHOLDER__(__COMMENT_\d+__)\s*$/);if(s){const[,e,r,i]=s,o=t.get(i);n.push(`${e}${r}:`),o?.length&&o.forEach(e=>n.push(e))}else e.match(/:\s*__EMPTY_VALUE_PLACEHOLDER__\s*$/)?n.push(e.replace(/:\s*__EMPTY_VALUE_PLACEHOLDER__\s*$/,":")):n.push(e)}return n.join("\n")}(l,a);const u=i.newlineFormat;let p=l.replace(/\r?\n/g,u);return p=function applyPipelineFormatting(e,t,s){if(!e)return e;let n=e.split(t);const r=["steps:","jobs:","stages:","pool:","variables:","parameters:","resources:","trigger:","pr:"],i=["steps"],o=["stages","jobs"],a=/^\s*-\s+(task|bash|powershell|pwsh|script|sh|checkout|download|downloadBuild|getPackage|publish|reviewApp|template):/,c=["stages:","jobs:","steps:","trigger:","pr:","resources:","pool:","variables:"];let l=!1,u=-1;for(let e=0;e<n.length;e++){const t=n[e].trim();if(t&&!t.startsWith("#")){u=e,l="parameters:"===t;break}}const p=[];let f=null,h=!1,d=-1,m=-1,g=!1,y=-1,b=!1,v=!1,w=!1,S=-1;for(let e=0;e<n.length;e++){const t=n[e],E=t.trim(),k=t.length-t.trimStart().length;if(0===k&&E&&!E.startsWith("#")&&E.endsWith(":")&&(f=E.slice(0,-1)),""===E){const s=findNextNonBlankLine(n,e+1);if(null!==s){const e=n[s].length-n[s].trimStart().length,r=n[s].trim();let a=!1;if(g){p.push(""),h=!1;continue}{let t=null;for(let e=p.length-1;e>=0;e--)if(""!==p[e].trim()){t=p[e];break}if(t){const s=t.length-t.trimStart().length,n=t.trim();0!==s||"stages:"!==n&&"jobs:"!==n&&"steps:"!==n?h||"steps"===f||i.includes(f)?a=!0:o.includes(f)&&(0!==e&&2!==e||(a=!0)):a=!0}if(a&&r.startsWith("#")){let e=!1,t=-1;for(let s=p.length-1;s>=0;s--){if(""!==p[s].trim()&&!p[s].trim().startsWith("#")){e=!0,t=s;break}if(p[s].trim().startsWith("#"))break}if(e){let e=!1;for(let t=s;t<n.length;t++){const s=n[t].trim();if(""!==s&&!s.startsWith("#")){e=!0;break}}if(!e){let e=0;for(let s=t+1;s<p.length;s++)""===p[s].trim()&&e++;e>=1&&(a=!1)}}}}a&&(p.push(t),h=!1)}h=!1;continue}const A=/:\s*[|>][-+]?\s*$/.test(t);if(A?(g=!0,y=k):g&&k<=y&&""!==E&&(g=!1,y=-1),s.stepSpacing&&!s.wasExpanded){let s=!1,r=-1;"steps:"===E||"jobs:"===E||"stages:"===E?t.includes("${{")||(s=!0,r=k):r>=0&&k<=r&&E&&!E.startsWith("#")&&"steps:"!==E&&"jobs:"!==E&&"stages:"!==E&&(s=!1,r=-1);const i=/^\s*-\s+/.test(t),o=/^\s*-\s+\$\{\{\s*(if|else|elseif|each)\s/.test(t),c=i&&!o&&(a.test(t)||/^\s*-\s+\$\{\{.*\}\}:?/.test(t)),l=o&&d>=0;"variables:"!==E||t.includes("${{")?(m>=0&&k<m&&E&&!E.startsWith("#")||m>=0&&k===m&&E&&!E.startsWith("#")&&!E.startsWith("-")&&E.endsWith(":")&&"variables:"!==E)&&(m=-1):m=k;const u=m>=0&&k===m&&i,f=p.length>0?p[p.length-1].trim():"",h=/^-\s+\$\{\{\s*(if|else|elseif|each)\s/.test(f),y="steps:"===f||"jobs:"===f||"stages:"===f;d>=0&&(n[d].length,n[d].trimStart().length),!((c||l)&&d>=0)||y||h||g&&!A||u||p.length>0&&""!==p[p.length-1].trim()&&p.push(""),c?d=e:"steps:"!==E&&"jobs:"!==E&&"stages:"!==E||t.includes("${{")||(d=-1)}let x=!1;if(l&&!s.wasExpanded&&(!w&&e>u&&E&&!E.startsWith("#")&&!E.startsWith("-")&&" "!==t[0]&&E.endsWith(":")&&(w=!0),w&&!b&&c.some(e=>E===e))){b=!0,x=!0;const e=E.includes(":")?E.substring(0,E.indexOf(":")+1).trim():E;for(("steps:"===e||"stages:"===e||"jobs:"===e)&&(v=!0);p.length>0&&""===p[p.length-1].trim();)p.pop();for(let e=0;e<s.firstBlockBlankLines;e++)p.push("")}const O=E&&!E.startsWith("#")&&!E.startsWith("-")&&" "!==t[0]&&/^[^:]+:/.test(E);if(O&&S>=0&&!x&&!s.wasExpanded){for(;p.length>0&&""===p[p.length-1].trim();)p.pop();const e=E.includes(":")?E.substring(0,E.indexOf(":")+1).trim():E,t="steps:"===e||"stages:"===e||"jobs:"===e,n=t&&!v&&l&&w;let r;n&&(v=!0),r=n?s.firstBlockBlankLines:t?1:s.betweenSectionBlankLines,n&&(b=!0);for(let e=0;e<r;e++)p.push("")}if(O&&(S=p.length),("jobs:"===E||"steps:"===E)&&k>0&&!x&&!s.wasExpanded){let e=!1;p.length>0&&""===p[p.length-1].trim()&&(e=!0),e||p.push("")}if(E.startsWith("#")){let t=!0;for(let s=e+1;s<n.length;s++){const e=n[s].trim();if(""!==e&&!e.startsWith("#")){t=!1;break}}if(t){let e=!1;for(let t=p.length-1;t>=0;t--){const s=p[t].trim();if(""!==s&&!s.startsWith("#")){e=!0;break}}if(e){const e=p.length>0?p[p.length-1]:null;e&&""!==e.trim()&&p.push("")}}}if(p.push(t),h=E.startsWith("#"),r.some(e=>E===e||E.startsWith(e+" ")))for(;e+1<n.length&&""===n[e+1].trim();)e++}return p.join(t)}(p,u,i),p=p.split(u).map(e=>e.replace(/[ \t]+$/,"")).join(u),p=i.wasExpanded&&i.azureCompatible?p.replace(new RegExp(`(?:${escapeRegExp(u)})*$`),`${u}${u}${u}`):p.replace(new RegExp(`(?:${escapeRegExp(u)})*$`),u),{text:p,warning:void 0,error:void 0}}catch(t){const s=function describeYamlSyntaxError(e){if(!e||"object"!=typeof e)return;if("YAMLException"!==e.name&&"YAMLError"!==e.name&&e.name&&"string"==typeof e.name&&!e.name.includes("YAML"))return;const t=("string"==typeof e.reason&&e.reason.trim().length?e.reason.trim():void 0)||("string"==typeof e.message?e.message.trim():void 0);if(t&&t.includes("duplicated mapping key")&&((e.snippet||"").includes("${{")||e.mark&&e.mark.snippet&&e.mark.snippet.includes("${{")))return;const s=e.mark&&"object"==typeof e.mark?e.mark:void 0,n=s&&Number.isInteger(s.line),r=s&&Number.isInteger(s.column);if(!t&&!n)return;const i=n?`line ${s.line+1}`:void 0,o=r?`column ${s.column+1}`:void 0,a=i&&o?`${i}, ${o}`:i||o;return a&&t?`YAML syntax error at ${a}: ${t}`:t?`YAML syntax error: ${t}`:a?`YAML syntax error at ${a}.`:void 0}(t),n=i.fileName?`[${i.fileName}] `:"";return s?(console.error(`${n}${s}`),{text:e,warning:void 0,error:s}):(console.error(`${n}YAML formatting failed:`,t.message),{text:e,warning:void 0,error:`YAML formatting failed: ${t.message}`})}},escapeRegExp}},692:(e,t,s)=>{"use strict";var n=s(484),r=s(3732),i=s(1755),o=s(6010),a=s(8416);class YAMLOMap extends o.YAMLSeq{constructor(){super(),this.add=i.YAMLMap.prototype.add.bind(this),this.delete=i.YAMLMap.prototype.delete.bind(this),this.get=i.YAMLMap.prototype.get.bind(this),this.has=i.YAMLMap.prototype.has.bind(this),this.set=i.YAMLMap.prototype.set.bind(this),this.tag=YAMLOMap.tag}toJSON(e,t){if(!t)return super.toJSON(e);const s=new Map;t?.onCreate&&t.onCreate(s);for(const e of this.items){let i,o;if(n.isPair(e)?(i=r.toJS(e.key,"",t),o=r.toJS(e.value,i,t)):i=r.toJS(e,"",t),s.has(i))throw new Error("Ordered maps must not include duplicate keys");s.set(i,o)}return s}static from(e,t,s){const n=a.createPairs(e,t,s),r=new this;return r.items=n.items,r}}YAMLOMap.tag="tag:yaml.org,2002:omap";const c={collection:"seq",identify:e=>e instanceof Map,nodeClass:YAMLOMap,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){const s=a.resolvePairs(e,t),r=[];for(const{key:e}of s.items)n.isScalar(e)&&(r.includes(e.value)?t(`Ordered maps must not include duplicate keys: ${e.value}`):r.push(e.value));return Object.assign(new YAMLOMap,s)},createNode:(e,t,s)=>YAMLOMap.from(e,t,s)};t.YAMLOMap=YAMLOMap,t.omap=c},857:e=>{"use strict";e.exports=require("os")},932:e=>{"use strict";e.exports=require("process")},975:(e,t,s)=>{"use strict";var n=s(3334),r=s(6055),i=s(1919),o=s(8531),a=s(5132),c=s(988),l=s(2891),u=s(8523),p=s(4988),f=s(8080),h=s(9637),d=s(692),m=s(8416),g=s(5822),y=s(2557),b=s(5437);const v=new Map([["core",u.schema],["failsafe",[n.map,i.seq,o.string]],["json",p.schema],["yaml11",g.schema],["yaml-1.1",g.schema]]),w={binary:f.binary,bool:a.boolTag,float:c.float,floatExp:c.floatExp,floatNaN:c.floatNaN,floatTime:b.floatTime,int:l.int,intHex:l.intHex,intOct:l.intOct,intTime:b.intTime,map:n.map,merge:h.merge,null:r.nullTag,omap:d.omap,pairs:m.pairs,seq:i.seq,set:y.set,timestamp:b.timestamp},S={"tag:yaml.org,2002:binary":f.binary,"tag:yaml.org,2002:merge":h.merge,"tag:yaml.org,2002:omap":d.omap,"tag:yaml.org,2002:pairs":m.pairs,"tag:yaml.org,2002:set":y.set,"tag:yaml.org,2002:timestamp":b.timestamp};t.coreKnownTags=S,t.getTags=function getTags(e,t,s){const n=v.get(t);if(n&&!e)return s&&!n.includes(h.merge)?n.concat(h.merge):n.slice();let r=n;if(!r){if(!Array.isArray(e)){const e=Array.from(v.keys()).filter(e=>"yaml11"!==e).map(e=>JSON.stringify(e)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${e} or define customTags array`)}r=[]}if(Array.isArray(e))for(const t of e)r=r.concat(t);else"function"==typeof e&&(r=e(r.slice()));return s&&(r=r.concat(h.merge)),r.reduce((e,t)=>{const s="string"==typeof t?w[t]:t;if(!s){const e=JSON.stringify(t),s=Object.keys(w).map(e=>JSON.stringify(e)).join(", ");throw new Error(`Unknown custom tag ${e}; use one of ${s}`)}return e.includes(s)||e.push(s),e},[])}},988:(e,t,s)=>{"use strict";var n=s(9714),r=s(3144);const i={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:r.stringifyNumber},o={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():r.stringifyNumber(e)}},a={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const t=new n.Scalar(parseFloat(e)),s=e.indexOf(".");return-1!==s&&"0"===e[e.length-1]&&(t.minFractionDigits=e.length-s-1),t},stringify:r.stringifyNumber};t.float=a,t.floatExp=o,t.floatNaN=i},1040:(e,t)=>{"use strict";t.emptyScalarPosition=function emptyScalarPosition(e,t,s){if(t){s??(s=t.length);for(let n=s-1;n>=0;--n){let s=t[n];switch(s.type){case"space":case"comment":case"newline":e-=s.source.length;continue}for(s=t[++n];"space"===s?.type;)e+=s.source.length,s=t[++n];break}}return e}},1198:(e,t,s)=>{"use strict";var n=s(4927),r=s(9046),i=s(625),o=s(4355),a=s(1736),c=s(484),l=s(7902),u=s(9714),p=s(1755),f=s(6010),h=s(9112),d=s(5752),m=s(2864),g=s(6247),y=s(1332),b=s(9125);t.Composer=n.Composer,t.Document=r.Document,t.Schema=i.Schema,t.YAMLError=o.YAMLError,t.YAMLParseError=o.YAMLParseError,t.YAMLWarning=o.YAMLWarning,t.Alias=a.Alias,t.isAlias=c.isAlias,t.isCollection=c.isCollection,t.isDocument=c.isDocument,t.isMap=c.isMap,t.isNode=c.isNode,t.isPair=c.isPair,t.isScalar=c.isScalar,t.isSeq=c.isSeq,t.Pair=l.Pair,t.Scalar=u.Scalar,t.YAMLMap=p.YAMLMap,t.YAMLSeq=f.YAMLSeq,t.CST=h,t.Lexer=d.Lexer,t.LineCounter=m.LineCounter,t.Parser=g.Parser,t.parse=y.parse,t.parseAllDocuments=y.parseAllDocuments,t.parseDocument=y.parseDocument,t.stringify=y.stringify,t.visit=b.visit,t.visitAsync=b.visitAsync},1332:(e,t,s)=>{"use strict";var n=s(4927),r=s(9046),i=s(4355),o=s(7444),a=s(484),c=s(2864),l=s(6247);function parseOptions(e){const t=!1!==e.prettyErrors;return{lineCounter:e.lineCounter||t&&new c.LineCounter||null,prettyErrors:t}}function parseDocument(e,t={}){const{lineCounter:s,prettyErrors:r}=parseOptions(t),o=new l.Parser(s?.addNewLine),a=new n.Composer(t);let c=null;for(const t of a.compose(o.parse(e),!0,e.length))if(c){if("silent"!==c.options.logLevel){c.errors.push(new i.YAMLParseError(t.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else c=t;return r&&s&&(c.errors.forEach(i.prettifyError(e,s)),c.warnings.forEach(i.prettifyError(e,s))),c}t.parse=function parse(e,t,s){let n;"function"==typeof t?n=t:void 0===s&&t&&"object"==typeof t&&(s=t);const r=parseDocument(e,s);if(!r)return null;if(r.warnings.forEach(e=>o.warn(r.options.logLevel,e)),r.errors.length>0){if("silent"!==r.options.logLevel)throw r.errors[0];r.errors=[]}return r.toJS(Object.assign({reviver:n},s))},t.parseAllDocuments=function parseAllDocuments(e,t={}){const{lineCounter:s,prettyErrors:r}=parseOptions(t),o=new l.Parser(s?.addNewLine),a=new n.Composer(t),c=Array.from(a.compose(o.parse(e)));if(r&&s)for(const t of c)t.errors.forEach(i.prettifyError(e,s)),t.warnings.forEach(i.prettifyError(e,s));return c.length>0?c:Object.assign([],{empty:!0},a.streamInfo())},t.parseDocument=parseDocument,t.stringify=function stringify(e,t,s){let n=null;if("function"==typeof t||Array.isArray(t)?n=t:void 0===s&&t&&(s=t),"string"==typeof s&&(s=s.length),"number"==typeof s){const e=Math.round(s);s=e<1?void 0:e>8?{indent:8}:{indent:e}}if(void 0===e){const{keepUndefined:e}=s??t??{};if(!e)return}return a.isDocument(e)&&!n?e.toString(s):new r.Document(e,n,s).toString(s)}},1386:(e,t)=>{"use strict";t.resolveProps=function resolveProps(e,{flow:t,indicator:s,next:n,offset:r,onError:i,parentIndent:o,startOnNewline:a}){let c=!1,l=a,u=a,p="",f="",h=!1,d=!1,m=null,g=null,y=null,b=null,v=null,w=null,S=null;for(const r of e)switch(d&&("space"!==r.type&&"newline"!==r.type&&"comma"!==r.type&&i(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),d=!1),m&&(l&&"comment"!==r.type&&"newline"!==r.type&&i(m,"TAB_AS_INDENT","Tabs are not allowed as indentation"),m=null),r.type){case"space":t||"doc-start"===s&&"flow-collection"===n?.type||!r.source.includes("\t")||(m=r),u=!0;break;case"comment":{u||i(r,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const e=r.source.substring(1)||" ";p?p+=f+e:p=e,f="",l=!1;break}case"newline":l?p?p+=r.source:w&&"seq-item-ind"===s||(c=!0):f+=r.source,l=!0,h=!0,(g||y)&&(b=r),u=!0;break;case"anchor":g&&i(r,"MULTIPLE_ANCHORS","A node can have at most one anchor"),r.source.endsWith(":")&&i(r.offset+r.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),g=r,S??(S=r.offset),l=!1,u=!1,d=!0;break;case"tag":y&&i(r,"MULTIPLE_TAGS","A node can have at most one tag"),y=r,S??(S=r.offset),l=!1,u=!1,d=!0;break;case s:(g||y)&&i(r,"BAD_PROP_ORDER",`Anchors and tags must be after the ${r.source} indicator`),w&&i(r,"UNEXPECTED_TOKEN",`Unexpected ${r.source} in ${t??"collection"}`),w=r,l="seq-item-ind"===s||"explicit-key-ind"===s,u=!1;break;case"comma":if(t){v&&i(r,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),v=r,l=!1,u=!1;break}default:i(r,"UNEXPECTED_TOKEN",`Unexpected ${r.type} token`),l=!1,u=!1}const E=e[e.length-1],k=E?E.offset+E.source.length:r;return d&&n&&"space"!==n.type&&"newline"!==n.type&&"comma"!==n.type&&("scalar"!==n.type||""!==n.source)&&i(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),m&&(l&&m.indent<=o||"block-map"===n?.type||"block-seq"===n?.type)&&i(m,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:v,found:w,spaceBefore:c,comment:p,hasNewline:h,anchor:g,tag:y,newlineAfterProp:b,end:k,start:S??k}}},1398:e=>{"use strict";e.exports=require("vscode")},1614:(e,t,s)=>{"use strict";var n=s(5219),r=s(484),i=s(8898);function collectionFromPath(e,t,s){let r=s;for(let e=t.length-1;e>=0;--e){const s=t[e];if("number"==typeof s&&Number.isInteger(s)&&s>=0){const e=[];e[s]=r,r=e}else r=new Map([[s,r]])}return n.createNode(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}const isEmptyPath=e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done;class Collection extends i.NodeBase{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(t=>r.isNode(t)||r.isPair(t)?t.clone(e):t),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(isEmptyPath(e))this.add(t);else{const[s,...n]=e,i=this.get(s,!0);if(r.isCollection(i))i.addIn(n,t);else{if(void 0!==i||!this.schema)throw new Error(`Expected YAML collection at ${s}. Remaining path: ${n}`);this.set(s,collectionFromPath(this.schema,n,t))}}}deleteIn(e){const[t,...s]=e;if(0===s.length)return this.delete(t);const n=this.get(t,!0);if(r.isCollection(n))return n.deleteIn(s);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${s}`)}getIn(e,t){const[s,...n]=e,i=this.get(s,!0);return 0===n.length?!t&&r.isScalar(i)?i.value:i:r.isCollection(i)?i.getIn(n,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!r.isPair(t))return!1;const s=t.value;return null==s||e&&r.isScalar(s)&&null==s.value&&!s.commentBefore&&!s.comment&&!s.tag})}hasIn(e){const[t,...s]=e;if(0===s.length)return this.has(t);const n=this.get(t,!0);return!!r.isCollection(n)&&n.hasIn(s)}setIn(e,t){const[s,...n]=e;if(0===n.length)this.set(s,t);else{const e=this.get(s,!0);if(r.isCollection(e))e.setIn(n,t);else{if(void 0!==e||!this.schema)throw new Error(`Expected YAML collection at ${s}. Remaining path: ${n}`);this.set(s,collectionFromPath(this.schema,n,t))}}}}t.Collection=Collection,t.collectionFromPath=collectionFromPath,t.isEmptyPath=isEmptyPath},1736:(e,t,s)=>{"use strict";var n=s(6261),r=s(9125),i=s(484),o=s(8898),a=s(3732);class Alias extends o.NodeBase{constructor(e){super(i.ALIAS),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e,t){let s,n;t?.aliasResolveCache?s=t.aliasResolveCache:(s=[],r.visit(e,{Node:(e,t)=>{(i.isAlias(t)||i.hasAnchor(t))&&s.push(t)}}),t&&(t.aliasResolveCache=s));for(const e of s){if(e===this)break;e.anchor===this.source&&(n=e)}return n}toJSON(e,t){if(!t)return{source:this.source};const{anchors:s,doc:n,maxAliasCount:r}=t,i=this.resolve(n,t);if(!i){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(e)}let o=s.get(i);if(o||(a.toJS(i,null,t),o=s.get(i)),void 0===o?.res){throw new ReferenceError("This should not happen: Alias anchor was not resolved?")}if(r>=0&&(o.count+=1,0===o.aliasCount&&(o.aliasCount=getAliasCount(n,i,s)),o.count*o.aliasCount>r)){throw new ReferenceError("Excessive alias count indicates a resource exhaustion attack")}return o.res}toString(e,t,s){const r=`*${this.source}`;if(e){if(n.anchorIsValid(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(e)}if(e.implicitKey)return`${r} `}return r}}function getAliasCount(e,t,s){if(i.isAlias(t)){const n=t.resolve(e),r=s&&n&&s.get(n);return r?r.count*r.aliasCount:0}if(i.isCollection(t)){let n=0;for(const r of t.items){const t=getAliasCount(e,r,s);t>n&&(n=t)}return n}if(i.isPair(t)){const n=getAliasCount(e,t.key,s),r=getAliasCount(e,t.value,s);return Math.max(n,r)}return 1}t.Alias=Alias},1755:(e,t,s)=>{"use strict";var n=s(81),r=s(5139),i=s(1614),o=s(484),a=s(7902),c=s(9714);function findPair(e,t){const s=o.isScalar(t)?t.value:t;for(const n of e)if(o.isPair(n)){if(n.key===t||n.key===s)return n;if(o.isScalar(n.key)&&n.key.value===s)return n}}class YAMLMap extends i.Collection{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(o.MAP,e),this.items=[]}static from(e,t,s){const{keepUndefined:n,replacer:r}=s,i=new this(e),add=(e,o)=>{if("function"==typeof r)o=r.call(t,e,o);else if(Array.isArray(r)&&!r.includes(e))return;(void 0!==o||n)&&i.items.push(a.createPair(e,o,s))};if(t instanceof Map)for(const[e,s]of t)add(e,s);else if(t&&"object"==typeof t)for(const e of Object.keys(t))add(e,t[e]);return"function"==typeof e.sortMapEntries&&i.items.sort(e.sortMapEntries),i}add(e,t){let s;s=o.isPair(e)?e:e&&"object"==typeof e&&"key"in e?new a.Pair(e.key,e.value):new a.Pair(e,e?.value);const n=findPair(this.items,s.key),r=this.schema?.sortMapEntries;if(n){if(!t)throw new Error(`Key ${s.key} already set`);o.isScalar(n.value)&&c.isScalarValue(s.value)?n.value.value=s.value:n.value=s.value}else if(r){const e=this.items.findIndex(e=>r(s,e)<0);-1===e?this.items.push(s):this.items.splice(e,0,s)}else this.items.push(s)}delete(e){const t=findPair(this.items,e);if(!t)return!1;return this.items.splice(this.items.indexOf(t),1).length>0}get(e,t){const s=findPair(this.items,e),n=s?.value;return(!t&&o.isScalar(n)?n.value:n)??void 0}has(e){return!!findPair(this.items,e)}set(e,t){this.add(new a.Pair(e,t),!0)}toJSON(e,t,s){const n=s?new s:t?.mapAsMap?new Map:{};t?.onCreate&&t.onCreate(n);for(const e of this.items)r.addPairToJSMap(t,n,e);return n}toString(e,t,s){if(!e)return JSON.stringify(this);for(const e of this.items)if(!o.isPair(e))throw new Error(`Map items must all be pairs; found ${JSON.stringify(e)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),n.stringifyCollection(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:s,onComment:t})}}t.YAMLMap=YAMLMap,t.findPair=findPair},1768:(e,t,s)=>{"use strict";var n=s(484),r=s(3793),i=s(248);t.stringifyDocument=function stringifyDocument(e,t){const s=[];let o=!0===t.directives;if(!1!==t.directives&&e.directives){const t=e.directives.toString(e);t?(s.push(t),o=!0):e.directives.docStart&&(o=!0)}o&&s.push("---");const a=r.createStringifyContext(e,t),{commentString:c}=a.options;if(e.commentBefore){1!==s.length&&s.unshift("");const t=c(e.commentBefore);s.unshift(i.indentComment(t,""))}let l=!1,u=null;if(e.contents){if(n.isNode(e.contents)){if(e.contents.spaceBefore&&o&&s.push(""),e.contents.commentBefore){const t=c(e.contents.commentBefore);s.push(i.indentComment(t,""))}a.forceBlockIndent=!!e.comment,u=e.contents.comment}const t=u?void 0:()=>l=!0;let p=r.stringify(e.contents,a,()=>u=null,t);u&&(p+=i.lineComment(p,"",c(u))),"|"!==p[0]&&">"!==p[0]||"---"!==s[s.length-1]?s.push(p):s[s.length-1]=`--- ${p}`}else s.push(r.stringify(e.contents,a));if(e.directives?.docEnd)if(e.comment){const t=c(e.comment);t.includes("\n")?(s.push("..."),s.push(i.indentComment(t,""))):s.push(`... ${t}`)}else s.push("...");else{let t=e.comment;t&&l&&(t=t.replace(/^\n+/,"")),t&&(l&&!u||""===s[s.length-1]||s.push(""),s.push(i.indentComment(c(t),"")))}return s.join("\n")+"\n"}},1919:(e,t,s)=>{"use strict";var n=s(484),r=s(6010);const i={collection:"seq",default:!0,nodeClass:r.YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve:(e,t)=>(n.isSeq(e)||t("Expected a sequence for this tag"),e),createNode:(e,t,s)=>r.YAMLSeq.from(e,t,s)};t.seq=i},2206:(e,t,s)=>{"use strict";var n=s(9046),r=s(2782),i=s(6845),o=s(1386);t.composeDoc=function composeDoc(e,t,{offset:s,start:a,value:c,end:l},u){const p=Object.assign({_directives:t},e),f=new n.Document(void 0,p),h={atKey:!1,atRoot:!0,directives:f.directives,options:f.options,schema:f.schema},d=o.resolveProps(a,{indicator:"doc-start",next:c??l?.[0],offset:s,onError:u,parentIndent:0,startOnNewline:!0});d.found&&(f.directives.docStart=!0,!c||"block-map"!==c.type&&"block-seq"!==c.type||d.hasNewline||u(d.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),f.contents=c?r.composeNode(h,c,d,u):r.composeEmptyNode(h,d.end,a,null,d,u);const m=f.contents.range[2],g=i.resolveEnd(l,m,!1,u);return g.comment&&(f.comment=g.comment),f.range=[s,m,g.offset],f}},2250:e=>{"use strict";e.exports=require("dns")},2291:(e,t,s)=>{"use strict";var n=s(484),r=s(7902),i=s(1755),o=s(6010),a=s(6845),c=s(1386),l=s(9378),u=s(8334);const p="Block collections are not allowed within flow collections",isBlock=e=>e&&("block-map"===e.type||"block-seq"===e.type);t.resolveFlowCollection=function resolveFlowCollection({composeNode:e,composeEmptyNode:t},s,f,h,d){const m="{"===f.start.source,g=m?"flow map":"flow sequence",y=new(d?.nodeClass??(m?i.YAMLMap:o.YAMLSeq))(s.schema);y.flow=!0;const b=s.atRoot;b&&(s.atRoot=!1),s.atKey&&(s.atKey=!1);let v=f.offset+f.start.source.length;for(let o=0;o<f.items.length;++o){const a=f.items[o],{start:d,key:b,sep:w,value:S}=a,E=c.resolveProps(d,{flow:g,indicator:"explicit-key-ind",next:b??w?.[0],offset:v,onError:h,parentIndent:f.indent,startOnNewline:!1});if(!E.found){if(!(E.anchor||E.tag||w||S)){0===o&&E.comma?h(E.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${g}`):o<f.items.length-1&&h(E.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${g}`),E.comment&&(y.comment?y.comment+="\n"+E.comment:y.comment=E.comment),v=E.end;continue}!m&&s.options.strict&&l.containsNewline(b)&&h(b,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(0===o)E.comma&&h(E.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${g}`);else if(E.comma||h(E.start,"MISSING_CHAR",`Missing , between ${g} items`),E.comment){let e="";e:for(const t of d)switch(t.type){case"comma":case"space":break;case"comment":e=t.source.substring(1);break e;default:break e}if(e){let t=y.items[y.items.length-1];n.isPair(t)&&(t=t.value??t.key),t.comment?t.comment+="\n"+e:t.comment=e,E.comment=E.comment.substring(e.length+1)}}if(m||w||E.found){s.atKey=!0;const n=E.end,o=b?e(s,b,E,h):t(s,n,d,null,E,h);isBlock(b)&&h(o.range,"BLOCK_IN_FLOW",p),s.atKey=!1;const l=c.resolveProps(w??[],{flow:g,indicator:"map-value-ind",next:S,offset:o.range[2],onError:h,parentIndent:f.indent,startOnNewline:!1});if(l.found){if(!m&&!E.found&&s.options.strict){if(w)for(const e of w){if(e===l.found)break;if("newline"===e.type){h(e,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}E.start<l.found.offset-1024&&h(l.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else S&&("source"in S&&":"===S.source?.[0]?h(S,"MISSING_CHAR",`Missing space after : in ${g}`):h(l.start,"MISSING_CHAR",`Missing , or : between ${g} items`));const k=S?e(s,S,l,h):l.found?t(s,l.end,w,null,l,h):null;k?isBlock(S)&&h(k.range,"BLOCK_IN_FLOW",p):l.comment&&(o.comment?o.comment+="\n"+l.comment:o.comment=l.comment);const A=new r.Pair(o,k);if(s.options.keepSourceTokens&&(A.srcToken=a),m){const e=y;u.mapIncludes(s,e.items,o)&&h(n,"DUPLICATE_KEY","Map keys must be unique"),e.items.push(A)}else{const e=new i.YAMLMap(s.schema);e.flow=!0,e.items.push(A);const t=(k??o).range;e.range=[o.range[0],t[1],t[2]],y.items.push(e)}v=k?k.range[2]:l.end}else{const n=S?e(s,S,E,h):t(s,E.end,w,null,E,h);y.items.push(n),v=n.range[2],isBlock(S)&&h(n.range,"BLOCK_IN_FLOW",p)}}const w=m?"}":"]",[S,...E]=f.end;let k=v;if(S?.source===w)k=S.offset+S.source.length;else{const e=g[0].toUpperCase()+g.substring(1);h(v,b?"MISSING_CHAR":"BAD_INDENT",b?`${e} must end with a ${w}`:`${e} in block collection must be sufficiently indented and end with a ${w}`),S&&1!==S.source.length&&E.unshift(S)}if(E.length>0){const e=a.resolveEnd(E,k,s.options.strict,h);e.comment&&(y.comment?y.comment+="\n"+e.comment:y.comment=e.comment),y.range=[f.offset,k,e.offset]}else y.range=[f.offset,k,k];return y}},2557:(e,t,s)=>{"use strict";var n=s(484),r=s(7902),i=s(1755);class YAMLSet extends i.YAMLMap{constructor(e){super(e),this.tag=YAMLSet.tag}add(e){let t;t=n.isPair(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new r.Pair(e.key,null):new r.Pair(e,null);i.findPair(this.items,t.key)||this.items.push(t)}get(e,t){const s=i.findPair(this.items,e);return!t&&n.isPair(s)?n.isScalar(s.key)?s.key.value:s.key:s}set(e,t){if("boolean"!=typeof t)throw new Error("Expected boolean value for set(key, value) in a YAML set, not "+typeof t);const s=i.findPair(this.items,e);s&&!t?this.items.splice(this.items.indexOf(s),1):!s&&t&&this.items.push(new r.Pair(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,s){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,s);throw new Error("Set items must all have null values")}static from(e,t,s){const{replacer:n}=s,i=new this(e);if(t&&Symbol.iterator in Object(t))for(let e of t)"function"==typeof n&&(e=n.call(t,e,e)),i.items.push(r.createPair(e,null,s));return i}}YAMLSet.tag="tag:yaml.org,2002:set";const o={collection:"map",identify:e=>e instanceof Set,nodeClass:YAMLSet,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,t,s)=>YAMLSet.from(e,t,s),resolve(e,t){if(n.isMap(e)){if(e.hasAllNullValues(!0))return Object.assign(new YAMLSet,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e}};t.YAMLSet=YAMLSet,t.set=o},2782:(e,t,s)=>{"use strict";var n=s(1736),r=s(484),i=s(18),o=s(9094),a=s(6845),c=s(1040);const l={composeNode,composeEmptyNode};function composeNode(e,t,s,c){const u=e.atKey,{spaceBefore:p,comment:f,anchor:h,tag:d}=s;let m,g=!0;switch(t.type){case"alias":m=function composeAlias({options:e},{offset:t,source:s,end:r},i){const o=new n.Alias(s.substring(1));""===o.source&&i(t,"BAD_ALIAS","Alias cannot be an empty string");o.source.endsWith(":")&&i(t+s.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const c=t+s.length,l=a.resolveEnd(r,c,e.strict,i);o.range=[t,c,l.offset],l.comment&&(o.comment=l.comment);return o}(e,t,c),(h||d)&&c(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":m=o.composeScalar(e,t,d,c),h&&(m.anchor=h.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":m=i.composeCollection(l,e,t,s,c),h&&(m.anchor=h.source.substring(1));break;default:c(t,"UNEXPECTED_TOKEN","error"===t.type?t.message:`Unsupported token (type: ${t.type})`),m=composeEmptyNode(e,t.offset,void 0,null,s,c),g=!1}if(h&&""===m.anchor&&c(h,"BAD_ALIAS","Anchor cannot be an empty string"),u&&e.options.stringKeys&&(!r.isScalar(m)||"string"!=typeof m.value||m.tag&&"tag:yaml.org,2002:str"!==m.tag)){c(d??t,"NON_STRING_KEY","With stringKeys, all keys must be strings")}return p&&(m.spaceBefore=!0),f&&("scalar"===t.type&&""===t.source?m.comment=f:m.commentBefore=f),e.options.keepSourceTokens&&g&&(m.srcToken=t),m}function composeEmptyNode(e,t,s,n,{spaceBefore:r,comment:i,anchor:a,tag:l,end:u},p){const f={type:"scalar",offset:c.emptyScalarPosition(t,s,n),indent:-1,source:""},h=o.composeScalar(e,f,l,p);return a&&(h.anchor=a.source.substring(1),""===h.anchor&&p(a,"BAD_ALIAS","Anchor cannot be an empty string")),r&&(h.spaceBefore=!0),i&&(h.comment=i,h.range[2]=u),h}t.composeEmptyNode=composeEmptyNode,t.composeNode=composeNode},2864:(e,t)=>{"use strict";t.LineCounter=class LineCounter{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,s=this.lineStarts.length;for(;t<s;){const n=t+s>>1;this.lineStarts[n]<e?t=n+1:s=n}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(0===t)return{line:0,col:e};return{line:t,col:e-this.lineStarts[t-1]+1}}}}},2891:(e,t,s)=>{"use strict";var n=s(3144);const intIdentify=e=>"bigint"==typeof e||Number.isInteger(e),intResolve=(e,t,s,{intAsBigInt:n})=>n?BigInt(e):parseInt(e.substring(t),s);function intStringify(e,t,s){const{value:r}=e;return intIdentify(r)&&r>=0?s+r.toString(t):n.stringifyNumber(e)}const r={identify:e=>intIdentify(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,s)=>intResolve(e,2,8,s),stringify:e=>intStringify(e,8,"0o")},i={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,s)=>intResolve(e,0,10,s),stringify:n.stringifyNumber},o={identify:e=>intIdentify(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,s)=>intResolve(e,2,16,s),stringify:e=>intStringify(e,16,"0x")};t.int=i,t.intHex=o,t.intOct=r},3144:(e,t)=>{"use strict";t.stringifyNumber=function stringifyNumber({format:e,minFractionDigits:t,tag:s,value:n}){if("bigint"==typeof n)return String(n);const r="number"==typeof n?n:Number(n);if(!isFinite(r))return isNaN(r)?".nan":r<0?"-.inf":".inf";let i=Object.is(n,-0)?"-0":JSON.stringify(n);if(!e&&t&&(!s||"tag:yaml.org,2002:float"===s)&&/^\d/.test(i)){let e=i.indexOf(".");e<0&&(e=i.length,i+=".");let s=t-(i.length-e-1);for(;s-- >0;)i+="0"}return i}},3307:(e,t,s)=>{e=s.nmd(e);const n=s(9896),r=s(6928),i=s(9031),{pickFirstString:o,resolveConfiguredPath:a,normalizeExtension:c}=s(9243),{formatYaml:l}=s(652);let u;try{u=s(1398)}catch(e){u=void 0}const{AzurePipelineParser}=s(4339),{NONAME:p}=s(2250);function buildFormatOptionsFromCli(e){if(!Array.isArray(e)||0===e.length)return;const t={};return e.forEach(e=>{if("string"!=typeof e)return;const s=e.indexOf("=");if(s<=0||s===e.length-1)return void console.warn(`Ignoring invalid --format entry '${e}'. Expected key=value.`);const n=e.slice(0,s).trim(),r=e.slice(s+1).trim();if(!n.length)return void console.warn(`Ignoring --format entry with empty key: '${e}'.`);const i={indent:[1,8],lineWidth:[0,Number.MAX_SAFE_INTEGER],firstBlockBlankLines:[0,4],blankLinesBetweenSections:[0,4]};["noArrayIndent","forceQuotes","sortKeys","stepSpacing"].includes(n)?"true"===r||"false"===r?t[n]="true"===r:console.warn(`Ignoring --format ${n}: expected boolean 'true' or 'false'.`):i[n]?function tryAssignIntegerOption(e,t,s,n,r){const i=Number.parseInt(s,10);!Number.isFinite(i)||i<n||i>r?console.warn(`Ignoring --format ${t}: expected integer between ${n} and ${r}.`):e[t]=i}(t,n,r,...i[n]):"newline"===n||"newlineFormat"===n?t.newlineFormat=r.replace(/\\r\\n/g,"\r\n").replace(/\\n/g,"\n").replace(/\\r/g,"\r"):console.warn(`Ignoring unsupported --format option '${n}'.`)}),Object.keys(t).length?t:void 0}function formatFilesRecursively(e,t,s){const i=new Set(Array.isArray(t)?t.map(e=>c(e)).filter(Boolean):[]);i.size||(i.add(".yml"),i.add(".yaml"));const o={totalFiles:0,formattedFiles:[],warnings:[],errors:[]};if(!Array.isArray(e)||!e.length)return o;const a=new Set,walk=e=>{if(!e)return;const t=r.resolve(process.cwd(),e);if(a.has(t))return;let u;a.add(t);try{u=n.lstatSync(t)}catch(e){return void o.errors.push({filePath:t,message:`Cannot access: ${e.message}`})}if(!u.isSymbolicLink()){if(u.isDirectory()){let e;try{e=n.readdirSync(t)}catch(e){return void o.errors.push({filePath:t,message:`Cannot read directory: ${e.message}`})}return void e.forEach(e=>{try{walk(r.join(t,e))}catch(s){o.errors.push({filePath:r.join(t,e),message:`Unexpected error: ${s.message}`})}})}if(u.isFile()){const e=c(r.extname(t));e&&i.has(e)&&(e=>{o.totalFiles+=1;try{const t=n.readFileSync(e,"utf8"),r={...s,fileName:e},i=l(t,r);if(i.error)return void o.errors.push({filePath:e,message:i.error});i.text!==t&&(n.writeFileSync(e,i.text,"utf8"),o.formattedFiles.push(e),i.warning&&o.warnings.push({filePath:e,message:i.warning}))}catch(t){o.errors.push({filePath:e,message:t.message})}})(t)}}};return e.forEach(e=>{try{walk(e)}catch(t){o.errors.push({filePath:e,message:`Failed to process target: ${t.message}`})}}),o}e.exports={activate:function activate(e){if(!u)return void console.warn("VS Code API unavailable; activate() skipped (CLI execution detected).");console.log("Azure Pipeline YAML Parser extension is now active!");const t=new AzurePipelineParser;let s;const n="ado-pipeline-expanded",i=new Map,c=new u.EventEmitter;e.subscriptions.push(c),e.subscriptions.push(u.workspace.registerTextDocumentContentProvider(n,{onDidChange:c.event,provideTextDocumentContent:e=>i.get(e.toString())||""}));const getRenderTargetUri=e=>{const t=r.basename(e.fileName||"pipeline.yml")||"pipeline.yml",s=encodeURIComponent(e.fileName||t);return u.Uri.from({scheme:n,path:"/"+t,query:`${s}|expanded`})},getFormatSettings=e=>{const t={noArrayIndent:!0,indent:2,lineWidth:0,forceQuotes:!1,sortKeys:!1,firstBlockBlankLines:2,betweenSectionBlankLines:1,normalizeAzureVariablePaths:!0,newlineFormat:"\n"};if(!u)return t;try{const s=u.workspace.getConfiguration("azurePipelineStudio",e?.uri),n={...t};["noArrayIndent","forceQuotes","sortKeys","stepSpacing","normalizeAzureVariablePaths"].forEach(e=>{const t=s.get(`format.${e}`);"boolean"==typeof t&&(n[e]=t)});const r=s.get("format.indent");Number.isInteger(r)&&r>0&&r<=8&&(n.indent=r);const i=s.get("format.lineWidth");"number"==typeof i&&i>=0&&(n.lineWidth=i);[{key:"firstBlockBlankLines",min:0,max:4},{key:"betweenSectionBlankLines",min:0,max:4}].forEach(({key:e,min:t,max:r})=>{const i=s.get(`format.${e}`);Number.isInteger(i)&&i>=t&&i<=r&&(n[e]=i)});const o=s.get("format.newlineFormat");return"\n"!==o&&"\r\n"!==o||(n.newlineFormat=o),n}catch(e){return console.warn("Failed to read azurePipelineStudio.format settings:",e),t}},renderYamlDocument=async(e,n={})=>{if(!e)return;s=e;const p=e.getText();try{const s=u.workspace.getConfiguration("azurePipelineStudio",e.uri).get("expansion.variables",{}),f=function buildResourceOverridesForDocument(e){if(!u||!e)return;const t=u.workspace.getConfiguration("azurePipelineStudio",e.uri),s=t.get("resourceLocations");if(!Array.isArray(s)||!s.length)return;const n=u.workspace.getWorkspaceFolder(e.uri),i=n?.uri.fsPath,c=e.fileName?r.dirname(e.fileName):void 0,l={};for(const e of s){if(!e||"object"!=typeof e)continue;const t=e.repository?.trim(),s=o(e.path,e.location);if(!t||!s)continue;const n=a(s,i,c);if(!n)continue;const r={location:n},u={};["repository","name","endpoint","ref","type"].forEach(t=>{const s=e[t]?.trim();s&&(u[t]=s)}),Object.keys(u).length&&(r.__match=u),l[t]=r}return Object.keys(l).length?{repositories:l}:void 0}(e),h=n.azureCompatible??!1,d={fileName:e.fileName,azureCompatible:h,...f&&{resources:f},...Object.keys(s).length&&{variables:s}};console.log("Parser overrides:",JSON.stringify(d,null,2));const m=t.expandPipelineToString(p,d),g=getFormatSettings(e);g.fileName=e.fileName,g.wasExpanded=!0;const y=l(m,g),b=getRenderTargetUri(e);if(i.set(b.toString(),y.text),c.fire(b),!n.silent){const e=await u.workspace.openTextDocument(b);await u.window.showTextDocument(e,{viewColumn:u.ViewColumn.Beside,preview:!1,preserveFocus:!0})}}catch(t){console.error("Error expanding pipeline:",t);const s=getRenderTargetUri(e),r=`# Error Expanding Azure Pipeline\n\n${t.message}\n\n---\n\n${t.stack||""}`;if(i.set(s.toString(),r),c.fire(s),!n.silent){const e=await u.workspace.openTextDocument(s);await u.window.showTextDocument(e,{viewColumn:u.ViewColumn.Beside,preview:!1,preserveFocus:!0})}u.window.showErrorMessage(`Failed to expand Azure Pipeline: ${t.message}`)}},shouldRenderDocument=e=>{if(!e||!e.fileName)return!1;const t=e.fileName.toLowerCase();return t.endsWith(".yaml")||t.endsWith(".yml")},p=u.commands.registerCommand("azurePipelineStudio.showRenderedYaml",async()=>{const e=u.window.activeTextEditor;e&&shouldRenderDocument(e.document)?await renderYamlDocument(e.document,{azureCompatible:!1}):u.window.showInformationMessage("Open an Azure Pipeline YAML file to view the expanded contents.")});e.subscriptions.push(p);const f=u.commands.registerCommand("azurePipelineStudio.showRenderedYamlAzureCompatible",async()=>{const e=u.window.activeTextEditor;e&&shouldRenderDocument(e.document)?await renderYamlDocument(e.document,{azureCompatible:!0}):u.window.showInformationMessage("Open an Azure Pipeline YAML file to view the expanded contents.")});e.subscriptions.push(f);const h=u.commands.registerCommand("azurePipelineStudio.formatOriginalYaml",async()=>{const e=u.window.activeTextEditor;e&&shouldRenderDocument(e.document)?await(async e=>{if(!e)return;const t=e.getText(),s=getFormatSettings(e);s.fileName=e.fileName,s.wasExpanded=!1;const n=l(t,s);if(n.error)return void u.window.showErrorMessage(n.error);if(n.text===t)return void(n.warning?u.window.showWarningMessage(n.warning):u.window.showInformationMessage("YAML is already formatted."));const r=e.validateRange(new u.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)),i=new u.WorkspaceEdit;i.replace(e.uri,r,n.text),await u.workspace.applyEdit(i)?n.warning?u.window.showWarningMessage(n.warning):u.window.setStatusBarMessage("Applied YAML formatting.",3e3):u.window.showErrorMessage("Failed to apply YAML formatting changes.")})(e.document):u.window.showInformationMessage("Open an Azure Pipeline YAML file before formatting.")});e.subscriptions.push(h);const d=u.commands.registerCommand("azurePipelineStudio.configureResourceLocations",async()=>{try{console.log("[Azure Pipeline Studio] Configure Resource Locations command triggered"),await async function handleConfigureResourceLocationRequest(e){const t=s||(u.window.activeTextEditor&&shouldRenderDocument(u.window.activeTextEditor.document)?u.window.activeTextEditor.document:void 0);if(!t)return void u.window.showInformationMessage("Open an Azure Pipeline YAML file before configuring resource locations.");const n=u.workspace.getConfiguration("azurePipelineStudio",t.uri),r=n.get("resourceLocations"),i=Array.isArray(r)?r.filter(e=>e&&"object"==typeof e):[],getRepositoryAlias=e=>{if(!e||"object"!=typeof e)return;const t=[e.repository,e.alias,e.name];for(const e of t)if("string"==typeof e&&e.trim().length)return e.trim()};let a,c="string"==typeof e&&e.trim().length?e.trim():void 0;if(c)a=i.find(e=>getRepositoryAlias(e)===c);else{const e=i.map(e=>{const t=getRepositoryAlias(e);if(t)return{label:t,description:o(e.location,e.path)||"",entry:e}}).filter(Boolean);e.push({label:"$(plus) Add new repository mapping",description:"Create a new entry for a repository resource.",newEntry:!0});const t=await u.window.showQuickPick(e,{placeHolder:"Select a repository resource to configure"});if(!t)return;if(t.newEntry){const e=await u.window.showInputBox({prompt:"Repository alias or name",placeHolder:"templatesRepo",ignoreFocusOut:!0});if(!e||!e.trim().length)return;c=e.trim()}else c=t.label,a=t.entry}if(!c)return;a||(a=i.find(e=>getRepositoryAlias(e)===c));const l=a?o(a.location,a.path):void 0,p=await u.window.showQuickPick([{label:"$(folder) Browse for folder",description:"Open a folder picker dialog",method:"browse"},{label:"$(edit) Enter path manually",description:"Type or paste a file path",method:"manual"}],{placeHolder:`Select how to specify location for repository '${c}'`,ignoreFocusOut:!0});if(!p)return;let f;if("browse"===p.method){const e=await u.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,openLabel:`Select location for '${c}'`,defaultUri:l?u.Uri.file(l):void 0});if(!e||0===e.length)return void u.window.showInformationMessage("Repository location not updated.");f=e[0].fsPath,console.log(`[Azure Pipeline Studio] Selected folder location: ${f}`)}else{if(f=await u.window.showInputBox({prompt:`Local path for repository '${c}'`,placeHolder:"${workspaceFolder}/path/to/templates",value:l||"",ignoreFocusOut:!0}),!f||!f.trim().length)return void u.window.showInformationMessage("Repository location not updated.");console.log(`[Azure Pipeline Studio] Entered manual location: ${f}`)}const h=f.trim(),d=[];let m=!1;i.forEach(e=>{if(getRepositoryAlias(e)===c){const t={...e,repository:c,location:h};delete t.path,d.push(t),m=!0}else d.push({...e})}),m||d.push({repository:c,location:h});u.workspace.getWorkspaceFolder(t.uri);const g=u.ConfigurationTarget.Workspace;try{console.log(`[Azure Pipeline Studio] About to save repository '${c}' location: ${h}`),console.log("[Azure Pipeline Studio] Target:",g),console.log("[Azure Pipeline Studio] Entries to save:",JSON.stringify(d,null,2)),await n.update("resourceLocations",d,g),console.log(`[Azure Pipeline Studio] Successfully saved repository '${c}' location: ${h}`),u.window.showInformationMessage(`Repository '${c}' location saved.`),await renderYamlDocument(t)}catch(e){console.error("[Azure Pipeline Studio] Error saving repository location:",e),u.window.showErrorMessage(`Failed to save repository location: ${e.message}`)}}()}catch(e){console.error("[Azure Pipeline Studio] Error in configure command:",e),u.window.showErrorMessage(`Configuration error: ${e.message}`)}});e.subscriptions.push(d),e.subscriptions.push(u.workspace.onDidCloseTextDocument(e=>{e.uri.scheme===n&&i.delete(e.uri.toString())})),e.subscriptions.push(u.workspace.onDidChangeTextDocument(e=>{const{document:t}=e;shouldRenderDocument(t)&&s&&s.fileName===t.fileName&&renderYamlDocument(t,{silent:!0})})),e.subscriptions.push(u.workspace.onDidSaveTextDocument(e=>{if(!shouldRenderDocument(e))return;if(!s||s.fileName!==e.fileName)return;u.workspace.getConfiguration("azurePipelineStudio",e.uri).get("refreshOnSave",!0)&&renderYamlDocument(e,{silent:!0})}))},deactivate:function deactivate(){},AzurePipelineParser,formatYaml:l,formatFilesRecursively},s.c[s.s]===e&&function runCli(e){if(void 0!==u)return;const t="Usage: node extension.js <file1> <file2> ...\nOptions:\n  -h, --help                   Show this help message\n  -o, --output <file>          Write output to file (default: in-place, only with single file)\n  -r, --repo <alias=path>      Map repository alias to local path\n  -v, --variables <key=value>  Set compile-time variables (e.g., Build.Reason=Manual)\n  -f, --format-option <key=value>  Set format option (e.g., indent=4)\n  -R, --format-recursive <path>    Format files recursively in directory\n  -e, --extension <ext>        File extensions to format (default: .yml, .yaml)\n  -x, --expand-templates       Expand Azure Pipeline template expressions (${{}},$[],$())\n  -a, --azure-compatible       Use Azure-compatible expansion mode (adds blank lines, etc.)\n  -d, --debug                  Print files being formatted",s=i(e,{string:["output","repo","format-option","format-recursive","extension","variables"],boolean:["help","expand-templates","azure-compatible","debug"],alias:{h:"help",o:"output",r:"repo",f:"format-option",R:"format-recursive",e:"extension",v:"variables",x:"expand-templates",a:"azure-compatible",d:"debug"},default:{extension:[],"expand-templates":!1,"azure-compatible":!1,debug:!1}});s.help&&(console.log(t),process.exit(0));const toArray=e=>[].concat(e||[]),o=toArray(s.repo),c=toArray(s.variables),p=toArray(s["format-option"]),f=toArray(s["format-recursive"]),h=toArray(s.extension),d=[],m={},g=[];for(const e of o){const[t,...s]=e.split("="),n=s.join("=").trim();t&&t.trim()&&n?d.push({alias:t.trim(),path:n}):g.push(`Invalid repository mapping "${e}". Expected format "alias=path".`)}for(const e of c){const[t,...s]=e.split("="),n=s.join("=").trim();t&&t.trim()&&void 0!==n?m[t.trim()]=n:g.push(`Invalid variable "${e}". Expected format "key=value".`)}for(const e of p)e.includes("=")||g.push(`Invalid format option "${e}". Expected format "key=value".`);if(g.length)return g.forEach(e=>console.error(e)),console.error(t),void(process.exitCode=1);if(f.length){const e=buildFormatOptionsFromCli(p)||{},t=formatFilesRecursively(f,h.length?h:[".yml",".yaml"],e);return t.formattedFiles.forEach(e=>{const t=r.relative(process.cwd(),e)||e;console.log(`Formatted: ${t}`)}),console.log(`Processed ${t.totalFiles} file(s); formatted ${t.formattedFiles.length}.`),t.warnings.forEach(e=>{const t=r.relative(process.cwd(),e.filePath)||e.filePath;console.warn(`[warn] ${t}: ${e.message}`)}),t.errors.forEach(e=>{const t=r.relative(process.cwd(),e.filePath)||e.filePath;console.error(`[error] ${t}: ${e.message}`)}),void(t.errors.length&&(process.exitCode=1))}const y=s._;if(0===y.length)return console.error(t),void(process.exitCode=1);if(s.output&&y.length>1)return console.error("Error: --output option is only supported when formatting a single file."),console.error(t),void(process.exitCode=1);const b=buildFormatOptionsFromCli(p)||{},v=function buildRepositoryOverridesFromCliEntries(e,t){if(!Array.isArray(e)||0===e.length)return;const s={};return e.forEach(e=>{if(!e||"object"!=typeof e)return;const n=e.alias,r=e.path;if("string"!=typeof n||!n.trim().length||"string"!=typeof r||!r.trim().length)return;const i=a(r,t,void 0);i?s[n]={repository:n,location:i}:console.warn(`Skipping repository mapping '${n}': could not resolve path '${r}'.`)}),Object.keys(s).length?s:void 0}(d,process.cwd()),w=Object.keys(m).length>0?m:void 0,S=s["expand-templates"]?new AzurePipelineParser:null;let E=!1;for(const e of y){const t=r.resolve(process.cwd(),e);s.debug&&console.log(`[DEBUG] Formatting: ${t}`);try{const i=n.readFileSync(t,"utf8");let o=i;if(s["expand-templates"]&&S){const n={fileName:t,azureCompatible:s["azure-compatible"]||!1};if(v){const e={};for(const[t,s]of Object.entries(v))e[t]=s.location||s.path;n.resourceLocations=e,s.debug&&console.log("[DEBUG] Resource locations:",JSON.stringify(e,null,2))}w&&(n.variables=w,s.debug&&console.log("[DEBUG] Compile-time variables:",JSON.stringify(w,null,2)));try{expandedYaml=S.expandPipelineToString(i,n),o=expandedYaml}catch(t){console.error(`[${e}] Template expansion failed: ${t.message}`),s.debug&&console.error("[DEBUG] Full error:",t),E=!0;continue}}const a={...b||{},fileName:t};delete a.expandTemplates,s["expand-templates"]&&(a.wasExpanded=!0);const c=l(o,a);if(c.error){console.error(`[${e}] ${c.error}`),E=!0;continue}c.warning&&console.warn(`[${e}] ${c.warning}`);const u=c.text;if(s.output){const e=r.resolve(process.cwd(),s.output);if(n.writeFileSync(e,u,"utf8"),i!==u){const t=s["expand-templates"]?"Expanded":"Formatted";console.log(`${t} pipeline written to ${e}`)}}else s["expand-templates"]?console.log(u):i!==u&&(n.writeFileSync(t,u,"utf8"),console.log(`Formatted ${e} (in-place)`))}catch(t){console.error(`[${e}] ${t.message}`),E=!0}}E&&(process.exitCode=1)}(process.argv.slice(2))},3334:(e,t,s)=>{"use strict";var n=s(484),r=s(1755);const i={collection:"map",default:!0,nodeClass:r.YAMLMap,tag:"tag:yaml.org,2002:map",resolve:(e,t)=>(n.isMap(e)||t("Expected a mapping for this tag"),e),createNode:(e,t,s)=>r.YAMLMap.from(e,t,s)};t.map=i},3732:(e,t,s)=>{"use strict";var n=s(484);t.toJS=function toJS(e,t,s){if(Array.isArray(e))return e.map((e,t)=>toJS(e,String(t),s));if(e&&"function"==typeof e.toJSON){if(!s||!n.hasAnchor(e))return e.toJSON(t,s);const r={aliasCount:0,count:1,res:void 0};s.anchors.set(e,r),s.onCreate=e=>{r.res=e,delete s.onCreate};const i=e.toJSON(t,s);return s.onCreate&&s.onCreate(i),i}return"bigint"!=typeof e||s?.keep?e:Number(e)}},3793:(e,t,s)=>{"use strict";var n=s(6261),r=s(484),i=s(248),o=s(7180);t.createStringifyContext=function createStringifyContext(e,t){const s=Object.assign({blockQuote:!0,commentString:i.stringifyComment,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t);let n;switch(s.collectionStyle){case"block":n=!1;break;case"flow":n=!0;break;default:n=null}return{anchors:new Set,doc:e,flowCollectionPadding:s.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof s.indent?" ".repeat(s.indent):"  ",inFlow:n,options:s}},t.stringify=function stringify(e,t,s,i){if(r.isPair(e))return e.toString(t,s,i);if(r.isAlias(e)){if(t.doc.directives)return e.toString(t);if(t.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let a;const c=r.isNode(e)?e:t.doc.createNode(e,{onTagObj:e=>a=e});a??(a=function getTagObject(e,t){if(t.tag){const s=e.filter(e=>e.tag===t.tag);if(s.length>0)return s.find(e=>e.format===t.format)??s[0]}let s,n;if(r.isScalar(t)){n=t.value;let r=e.filter(e=>e.identify?.(n));if(r.length>1){const e=r.filter(e=>e.test);e.length>0&&(r=e)}s=r.find(e=>e.format===t.format)??r.find(e=>!e.format)}else n=t,s=e.find(e=>e.nodeClass&&n instanceof e.nodeClass);if(!s)throw new Error(`Tag not resolved for ${n?.constructor?.name??(null===n?"null":typeof n)} value`);return s}(t.doc.schema.tags,c));const l=function stringifyProps(e,t,{anchors:s,doc:i}){if(!i.directives)return"";const o=[],a=(r.isScalar(e)||r.isCollection(e))&&e.anchor;a&&n.anchorIsValid(a)&&(s.add(a),o.push(`&${a}`));const c=e.tag??(t.default?null:t.tag);return c&&o.push(i.directives.tagString(c)),o.join(" ")}(c,a,t);l.length>0&&(t.indentAtStart=(t.indentAtStart??0)+l.length+1);const u="function"==typeof a.stringify?a.stringify(c,t,s,i):r.isScalar(c)?o.stringifyString(c,t,s,i):c.toString(t,s,i);return l?r.isScalar(c)||"{"===u[0]||"["===u[0]?`${l} ${u}`:`${l}\n${t.indent}${u}`:u}},4070:(e,t,s)=>{"use strict";var n=s(9714);t.resolveBlockScalar=function resolveBlockScalar(e,t,s){const r=t.offset,i=function parseBlockScalarHeader({offset:e,props:t},s,n){if("block-scalar-header"!==t[0].type)return n(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:r}=t[0],i=r[0];let o=0,a="",c=-1;for(let t=1;t<r.length;++t){const s=r[t];if(a||"-"!==s&&"+"!==s){const n=Number(s);!o&&n?o=n:-1===c&&(c=e+t)}else a=s}-1!==c&&n(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${r}`);let l=!1,u="",p=r.length;for(let e=1;e<t.length;++e){const r=t[e];switch(r.type){case"space":l=!0;case"newline":p+=r.source.length;break;case"comment":if(s&&!l){n(r,"MISSING_CHAR","Comments must be separated from other tokens by white space characters")}p+=r.source.length,u=r.source.substring(1);break;case"error":n(r,"UNEXPECTED_TOKEN",r.message),p+=r.source.length;break;default:{n(r,"UNEXPECTED_TOKEN",`Unexpected token in block scalar header: ${r.type}`);const e=r.source;e&&"string"==typeof e&&(p+=e.length)}}}return{mode:i,indent:o,chomp:a,comment:u,length:p}}(t,e.options.strict,s);if(!i)return{value:"",type:null,comment:"",range:[r,r,r]};const o=">"===i.mode?n.Scalar.BLOCK_FOLDED:n.Scalar.BLOCK_LITERAL,a=t.source?function splitLines(e){const t=e.split(/\n( *)/),s=t[0],n=s.match(/^( *)/),r=[n?.[1]?[n[1],s.slice(n[1].length)]:["",s]];for(let e=1;e<t.length;e+=2)r.push([t[e],t[e+1]]);return r}(t.source):[];let c=a.length;for(let e=a.length-1;e>=0;--e){const t=a[e][1];if(""!==t&&"\r"!==t)break;c=e}if(0===c){const e="+"===i.chomp&&a.length>0?"\n".repeat(Math.max(1,a.length-1)):"";let s=r+i.length;return t.source&&(s+=t.source.length),{value:e,type:o,comment:i.comment,range:[r,s,s]}}let l=t.indent+i.indent,u=t.offset+i.length,p=0;for(let t=0;t<c;++t){const[n,r]=a[t];if(""!==r&&"\r"!==r){if(n.length<l){const e="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";s(u+n.length,"MISSING_CHAR",e)}if(0===i.indent&&(l=n.length),p=t,0===l&&!e.atRoot){s(u,"BAD_INDENT","Block scalar values in collections must be indented")}break}0===i.indent&&n.length>l&&(l=n.length),u+=n.length+r.length+1}for(let e=a.length-1;e>=c;--e)a[e][0].length>l&&(c=e+1);let f="",h="",d=!1;for(let e=0;e<p;++e)f+=a[e][0].slice(l)+"\n";for(let e=p;e<c;++e){let[t,r]=a[e];u+=t.length+r.length+1;const c="\r"===r[r.length-1];if(c&&(r=r.slice(0,-1)),r&&t.length<l){const e=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;s(u-r.length-(c?2:1),"BAD_INDENT",e),t=""}o===n.Scalar.BLOCK_LITERAL?(f+=h+t.slice(l)+r,h="\n"):t.length>l||"\t"===r[0]?(" "===h?h="\n":d||"\n"!==h||(h="\n\n"),f+=h+t.slice(l)+r,h="\n",d=!0):""===r?"\n"===h?f+="\n":h="\n":(f+=h+r,h=" ",d=!1)}switch(i.chomp){case"-":break;case"+":for(let e=c;e<a.length;++e)f+="\n"+a[e][0].slice(l);"\n"!==f[f.length-1]&&(f+="\n");break;default:f+="\n"}const m=r+i.length+t.source.length;return{value:f,type:o,comment:i.comment,range:[r,m,m]}}},4339:(e,t,s)=>{e=s.nmd(e);const n=s(9896),r=s(857),i=s(6928),o=s(1198),a=s(132);class AzurePipelineParser{constructor(e={}){this.expressionCache=new Map}expandPipelineFromFile(e,t={}){const s=n.readFileSync(e,"utf8"),r={...t,fileName:e,baseDir:i.dirname(e),templateStack:[e]};return this.expandPipelineToString(s,r)}expandPipelineToString(e,t={}){const{document:s}=this.expandPipeline(e,t),n=s.__quoteStyles||new Map;delete s.__quoteStyles;const r=s.__scriptsWithExpressions||new Set;delete s.__scriptsWithExpressions;const i=s.__scriptsWithLastLineExpressions||new Set;delete s.__scriptsWithLastLineExpressions;const a=o.parseDocument(o.stringify(s));this.restoreQuoteStyles(a.contents,[],n);const c=t.azureCompatible||!1;console.log(`Azure Compatibility mode: ${c}`),this.applyBlockScalarStyles(a.contents,r,i,c);let l=a.toString({lineWidth:0,indent:2,defaultStringType:"PLAIN",defaultKeyType:"PLAIN",simpleKeys:!1,aliasDuplicateObjects:!1});return l=l.replace(/^(\s*(?:-\s+)?[^":\n]+:\s*)["'](\d+(?:\.\d+)?)["']/gm,(e,t,s)=>t.includes('"')?e:t+s),l=l.replace(/(['"]?)__(?:TRUE|FALSE)__\1/g,(e,t)=>t?`${t}${e.includes("TRUE")?"True":"False"}${t}`:e.includes("TRUE")?"True":"False"),c?(l=l.replace(/^(\S.+)\n\n(\s*-\s)/gm,"$1\n$2"),l=l.replace(/^(\S.+)\n\n(\s*\w+:)/gm,"$1\n$2"),l.endsWith("\n\n\n")||(l=l.replace(/\n*$/,"\n\n\n"))):l=l.replace(/\n*$/,"\n"),l}expandPipeline(e,t={}){const s=this.preprocessCompileTimeExpressions(e);let n,r=new Map;try{const e=o.parseDocument(s);this.extractQuoteStyles(e.contents,[],r),n=e.toJSON()||{}}catch(e){throw new Error(`Failed to parse YAML: ${e.message}`)}n=this.restoreCompileTimeExpressions(n);const i=this.buildExecutionContext(n,t);i.quoteStyles=r;const a=this.expandNode(n,i),c=new Map(r);if(i.templateQuoteStyles)for(const[,e]of i.templateQuoteStyles.entries())for(const[t,s]of e.entries())c.has(t)||c.set(t,s);return a.__quoteStyles=c,a.__scriptsWithExpressions=i.scriptsWithExpressions||new Set,a.__scriptsWithLastLineExpressions=i.scriptsWithLastLineExpressions||new Set,{document:a,context:i}}extractQuoteStyles(e,t,s,n=""){if(e)if(e.items&&"YAMLMap"===e.constructor.name){let r=n,i="";for(const t of e.items)if(t.key&&t.value&&"string"==typeof t.value.value){const e=t.key.value;if("displayName"===e){r=t.value.value;break}"task"!==e&&"name"!==e||(i=t.value.value)}r===n&&i&&(r=i);for(const n of e.items)if(n.key&&n.key.value){const e=[...t,n.key.value];if(n.value&&"string"==typeof n.value.value){const t=n.value.type,i=n.key.value,o=n.value.value;"QUOTE_SINGLE"!==t&&"QUOTE_DOUBLE"!==t||(s.set(e.join("."),t),r&&s.set(`__ctx:${r}:${i}:${o}`,t),""===o&&(s.has("__empty_string")||s.set("__empty_string",t)),o.length>2&&/\*\*|[*/]\/|\/[*/]/.test(o)&&(s.has(`__glob:${o}`)||s.set(`__glob:${o}`,t)))}n.value&&this.extractQuoteStyles(n.value,e,s,r)}}else e.items&&"YAMLSeq"===e.constructor.name&&e.items.forEach((e,r)=>{const i=[...t,r];this.extractQuoteStyles(e,i,s,n)})}restoreQuoteStyles(e,t,s,n=""){if(e)if(e.items&&"YAMLMap"===e.constructor.name){let r=n,i="";for(const t of e.items)if(t.key&&t.value&&"string"==typeof t.value.value){const e=t.key.value;if("displayName"===e){r=t.value.value;break}"task"!==e&&"name"!==e||(i=t.value.value)}r===n&&i&&(r=i);for(const n of e.items)if(n.key&&n.key.value&&n.value){const e=[...t,n.key.value],i=e.join(".");let o=s.get(i);if(!o&&"string"==typeof n.value.value){const e=n.key.value,t=n.value.value;r&&(o=s.get(`__ctx:${r}:${e}:${t}`)),!o&&t.length>2&&/\*\*|[*/]\/|\/[*/]/.test(t)&&(o=s.get(`__glob:${t}`)),o||""!==t||(o=s.get("__empty_string"))}o&&void 0!==n.value.value&&(n.value.type=o),this.restoreQuoteStyles(n.value,e,s,r)}}else e.items&&"YAMLSeq"===e.constructor.name&&e.items.forEach((e,r)=>{const i=[...t,r];this.restoreQuoteStyles(e,i,s,n)})}applyBlockScalarStyles(e,t=new Set,s=new Set,n=!1){if(e)if(e.items&&"YAMLMap"===e.constructor.name)for(const r of e.items){if(!r.key?.value||!r.value)continue;const{value:e}=r;if("string"!=typeof e.value||!e.value.includes("\n")){this.applyBlockScalarStyles(e,t,s,n);continue}let i=e.value;if(n&&this.hasTrailingSpaces(i))e.type="QUOTE_DOUBLE",this.applyBlockScalarStyles(e,t,s,n);else{if("QUOTE_DOUBLE"!==e.type){const s=i.replace(/\s+$/,""),r=t.has(s);/<<[-]?\s*['"]?(\w+)['"]?/.test(i)&&n&&r?(i=this.addEmptyLinesInHeredoc(i),e.value=i,e.type="BLOCK_FOLDED"):e.type=r&&n?"BLOCK_FOLDED":"BLOCK_LITERAL",e.value=this.normalizeTrailingNewlines(i,n)}this.applyBlockScalarStyles(e,t,s,n)}}else e.items&&"YAMLSeq"===e.constructor.name&&e.items.forEach(e=>this.applyBlockScalarStyles(e,t,s,n))}hasTrailingSpaces(e){const t=e.split("\n");return t.some((e,s)=>(s<t.length-1||""!==e)&&/[ \t]$/.test(e))}normalizeTrailingNewlines(e,t){return t?/\n[ \t]*\n\s*$/.test(e)?e.replace(/\n+$/,"")+"\n\n":e:/\n\n+$/.test(e)?e.replace(/\n+$/,"")+"\n":e}lastLineHasTemplateExpression(e){if(!e)return!1;const t=e.split("\n");for(let e=t.length-1;e>=0;e--){const s=t[e].trim();if(s)return s.endsWith("}}")}return!1}addEmptyLinesInHeredoc(e){const t=/<<[-]?\s*['"]?(\w+)['"]?/g;let s,n=e;const r=[];for(;null!==(s=t.exec(e));)r.push({delimiter:s[1],startIndex:s.index});for(let e=r.length-1;e>=0;e--){const{delimiter:t,startIndex:s}=r[e],i=n.indexOf("\n",s);if(-1===i)continue;const o=new RegExp(`^[ \\t]*${t}[ \\t]*$`,"m").exec(n.slice(i+1));if(!o)continue;const a=i+1,c=i+1+o.index,l=n.slice(a,c).split("\n");let u=!1;for(let e=1;e<l.length;e++)if(""===l[e].trim()&&e>0&&""!==l[e-1].trim()){u=!0;break}if(!u){const e=[];for(let t=0;t<l.length;t++){const s=l[t],n=""===s.trim();if(t>0&&!n){""===l[t-1].trim()||e.push("")}e.push(s)}const t=e.join("\n");n=n.slice(0,a)+t+n.slice(c)}}return n}preprocessCompileTimeExpressions(e){return"string"!=typeof e||0===e.length?e:e.replace(/\$\{\{([\s\S]*?)\}\}/g,e=>e.replace(/\$\{\{/g,"__AZURE_EXPR_OPEN__").replace(/\}\}/g,"__AZURE_EXPR_CLOSE__"))}restoreCompileTimeExpressions(e){if("string"==typeof e)return e.replace(/__AZURE_EXPR_OPEN__/g,"${{").replace(/__AZURE_EXPR_CLOSE__/g,"}}");if(Array.isArray(e))return e.map(e=>this.restoreCompileTimeExpressions(e));if(e&&"object"==typeof e){const t={};for(const[s,n]of Object.entries(e)){t[this.restoreCompileTimeExpressions(s)]=this.restoreCompileTimeExpressions(n)}return t}return e}buildExecutionContext(e,t){const s=this.extractParameters(e),n=this.extractVariables(e),r=this.normalizeResourcesConfig(e&&"object"==typeof e?e.resources:void 0),o=t.parameters||{},a=t.variables||{},c=this.normalizeResourcesConfig(t.resources),l=t.locals||{},u=t.baseDir||(t.fileName?i.dirname(t.fileName):process.cwd()),p=void 0!==t.repositoryBaseDir?t.repositoryBaseDir:u;return{parameters:{...s,...o},variables:{...n,...a},resources:this.mergeResourcesConfig(r,c),locals:{...l},baseDir:u,repositoryBaseDir:p,resourceLocations:t.resourceLocations||{},templateStack:t.templateStack||[],scriptsWithExpressions:new Set,scriptsWithLastLineExpressions:new Set}}normalizeResourcesConfig(e){if(!e||"object"!=typeof e)return{};const t={};void 0!==e.repositories&&(t.repositories=this.normalizeRepositoryList(e.repositories));for(const[s,n]of Object.entries(e))"repositories"!==s&&(t[s]=this.deepClone(n));return t}mergeResourcesConfig(e={},t={}){const s={};for(const[t,n]of Object.entries(e))"repositories"!==t&&(s[t]=this.deepClone(n));s.repositories=this.mergeRepositoryConfigs(e.repositories,t.repositories);for(const[e,n]of Object.entries(t))"repositories"!==e&&(s[e]=this.deepClone(n));return s}normalizeRepositoryList(e){if(!e)return[];const t=[];if(Array.isArray(e))e.forEach(e=>{e&&"object"==typeof e&&t.push(this.deepClone(e))});else if("object"==typeof e)for(const[s,n]of Object.entries(e)){if(!n||"object"!=typeof n)continue;const e=this.deepClone(n);!e.repository&&s&&(e.repository=s),t.push(e)}return this.attachRepositoryAliases(t)}mergeRepositoryConfigs(e,t){const s=this.normalizeRepositoryList(e),n=this.normalizeRepositoryList(t);if(!n.length)return s;const r=[],i=new Map,addEntry=(e,t)=>{if(!e||"object"!=typeof e)return;const s=this.deepClone(e),n=s.__match&&"object"==typeof s.__match?s.__match:void 0;n&&delete s.__match;const o=this.getRepositoryAlias(s),a=o&&!this.isNumericString(o)?o:`__index_${r.length}`;s.repository||!o||this.isNumericString(o)||(s.repository=o);const c=i.get(a);"override"===t&&c&&n&&!this.repositoryMatchesCriteria(c,n)||("override"===t&&s.location&&c&&!c.location&&(c.location=s.location),c?i.set(a,{...c,...s}):(i.set(a,s),r.push(a)))};s.forEach(e=>addEntry(e,"base")),n.forEach(e=>addEntry(e,"override"));const o=r.map(e=>this.deepClone(i.get(e)));return this.attachRepositoryAliases(o)}attachRepositoryAliases(e){if(!Array.isArray(e))return e;const t=new Set;return e.forEach(s=>{const n=this.getRepositoryAlias(s);!n||this.isNumericString(n)||t.has(n)||(Object.defineProperty(e,n,{value:s,writable:!0,enumerable:!0,configurable:!0}),t.add(n))}),e}getRepositoryAlias(e){if(e&&"object"==typeof e)return"string"==typeof e.repository&&e.repository.length?e.repository:"string"==typeof e.alias&&e.alias.length?e.alias:"string"==typeof e.name&&e.name.length?e.name:void 0}repositoryMatchesCriteria(e,t={}){if(!e||"object"!=typeof e)return!1;for(const[s,n]of Object.entries(t))if(null!=n&&""!==n){if(!Object.prototype.hasOwnProperty.call(e,s))return!1;if(e[s]!==n)return!1}return!0}deepClone(e){return null==e||"object"!=typeof e?e:JSON.parse(JSON.stringify(e))}isNumericString(e){return"string"==typeof e&&/^\d+$/.test(e)}extractParameters(e){const t={};if(!e||"object"!=typeof e)return t;const{parameters:s}=e;if(!s)return t;if(Array.isArray(s)){for(const e of s)if(e&&"object"==typeof e&&e.name){const s=this.pickFirstDefined(e.value,e.default,e.values);t[e.name]=void 0!==s?s:null}}else if("object"==typeof s)for(const[e,n]of Object.entries(s))if(n&&"object"==typeof n){const s=this.pickFirstDefined(n.value,n.default,n.values);t[e]=void 0!==s?s:null}else t[e]=n;return t}validateTemplateParameters(e,t,s,n){if(!e||"object"!=typeof e)return;const{parameters:r}=e;if(!r)return;const i=[],o=[],a=[],c=[],checkParameter=(e,s)=>{if(!e||"object"!=typeof e)return;const n=s||e.name;if(!n)return;const r=void 0!==e.default||void 0!==e.value||void 0!==e.values,c=t&&Object.prototype.hasOwnProperty.call(t,n),l=c?t[n]:void 0;if(r||c||i.push(n),c&&void 0!==e.type){const t=e.type.toLowerCase(),s=l;if(!("string"==typeof s&&/\$\([^)]+\)/.test(s))&&!(void 0===s)){let r=!0,i=e.type;switch(t){case"string":r="string"==typeof s||"number"==typeof s||"boolean"==typeof s;break;case"number":r="number"==typeof s||"string"==typeof s&&(!isNaN(s)&&!isNaN(parseFloat(s)));break;case"boolean":if("boolean"==typeof s)r=!0;else if("string"==typeof s){const e=s.toLowerCase();r="true"===e||"false"===e||"__true__"===e||"__false__"===e}else r=!1;break;case"object":r="dependsOn"===n&&"string"==typeof s||"object"==typeof s&&null!==s;break;case"step":case"steplist":r=Array.isArray(s),i="array (stepList)";break;case"job":case"joblist":r=Array.isArray(s),i="array (jobList)";break;case"deployment":case"deploymentlist":r=Array.isArray(s),i="array (deploymentList)";break;case"stage":case"stagelist":r=Array.isArray(s),i="array (stageList)";break;default:r=!0}r||a.push({name:n,expected:i,actual:typeof s,value:s})}}if(c&&e.values&&Array.isArray(e.values)){const t=l;"string"==typeof t&&/\$\([^)]+\)/.test(t)||e.values.includes(t)||o.push({name:n,value:t,allowed:e.values})}};if(Array.isArray(r))for(const e of r)checkParameter(e);else if("object"==typeof r)for(const[e,t]of Object.entries(r))checkParameter(t,e);if(t&&"object"==typeof t){const e=new Set;if(Array.isArray(r))for(const t of r)t&&t.name&&e.add(t.name);else if("object"==typeof r)for(const t of Object.keys(r))e.add(t);for(const s of Object.keys(t))""!==s&&(e.has(s)||c.push(s))}const l=[];if(i.length>0){const e=s||"template",t=i.map(e=>`'${e}'`).join(", ");l.push(`Missing required parameter(s) for template '${e}': ${t}. These parameters do not have default values and must be provided when calling the template.`)}if(a.length>0){const e=s||"template",t=a.map(e=>`Parameter '${e.name}' expects type '${e.expected}' but received '${e.actual}' (value: ${JSON.stringify(e.value)})`).join("\n    ");l.push(`Invalid parameter type(s) for template '${e}':\n    ${t}`)}if(o.length>0){const e=s||"template",t=o.map(e=>`Parameter '${e.name}' has value '${e.value}' which is not in allowed values: [${e.allowed.join(", ")}]`).join("\n    ");l.push(`Invalid parameter value(s) for template '${e}':\n    ${t}`)}if(c.length>0){const e=s||"template",t=c.map(e=>`'${e}'`).join(", ");l.push(`Unknown parameter(s) for template '${e}': ${t}. These parameters are not defined in the template.`)}if(l.length>0){let e=l.join("\n\n");if(n&&n.templateStack&&n.templateStack.length>0){e+="\n  Template call stack:",e+="\n    "+n.templateStack[0];for(let t=1;t<n.templateStack.length;t++)e+="\n    "+"  ".repeat(t)+" "+n.templateStack[t]}throw new Error(e)}}extractVariables(e){const t={};if(!e||"object"!=typeof e)return t;const{variables:s}=e;if(!s)return t;if(Array.isArray(s))for(const e of s)e&&"object"==typeof e&&e.name&&(t[e.name]=this.pickFirstDefined(e.value,e.default));else if("object"==typeof s)for(const[e,n]of Object.entries(s))t[e]=n&&"object"==typeof n&&"value"in n?n.value:n;return t}expandNode(e,t,s=null){return Array.isArray(e)?this.expandArray(e,t,s):e&&"object"==typeof e?this.expandObject(e,t,s):this.expandScalar(e,t)}expandArray(e,t,s=null){const n=[],r="variables"===s;for(let s=0;s<e.length;s+=1){const i=e[s];if(this.isTemplateReference(i)){const e=this.expandTemplateReference(i,t);if(n.push(...e),r&&Array.isArray(e))for(const s of e)if(s&&"object"==typeof s&&!Array.isArray(s)){const e=s.name,n=this.pickFirstDefined(s.value,s.default);e&&void 0!==n&&(t.variables[e]=n)}continue}if(this.isSingleKeyObject(i)){const r=Object.keys(i)[0];if(this.isEachDirective(r)){const e=this.applyEachDirective(r,i[r],t);n.push(...e.items);continue}if(this.isConditionalDirective(r)){const r=this.expandConditionalBlock(e,s,t);n.push(...r.items),s=r.nextIndex;continue}}const o=this.expandNode(i,t);if(void 0!==o){if(Array.isArray(o))for(const e of o)if(this.isTemplateReference(e)){const s=this.expandTemplateReference(e,t);n.push(...s)}else n.push(e);else n.push(o);if(r&&o&&"object"==typeof o&&!Array.isArray(o)){const e=o.name,s=this.pickFirstDefined(o.value,o.default);e&&void 0!==s&&(t.variables[e]=s)}}}return n}expandObject(e,t,s=null){const n=Object.entries(e),r={};for(let e=0;e<n.length;e+=1){const[s,i]=n[e];if("string"==typeof s&&this.isEachDirective(s)){const s=this.expandEachEntries(n,e,t);Object.assign(r,s.merged),e=s.nextIndex;continue}if("string"==typeof s&&this.isConditionalDirective(s)){const s=this.expandConditionalEntries(n,e,t);Object.assign(r,s.merged),e=s.nextIndex;continue}if("string"==typeof s&&this.isFullExpression(s.trim())){if("insert"===this.stripExpressionDelimiters(s.trim()).trim()){const e=this.expandNodePreservingTemplates(i,t);if(e&&"object"==typeof e&&!Array.isArray(e)){Object.assign(r,e);continue}}}const o="string"==typeof s?this.replaceExpressionsInString(s,t):s,a="string"==typeof i&&i.includes("${{")&&i.includes("\n"),c=a&&this.lastLineHasTemplateExpression(i),l="string"==typeof i&&!i.includes("\n")&&/^\s*\$\{\{.*\}\}\s*$/.test(i.trim()),u=this.expandNode(i,t,o);if(void 0!==u){if(a&&"string"==typeof u){t.scriptsWithExpressions||(t.scriptsWithExpressions=new Set);const e=u.replace(/\s+$/,"");t.scriptsWithExpressions.add(e),c&&(t.scriptsWithLastLineExpressions||(t.scriptsWithLastLineExpressions=new Set),t.scriptsWithLastLineExpressions.add(e))}if(l&&"string"==typeof u&&u.includes("\n")){t.scriptsWithExpressions||(t.scriptsWithExpressions=new Set);const e=u.replace(/\s+$/,"");t.scriptsWithExpressions.add(e),t.scriptsWithLastLineExpressions||(t.scriptsWithLastLineExpressions=new Set),t.scriptsWithLastLineExpressions.add(e)}r[o]=u}}if((r.bash||r.script||r.pwsh||r.powershell||r.checkout)&&!r.task&&!r.inputs&&!r.targetType&&"inputs"!==s){const e=r.bash?"bash":r.script?"script":r.pwsh?"pwsh":r.powershell?"powershell":"checkout",t="script"===e?"CmdLine@2":"pwsh"===e||"powershell"===e?"PowerShell@2":"checkout"===e?"6d15af64-176c-496d-b583-fd2ae21d4df4@1":"Bash@3",s=r[e];delete r[e];const n={};for(const[e,t]of Object.entries(r))"task"!==e&&"inputs"!==e&&(n[e]=t);const i={task:t};if("checkout"===e){const{condition:e,displayName:t,...r}=n;return t&&(i.displayName=t),void 0!==e?i.condition=e:"none"===s&&(i.condition=!1),i.inputs={repository:s,...r},i}{const{workingDirectory:t,...r}=n;Object.assign(i,r);const o={};return"bash"!==e&&"pwsh"!==e&&"powershell"!==e||(o.targetType="inline"),o.script=s,"pwsh"===e&&(o.pwsh=!0),void 0!==t&&(o.workingDirectory=t),i.inputs=o,i}}return r.pool&&"string"==typeof r.pool&&(r.pool={name:r.pool}),r.dependsOn&&"string"==typeof r.dependsOn&&(r.dependsOn=[r.dependsOn]),"6d15af64-176c-496d-b583-fd2ae21d4df4@1"!==r.task||"none"!==r.inputs?.repository||r.condition||(r.condition=!1),r}expandScalar(e,t){if("string"!=typeof e)return e;const s=e.trim();if(this.isFullExpression(s)){const e=this.stripExpressionDelimiters(s),n=this.evaluateExpression(e,t);if(this.isTemplateReference(n)){const e=this.expandTemplateReference(n,t);return 1===e.length?e[0]:e}return"boolean"==typeof n?this.returnBoolean(n):n}return this.replaceExpressionsInString(e,t)}expandConditionalBlock(e,t,s){let n=t,r=!1,i=[];for(;n<e.length;){const o=e[n];if(!this.isSingleKeyObject(o))break;const[a]=Object.keys(o),c=o[a];if(!this.isConditionalDirective(a))break;if(this.isIfDirective(a)&&n!==t)break;if(!r&&this.evaluateConditional(a,s)&&(i=this.flattenBranchValue(c,s),r=!0),n+=1,this.isElseDirective(a))break}return{items:i,nextIndex:n-1}}expandConditionalEntries(e,t,s){let n=t,r=!1,i={};for(;n<e.length;){const[t,o]=e[n];if("string"!=typeof t||!this.isConditionalDirective(t))break;if(!r&&this.evaluateConditional(t,s)&&(i=this.expandConditionalMappingBranch(o,s),r=!0),n+=1,this.isElseDirective(t))break}return{merged:i,nextIndex:Math.max(t,n-1)}}expandConditionalMappingBranch(e,t){if(Array.isArray(e)){return this.expandArray(e,t).reduce((e,t)=>t&&"object"==typeof t&&!Array.isArray(t)?{...e,...t}:e,{})}if(e&&"object"==typeof e)return this.expandObject(e,t);const s=this.expandScalar(e,t);return void 0===s?{}:{value:s}}expandEachEntries(e,t,s){let n=t;const r={};for(;n<e.length;){const[t,i]=e[n];if("string"!=typeof t||!this.isEachDirective(t))break;const o=this.parseEachDirective(t);if(!o){n+=1;continue}const a=this.evaluateExpression(o.collection,s);this.normalizeCollection(a).forEach((e,t)=>{const n={[o.variable]:e,[`${o.variable}Index`]:t},a=this.createChildContext(s,n),c=this.expandConditionalMappingBranch(i,a);if(Object.prototype.hasOwnProperty.call(c,"--")){const s=this.resolveEachIterationKey(e,t,a,o.variable),n=c["--"];delete c["--"],null!=s&&(r[s]=n)}Object.assign(r,c)}),n+=1}return{merged:r,nextIndex:Math.max(t,n-1)}}resolveEachIterationKey(e,t,s,n){if(null==e)return String(t);const unwrap=e=>{if(null!=e)return"string"==typeof e||"number"==typeof e||"boolean"==typeof e?String(e):void 0},r=unwrap(e);if(void 0!==r)return r;if(e&&"object"==typeof e){const t=["key","name","matrixKey","label","id"];for(const s of t)if(Object.prototype.hasOwnProperty.call(e,s)){const t=unwrap(e[s]);if(void 0!==t)return t}if(Object.prototype.hasOwnProperty.call(e,"value")){const t=unwrap(e.value);if(void 0!==t)return t}}if("string"==typeof n&&n.length){const e=unwrap(this.evaluateExpression(n,s));if(void 0!==e)return e}return String(t)}flattenBranchValue(e,t){if(Array.isArray(e))return this.expandArray(e,t);if(e&&"object"==typeof e)return[this.expandObject(e,t)];const s=this.expandScalar(e,t);return void 0===s?[]:[s]}applyEachDirective(e,t,s){const n=this.parseEachDirective(e);if(!n)return{items:[]};const r=this.evaluateExpression(n.collection,s),i=this.normalizeCollection(r),o=[];return i.forEach((e,r)=>{const i={[n.variable]:e,[`${n.variable}Index`]:r},a=this.createChildContext(s,i),c=this.flattenBranchValue(t,a);o.push(...c)}),{items:o}}replaceExpressionsInString(e,t){if("string"!=typeof e)return e;let s=e.replace(/\$\{\{\s*(.+?)\s*\}\}/g,(e,s)=>{const n=this.evaluateExpression(s,t);if(null==n){if(s.trim().startsWith("parameters.")){return`$(${s.trim().substring(11)})`}return""}if("object"==typeof n)return JSON.stringify(n);if("string"==typeof n){const e=n.toLowerCase();if("__true__"===e)return"True";if("__false__"===e)return"False"}return"boolean"==typeof n?this.returnBoolean(n):String(n)});return s=s.replace(/^[ \t]+$/gm,""),s}evaluateExpression(e,t){if(null==e)return;const s=String(e).trim();if(0===s.length)return;const n=this.parseExpressionAst(s);if(n)return this.evaluateAst(n,t);const r=this.resolveContextValue(s,t);return void 0!==r?r:this.looksLikeContextPath(s)?void 0:s}evaluateFunction(e,t){switch(e.toLowerCase()){case"eq":return this.returnBoolean(0===this.compareValues(t[0],t[1]));case"ne":return this.returnBoolean(0!==this.compareValues(t[0],t[1]));case"gt":return this.returnBoolean(this.compareValues(t[0],t[1])>0);case"ge":return this.returnBoolean(this.compareValues(t[0],t[1])>=0);case"lt":return this.returnBoolean(this.compareValues(t[0],t[1])<0);case"le":return this.returnBoolean(this.compareValues(t[0],t[1])<=0);case"and":return this.returnBoolean(t.every(e=>this.toBoolean(e)));case"or":return this.returnBoolean(t.some(e=>this.toBoolean(e)));case"not":return this.returnBoolean(!this.toBoolean(t[0]));case"xor":return this.returnBoolean(this.toBoolean(t[0])!==this.toBoolean(t[1]));case"coalesce":return t.find(e=>null!=e&&""!==e);case"contains":return this.returnBoolean(this.contains(t[0],t[1]));case"containsvalue":return this.returnBoolean(this.containsValue(t[0],t[1]));case"in":return this.returnBoolean(t.slice(1).some(e=>0===this.compareValues(t[0],e)));case"notin":return this.returnBoolean(!t.slice(1).some(e=>0===this.compareValues(t[0],e)));case"lower":return"string"==typeof t[0]?t[0].toLowerCase():t[0];case"upper":return"string"==typeof t[0]?t[0].toUpperCase():t[0];case"startswith":return this.returnBoolean(this.startsWith(t[0],t[1]));case"endswith":return this.returnBoolean(this.endsWith(t[0],t[1]));case"trim":return"string"==typeof t[0]?t[0].trim():t[0];case"replace":return this.replaceString(t[0],t[1],t[2]);case"split":return this.splitString(t[0],t[1]);case"join":return this.joinArray(t[0],t[1]);case"format":return this.formatString(t);case"length":return"string"==typeof t[0]||Array.isArray(t[0])?t[0].length:t[0]&&"object"==typeof t[0]?Object.keys(t[0]).length:0;case"converttojson":return this.convertToJson(t[0]);case"counter":return this.counter(t[0],t[1]);case"iif":return this.toBoolean(t[0])?t[1]:t[2];case"always":return this.returnBoolean(!0);case"canceled":return this.returnBoolean(this.isCanceled(t));case"failed":return this.returnBoolean(this.isFailed(t));case"succeeded":return this.returnBoolean(this.isSucceeded(t));case"succeededorfailed":return this.returnBoolean(this.isSucceededOrFailed(t));default:return}}startsWith(e,t){return"string"==typeof e&&"string"==typeof t&&e.toLowerCase().startsWith(t.toLowerCase())}endsWith(e,t){return"string"==typeof e&&"string"==typeof t&&e.toLowerCase().endsWith(t.toLowerCase())}replaceString(e,t,s){return"string"!=typeof e?e:("string"!=typeof t&&(t=String(t)),"string"!=typeof s&&(s=String(s)),e.split(t).join(s))}splitString(e,t){return"string"!=typeof e?[e]:("string"!=typeof t&&(t=String(t)),e.split(t))}joinArray(e,t){return Array.isArray(t)?("string"!=typeof e&&(e=String(e)),t.map(e=>null==e||"object"==typeof e?"":String(e)).join(e)):"string"==typeof t?t:String(t)}formatString(e){if(0===e.length)return"";let t=String(e[0]);const s=e.slice(1);return t=t.replace(/\{(\d+)(?::([^}]+))?\}/g,(e,t,n)=>{const r=parseInt(t,10);if(r>=s.length)return e;let i=s[r];return n&&i instanceof Date?this.formatDateTime(i,n):null==i?"":String(i)}),t=t.replace(/\{\{/g,"{").replace(/\}\}/g,"}"),t}formatDateTime(e,t){const pad=(e,t=2)=>String(e).padStart(t,"0");return t.replace(/yyyy/g,e.getFullYear()).replace(/yy/g,String(e.getFullYear()).slice(-2)).replace(/MM/g,pad(e.getMonth()+1)).replace(/M/g,e.getMonth()+1).replace(/dd/g,pad(e.getDate())).replace(/d/g,e.getDate()).replace(/HH/g,pad(e.getHours())).replace(/H/g,e.getHours()).replace(/mm/g,pad(e.getMinutes())).replace(/m/g,e.getMinutes()).replace(/ss/g,pad(e.getSeconds())).replace(/s/g,e.getSeconds()).replace(/ffff/g,pad(e.getMilliseconds(),4)).replace(/ff/g,pad(Math.floor(e.getMilliseconds()/10))).replace(/f/g,Math.floor(e.getMilliseconds()/100))}convertToJson(e){if(void 0===e)return"null";try{return JSON.stringify(e,(e,t)=>"boolean"==typeof t?t?"True":"False":"string"==typeof t&&/^-?\d+(\.\d+)?$/.test(t)?parseFloat(t):t,2)}catch(t){return String(e)}}counter(e,t){this._counters||(this._counters=new Map);const s=String(e||""),n="number"==typeof t?t:parseInt(t,10)||0;this._counters.has(s)||this._counters.set(s,n);const r=this._counters.get(s);return this._counters.set(s,r+1),r}containsValue(e,t){return Array.isArray(e)?e.some(e=>0===this.compareValues(e,t)):!(!e||"object"!=typeof e)&&Object.values(e).some(e=>0===this.compareValues(e,t))}isCanceled(e){return!1}isFailed(e){return!1}isSucceeded(e){return!0}isSucceededOrFailed(e){return!0}parseExpressionAst(e){if(this.expressionCache.has(e))return this.expressionCache.get(e);try{const t=this.preprocessExpressionString(e),s=a(t);return this.expressionCache.set(e,s),s}catch(t){return this.expressionCache.set(e,null),null}}preprocessExpressionString(e){return"string"!=typeof e?e:e.replace(/(['"])((?:\\.|(?!\1).)*?)\1/g,(e,t,s)=>t+s.replace(/\\(?![\\'"nrtbfv0xu])/g,"\\\\")+t)}evaluateAst(e,t){if(e)switch(e.type){case"Literal":return e.value;case"Identifier":return this.resolveIdentifier(e.name,t);case"ThisExpression":return t;case"ArrayExpression":return e.elements.map(e=>this.evaluateAst(e,t));case"ObjectExpression":{const s={};return e.properties.forEach(e=>{const n=e.key,r=e.computed?this.evaluateAst(n,t):"Identifier"===n.type?n.name:this.evaluateAst(n,t);void 0!==r&&(s[r]=this.evaluateAst(e.value,t))}),s}case"UnaryExpression":return this.evaluateUnary(e.operator,this.evaluateAst(e.argument,t));case"BinaryExpression":return this.evaluateBinary(e.operator,this.evaluateAst(e.left,t),this.evaluateAst(e.right,t));case"LogicalExpression":{const s=this.evaluateAst(e.left,t);return"&&"===e.operator?this.toBoolean(s)?this.evaluateAst(e.right,t):s:"||"===e.operator?this.toBoolean(s)?s:this.evaluateAst(e.right,t):"??"===e.operator?null!=s?s:this.evaluateAst(e.right,t):void 0}case"ConditionalExpression":return this.toBoolean(this.evaluateAst(e.test,t))?this.evaluateAst(e.consequent,t):this.evaluateAst(e.alternate,t);case"MemberExpression":{const s=this.evaluateAst(e.object,t);if(null==s)return;const n=e.computed?this.evaluateAst(e.property,t):"Identifier"===e.property.type?e.property.name:this.evaluateAst(e.property,t);if(null==n)return;return s[n]}case"CallExpression":{const s=this.resolveCallable(e.callee,t),n=e.arguments.map(e=>this.evaluateAst(e,t));if(s&&s.builtinName){const e=this.evaluateFunction(s.builtinName,n);if(void 0!==e)return e}return s&&"function"==typeof s.fn?s.fn.apply(void 0!==s.thisArg?s.thisArg:t,n):void 0}default:return}}resolveIdentifier(e,t){if(!e)return;const s=e.toLowerCase();if("true"===s)return!0;if("false"===s)return!1;if("null"===s)return null;if("undefined"!==s){if(t.locals&&Object.prototype.hasOwnProperty.call(t.locals,e))return t.locals[e];if(Object.prototype.hasOwnProperty.call(t.parameters,e))return t.parameters[e];if(Object.prototype.hasOwnProperty.call(t.variables,e))return t.variables[e];switch(e){case"parameters":return t.parameters;case"variables":return t.variables;case"resources":return t.resources;case"locals":return t.locals;default:return}}}resolveCallable(e,t){if(!e)return{};if("Identifier"===e.type){const s=e.name,n=this.resolveIdentifier(s,t);return"function"==typeof n?{fn:n}:{builtinName:s}}if("MemberExpression"===e.type){const s=this.evaluateAst(e.object,t);if(null==s)return{};const n=e.computed?this.evaluateAst(e.property,t):"Identifier"===e.property.type?e.property.name:this.evaluateAst(e.property,t);if(null==n)return{};const r=s[n];return"function"==typeof r?{fn:r,thisArg:s}:{builtinName:n}}const s=this.evaluateAst(e,t);return"function"==typeof s?{fn:s}:{}}evaluateUnary(e,t){switch(e){case"!":return!this.toBoolean(t);case"+":return Number(t);case"-":return-Number(t);default:return}}evaluateBinary(e,t,s){switch(e){case"==":case"===":return 0===this.compareValues(t,s);case"!=":case"!==":return 0!==this.compareValues(t,s);case"<":return this.compareValues(t,s)<0;case"<=":return this.compareValues(t,s)<=0;case">":return this.compareValues(t,s)>0;case">=":return this.compareValues(t,s)>=0;case"+":return"string"==typeof t||"string"==typeof s?`${t??""}${s??""}`:(Number(t)||0)+(Number(s)||0);case"-":return(Number(t)||0)-(Number(s)||0);case"*":return(Number(t)||0)*(Number(s)||0);case"/":return(Number(t)||0)/(Number(s)||0);case"%":return(Number(t)||0)%(Number(s)||0);default:return}}contains(e,t){return"string"==typeof e?"string"==typeof t&&e.includes(t):Array.isArray(e)?e.some(e=>0===this.compareValues(e,t)):!(!e||"object"!=typeof e)&&Object.prototype.hasOwnProperty.call(e,t)}compareValues(e,t){const normalize=e=>{if(null==e)return"";if("string"==typeof e){const t=e.trim();if(0===t.length)return"";const s=t.toLowerCase();return"true"===s||"__true__"===s||"false"!==s&&"__false__"!==s&&(/^-?\d+(?:\.\d+)?$/.test(t)?Number(t):t)}return e},s=normalize(e),n=normalize(t);if(s===n)return 0;if(typeof s==typeof n&&("number"==typeof s||"boolean"==typeof s))return s>n?1:-1;const r=String(s),i=String(n);return r===i?0:r>i?1:-1}resolveContextValue(e,t){const s=this.sanitizePath(e).split(".").filter(e=>e.length>0);if(0===s.length)return;const[n,...r]=s;return t.locals&&Object.prototype.hasOwnProperty.call(t.locals,n)?this.walkSegments(t.locals[n],r):"parameters"===n?this.walkSegments(t.parameters,r):"variables"===n?this.walkSegments(t.variables,r):"resources"===n?this.walkSegments(t.resources,r):Object.prototype.hasOwnProperty.call(t.parameters,n)?this.walkSegments(t.parameters[n],r):Object.prototype.hasOwnProperty.call(t.variables,n)?this.walkSegments(t.variables[n],r):t.locals&&Object.prototype.hasOwnProperty.call(t.locals,n)?this.walkSegments(t.locals[n],r):void 0}walkSegments(e,t){let s=e;for(let e=0;e<t.length;e++){const n=t[e];if(null==s)return;if(e>0&&"object"==typeof s&&!Array.isArray(s)&&!(n in s))return"";s=s[n]}return s}sanitizePath(e){return e.replace(/\[(\d+)\]/g,".$1").replace(/\[(?:'|")([^'"]+)(?:'|")\]/g,".$1")}looksLikeContextPath(e){return"string"==typeof e&&/^[a-zA-Z_][\w]*[.\[]/.test(e.trim())}toBoolean(e){if("boolean"==typeof e)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.toLowerCase();if("__true__"===t||"true"===t)return!0;if("__false__"===t||"false"===t||0===t.length)return!1}return Boolean(e)}returnBoolean(e){return e?"__TRUE__":"__FALSE__"}createChildContext(e,t){return{parameters:e.parameters,variables:e.variables,resources:e.resources,locals:{...e.locals,...t},baseDir:e.baseDir,repositoryBaseDir:e.repositoryBaseDir,resourceLocations:e.resourceLocations||{},scriptsWithExpressions:e.scriptsWithExpressions,scriptsWithLastLineExpressions:e.scriptsWithLastLineExpressions}}createTemplateContext(e,t,s,n={}){return{parameters:{...e.parameters,...t},variables:{...e.variables},resources:e.resources,locals:{...e.locals},baseDir:s||e.baseDir,repositoryBaseDir:void 0!==n.repositoryBaseDir?n.repositoryBaseDir:e.repositoryBaseDir,resourceLocations:e.resourceLocations||{},templateStack:e.templateStack||[],quoteStyles:e.quoteStyles,templateQuoteStyles:e.templateQuoteStyles,scriptsWithExpressions:e.scriptsWithExpressions,scriptsWithLastLineExpressions:e.scriptsWithLastLineExpressions}}normalizeCollection(e){return Array.isArray(e)?e:e&&"object"==typeof e?Object.entries(e).map(([e,t])=>({key:e,value:t})):[]}isSingleKeyObject(e){return e&&"object"==typeof e&&!Array.isArray(e)&&1===Object.keys(e).length}isTemplateReference(e){return e&&"object"==typeof e&&!Array.isArray(e)&&"template"in e}expandTemplateReference(e,t){const s=e.template,r="string"==typeof s?this.replaceExpressionsInString(s,t):this.expandScalar(s,t);if(!r||"string"!=typeof r)return[];const a=this.parseRepositoryTemplateReference(r);let c,l,u=t.repositoryBaseDir||void 0;if(a){const e=this.resolveRepositoryEntry(a.repository,t);if(!e)throw new Error(`Repository resource '${a.repository}' is not defined for template '${r}'.`);const s=this.resolveRepositoryLocation(e,t);if(!s)throw new Error(`Repository resource '${a.repository}' does not define a local location. Set a 'location' for this resource (for example via the 'azurePipelineStudio.resourceLocations' setting).`);const n=this.resolveRepositoryBaseDirectory(s,t);u=n;const o=t.baseDir||n;if(c=this.resolveTemplateWithinRepository(a.templatePath,o,n),!c)throw new Error(`Template file not found for repository '${a.repository}': ${a.templatePath}`);l=i.dirname(c)}else{const e=t.repositoryBaseDir||void 0,s=this.resolveTemplateWithinRepository(r,t.baseDir,e);if(s)c=s,l=i.dirname(c),u=u||e;else{const e=t.baseDir||process.cwd();c=i.isAbsolute(r)?r:i.resolve(e,r),l=i.dirname(c)}}if(!n.existsSync(c)){const e=a?`${a.templatePath}@${a.repository}`:r;throw new Error(`Template file not found: ${e}`)}const p=n.readFileSync(c,"utf8"),f=this.preprocessCompileTimeExpressions(p);let h;try{const e=o.parseDocument(f),s=new Map;this.extractQuoteStyles(e.contents,[],s),t.quoteStyles&&s.size>0&&(t.templateQuoteStyles||(t.templateQuoteStyles=new Map),t.templateQuoteStyles.set(c,s)),h=e.toJSON()||{}}catch(e){throw new Error(`Failed to parse template '${r}': ${e.message}`)}h=this.restoreCompileTimeExpressions(h);const d=this.extractParameters(h),m=this.normalizeTemplateParameters(e.parameters,t),g=a?`${a.templatePath}@${a.repository}`:r,y={...t,templateStack:[...t.templateStack||[],g]};this.validateTemplateParameters(h,m,r,y);const b={...d,...m},v=this.createTemplateContext(y,b,l,{repositoryBaseDir:u}),w=this.expandNode(h,v)||{};return this.extractTemplateBody(w)}parseRepositoryTemplateReference(e){if("string"!=typeof e)return;const t=e.lastIndexOf("@");if(t<=0||t===e.length-1)return;const s=e.slice(0,t).trim(),n=e.slice(t+1).trim();return s&&n?{templatePath:s,repository:n}:void 0}resolveRepositoryEntry(e,t){if(!e||!t)return;let s;if(t.resources){const n=t.resources.repositories;n&&(n[e]?s=n[e]:Array.isArray(n)&&(s=n.find(t=>this.getRepositoryAlias(t)===e)))}if(s&&t.resourceLocations&&t.resourceLocations[e]){s.location||s.path||s.directory||s.localPath||(s={...s,location:t.resourceLocations[e]})}return!s&&t.resourceLocations&&t.resourceLocations[e]&&(s={repository:e,location:t.resourceLocations[e]}),s}resolveRepositoryLocation(e,t){if(!e||"object"!=typeof e)return;const s=[e.location,e.path,e.directory,e.localPath].find(e=>"string"==typeof e&&e.trim().length);if(!s)return;const n=this.replaceExpressionsInString(s,t);if(!n||"string"!=typeof n)return;const r=n.trim();if(!r)return;const i=this.expandUserHome(r);return i&&"object"==typeof e&&(e.__resolvedLocation=i,e.location&&e.location!==s&&e.location!==r?e.localLocation||(e.localLocation=i):e.location=i),i}expandUserHome(e){return"string"!=typeof e?e:e.startsWith("~")?i.join(r.homedir(),e.slice(1)):e}resolveRepositoryBaseDirectory(e,t){const s=t.baseDir||process.cwd();if(!e)return s;const r=i.isAbsolute(e)?e:i.resolve(s,e);try{const e=n.statSync(r);if(e.isFile())return i.dirname(r);if(e.isDirectory())return r}catch(e){}return r}resolveTemplateWithinRepository(e,t,s){if(!e)return;const r=String(e).replace(/^[\\/]+/,"").split(/[\\/]+/).filter(e=>e&&e.length),o=[];if(s&&o.push(s),!t||s&&i.normalize(s)===i.normalize(t)||o.push(t),!o.length)return;const a=o.map(e=>r.length?i.resolve(e,...r):i.normalize(e));for(const e of a)try{if(n.statSync(e).isFile())return i.normalize(e)}catch(e){}return a[0]}expandNodePreservingTemplates(e,t){if(null==e)return e;const pushExpanded=(e,t)=>{null!=t&&(Array.isArray(t)?e.push(...t):e.push(t))};if(Array.isArray(e)){const s=[];let n=0;for(;n<e.length;){const r=e[n];if(this.isTemplateReference(r)){s.push(r),n++;continue}if("object"==typeof r&&null!==r&&!Array.isArray(r)){const i=Object.entries(r);if(i.length>0&&this.isConditionalDirective(i[0][0])){let r=!1,i=n;for(;i<e.length;){const n=e[i];if("object"!=typeof n||null===n||Array.isArray(n))break;const o=Object.entries(n);if(1!==o.length)break;const[a,c]=o[0];if(!this.isConditionalDirective(a))break;if(!r&&(this.isElseDirective(a)||this.toBoolean(this.evaluateExpression(this.isIfDirective(a)?this.parseIfCondition(a):this.parseElseIfCondition(a),t)))&&(pushExpanded(s,this.expandNodePreservingTemplates(c,t)),r=!0),i++,this.isElseDirective(a))break}n=i;continue}if(1===i.length){const[e,r]=i[0];if("string"==typeof e&&this.isFullExpression(e.trim())){if("insert"===this.stripExpressionDelimiters(e.trim()).trim()){pushExpanded(s,this.expandNodePreservingTemplates(r,t)),n++;continue}}}}const i=this.expandNodePreservingTemplates(r,t);if(null!=i){if("object"==typeof i&&!Array.isArray(i)&&0===Object.keys(i).length){n++;continue}s.push(i)}n++}return s}if("object"==typeof e){if(this.isTemplateReference(e)){const s={template:e.template};return e.parameters&&(s.parameters=this.expandNodePreservingTemplates(e.parameters,t)),s}const s={},n=Object.entries(e);let r=0;for(;r<n.length;){const[e,i]=n[r];if("string"==typeof e&&this.isConditionalDirective(e)){let e=!1,i=r;for(;i<n.length;){const[r,o]=n[i];if("string"!=typeof r||!this.isConditionalDirective(r))break;if(!e&&this.evaluateConditional(r,t)){const n=this.expandNodePreservingTemplates(o,t);n&&"object"==typeof n&&!Array.isArray(n)&&Object.assign(s,n),e=!0}if(i++,this.isElseDirective(r))break}r=i;continue}if("string"==typeof e&&this.isFullExpression(e.trim())){if("insert"===this.stripExpressionDelimiters(e.trim()).trim()){const e=this.expandNodePreservingTemplates(i,t);e&&"object"==typeof e&&!Array.isArray(e)&&Object.assign(s,e),r++;continue}}s["string"==typeof e?this.replaceExpressionsInString(e,t):e]=this.expandNodePreservingTemplates(i,t),r++}return s}return this.expandScalar(e,t)}normalizeTemplateParameters(e,t){if(void 0===e)return{};const s=this.expandNodePreservingTemplates(e,t);if(s&&"object"==typeof s&&!Array.isArray(s))return s;if(Array.isArray(s)){const e={};return s.forEach(t=>{if(t&&"object"==typeof t&&!Array.isArray(t)){if(Object.prototype.hasOwnProperty.call(t,"name")){const s=t.name;if("string"==typeof s&&s.trim().length){const n=this.pickFirstDefined(t.value,t.default,t.values);e[s.trim()]=n}return}Object.entries(t).forEach(([t,s])=>{"string"==typeof t&&t.trim().length&&(e[t.trim()]=s)})}}),e}return{}}extractTemplateBody(e){if(!e)return[];if(Array.isArray(e))return e;if("object"!=typeof e)return[];const t={};for(const[s,n]of Object.entries(e))"parameters"!==s&&(t[s]=n);const s=["stages","jobs","steps","variables","stage","job","deployment","deployments"];for(const e of s)if(e in t){const s=t[e];if(Array.isArray(s))return s;if(void 0!==s)return[s]}return Object.keys(t).length>0?[t]:[]}evaluateConditional(e,t){if(this.isElseDirective(e))return!0;const s=this.isIfDirective(e)?this.parseIfCondition(e):this.parseElseIfCondition(e);return this.toBoolean(this.evaluateExpression(s,t))}isFullExpression(e){if(!e||!e.startsWith("${{")||!e.endsWith("}}"))return!1;return!e.slice(3,-2).includes("}}")}stripExpressionDelimiters(e){return e.replace(/^\$\{\{/,"").replace(/\}\}$/,"").trim()}isEachDirective(e){return/^\$\{\{\s*each\s+/.test(e)}isConditionalDirective(e){return this.isIfDirective(e)||this.isElseIfDirective(e)||this.isElseDirective(e)}isIfDirective(e){return/^\$\{\{\s*if\s+/.test(e)}isElseIfDirective(e){return/^\$\{\{\s*elseif\s+/.test(e)}isElseDirective(e){return/^\$\{\{\s*else\s*\}\}$/.test(e)}parseIfCondition(e){const t=e.match(/^\$\{\{\s*if\s+(.+?)\s*\}\}$/);return t?t[1]:""}parseElseIfCondition(e){const t=e.match(/^\$\{\{\s*elseif\s+(.+?)\s*\}\}$/);return t?t[1]:""}parseEachDirective(e){const t=e.match(/^\$\{\{\s*each\s+([a-zA-Z_]\w*)\s+in\s+(.+?)\s*\}\}$/);if(t)return{variable:t[1],collection:t[2]}}pickFirstDefined(...e){for(const t of e)if(void 0!==t)return t}}if(e.exports={AzurePipelineParser},s.c[s.s]===e){const e=process.argv.slice(2);0===e.length&&(console.error("Usage: node parser.js <yaml-file-path>"),process.exit(1));const t=e[0],s=new AzurePipelineParser({printTree:!1});try{const e=n.readFileSync(t,"utf8"),r=s.expandPipelineToString(e,{fileName:t});process.stdout.write(r)}catch(e){console.error(`Failed to expand pipeline: ${e.message}`),process.exit(1)}}},4355:(e,t)=>{"use strict";class YAMLError extends Error{constructor(e,t,s,n){super(),this.name=e,this.code=s,this.message=n,this.pos=t}}t.YAMLError=YAMLError,t.YAMLParseError=class YAMLParseError extends YAMLError{constructor(e,t,s){super("YAMLParseError",e,t,s)}},t.YAMLWarning=class YAMLWarning extends YAMLError{constructor(e,t,s){super("YAMLWarning",e,t,s)}},t.prettifyError=(e,t)=>s=>{if(-1===s.pos[0])return;s.linePos=s.pos.map(e=>t.linePos(e));const{line:n,col:r}=s.linePos[0];s.message+=` at line ${n}, column ${r}`;let i=r-1,o=e.substring(t.lineStarts[n-1],t.lineStarts[n]).replace(/[\n\r]+$/,"");if(i>=60&&o.length>80){const e=Math.min(i-39,o.length-79);o=""+o.substring(e),i-=e-1}if(o.length>80&&(o=o.substring(0,79)+""),n>1&&/^ *$/.test(o.substring(0,i))){let s=e.substring(t.lineStarts[n-2],t.lineStarts[n-1]);s.length>80&&(s=s.substring(0,79)+"\n"),o=s+o}if(/[^ ]/.test(o)){let e=1;const t=s.linePos[1];t?.line===n&&t.col>r&&(e=Math.max(1,Math.min(t.col-r,80-i)));const a=" ".repeat(i)+"^".repeat(e);s.message+=`:\n\n${o}\n${a}\n`}}},4927:(e,t,s)=>{"use strict";var n=s(932),r=s(8673),i=s(9046),o=s(4355),a=s(484),c=s(2206),l=s(6845);function getErrorPos(e){if("number"==typeof e)return[e,e+1];if(Array.isArray(e))return 2===e.length?e:[e[0],e[1]];const{offset:t,source:s}=e;return[t,t+("string"==typeof s?s.length:1)]}function parsePrelude(e){let t="",s=!1,n=!1;for(let r=0;r<e.length;++r){const i=e[r];switch(i[0]){case"#":t+=(""===t?"":n?"\n\n":"\n")+(i.substring(1)||" "),s=!0,n=!1;break;case"%":"#"!==e[r+1]?.[0]&&(r+=1),s=!1;break;default:s||(n=!0),s=!1}}return{comment:t,afterEmptyLine:n}}t.Composer=class Composer{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,t,s,n)=>{const r=getErrorPos(e);n?this.warnings.push(new o.YAMLWarning(r,t,s)):this.errors.push(new o.YAMLParseError(r,t,s))},this.directives=new r.Directives({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:s,afterEmptyLine:n}=parsePrelude(this.prelude);if(s){const r=e.contents;if(t)e.comment=e.comment?`${e.comment}\n${s}`:s;else if(n||e.directives.docStart||!r)e.commentBefore=s;else if(a.isCollection(r)&&!r.flow&&r.items.length>0){let e=r.items[0];a.isPair(e)&&(e=e.key);const t=e.commentBefore;e.commentBefore=t?`${s}\n${t}`:s}else{const e=r.commentBefore;r.commentBefore=e?`${s}\n${e}`:s}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:parsePrelude(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,s=-1){for(const t of e)yield*this.next(t);yield*this.end(t,s)}*next(e){switch(n.env.LOG_STREAM&&console.dir(e,{depth:null}),e.type){case"directive":this.directives.add(e.source,(t,s,n)=>{const r=getErrorPos(e);r[0]+=t,this.onError(r,"BAD_DIRECTIVE",s,n)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=c.composeDoc(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,s=new o.YAMLParseError(getErrorPos(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(s):this.doc.errors.push(s);break}case"doc-end":{if(!this.doc){const t="Unexpected doc-end without preceding document";this.errors.push(new o.YAMLParseError(getErrorPos(e),"UNEXPECTED_TOKEN",t));break}this.doc.directives.docEnd=!0;const t=l.resolveEnd(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const e=this.doc.comment;this.doc.comment=e?`${e}\n${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new o.YAMLParseError(getErrorPos(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const e=Object.assign({_directives:this.directives},this.options),s=new i.Document(void 0,e);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),s.range=[0,t,t],this.decorate(s,!1),yield s}}}},4988:(e,t,s)=>{"use strict";var n=s(9714),r=s(3334),i=s(1919);function intIdentify(e){return"bigint"==typeof e||Number.isInteger(e)}const stringifyJSON=({value:e})=>JSON.stringify(e),o=[{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:stringifyJSON},{identify:e=>null==e,createNode:()=>new n.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:stringifyJSON},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>"true"===e,stringify:stringifyJSON},{identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:s})=>s?BigInt(e):parseInt(e,10),stringify:({value:e})=>intIdentify(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:stringifyJSON}],a={default:!0,tag:"",test:/^/,resolve:(e,t)=>(t(`Unresolved plain scalar ${JSON.stringify(e)}`),e)},c=[r.map,i.seq].concat(o,a);t.schema=c},5132:(e,t,s)=>{"use strict";var n=s(9714);const r={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new n.Scalar("t"===e[0]||"T"===e[0]),stringify({source:e,value:t},s){if(e&&r.test.test(e)){if(t===("t"===e[0]||"T"===e[0]))return e}return t?s.options.trueStr:s.options.falseStr}};t.boolTag=r},5139:(e,t,s)=>{"use strict";var n=s(7444),r=s(9637),i=s(3793),o=s(484),a=s(3732);t.addPairToJSMap=function addPairToJSMap(e,t,{key:s,value:c}){if(o.isNode(s)&&s.addToJSMap)s.addToJSMap(e,t,c);else if(r.isMergeKey(e,s))r.addMergeToJSMap(e,t,c);else{const r=a.toJS(s,"",e);if(t instanceof Map)t.set(r,a.toJS(c,r,e));else if(t instanceof Set)t.add(r);else{const l=function stringifyKey(e,t,s){if(null===t)return"";if("object"!=typeof t)return String(t);if(o.isNode(e)&&s?.doc){const t=i.createStringifyContext(s.doc,{});t.anchors=new Set;for(const e of s.anchors.keys())t.anchors.add(e.anchor);t.inFlow=!0,t.inStringifyKey=!0;const r=e.toString(t);if(!s.mapKeyWarned){let e=JSON.stringify(r);e.length>40&&(e=e.substring(0,36)+'..."'),n.warn(s.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`),s.mapKeyWarned=!0}return r}return JSON.stringify(t)}(s,r,e),u=a.toJS(c,l,e);l in t?Object.defineProperty(t,l,{value:u,writable:!0,enumerable:!0,configurable:!0}):t[l]=u}}return t}},5141:(e,t,s)=>{"use strict";var n=s(4070),r=s(7571),i=s(4355),o=s(7180);function addEndtoBlockProps(e,t){if(t)for(const s of t)switch(s.type){case"space":case"comment":e.push(s);break;case"newline":return e.push(s),!0}return!1}function setFlowScalarValue(e,t,s){switch(e.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":e.type=s,e.source=t;break;case"block-scalar":{const n=e.props.slice(1);let r=t.length;"block-scalar-header"===e.props[0].type&&(r-=e.props[0].source.length);for(const e of n)e.offset+=r;delete e.props,Object.assign(e,{type:s,source:t,end:n});break}case"block-map":case"block-seq":{const n={type:"newline",offset:e.offset+t.length,indent:e.indent,source:"\n"};delete e.items,Object.assign(e,{type:s,source:t,end:[n]});break}default:{const n="indent"in e?e.indent:-1,r="end"in e&&Array.isArray(e.end)?e.end.filter(e=>"space"===e.type||"comment"===e.type||"newline"===e.type):[];for(const t of Object.keys(e))"type"!==t&&"offset"!==t&&delete e[t];Object.assign(e,{type:s,indent:n,source:t,end:r})}}}t.createScalarToken=function createScalarToken(e,t){const{implicitKey:s=!1,indent:n,inFlow:r=!1,offset:i=-1,type:a="PLAIN"}=t,c=o.stringifyString({type:a,value:e},{implicitKey:s,indent:n>0?" ".repeat(n):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}}),l=t.end??[{type:"newline",offset:-1,indent:n,source:"\n"}];switch(c[0]){case"|":case">":{const e=c.indexOf("\n"),t=c.substring(0,e),s=c.substring(e+1)+"\n",r=[{type:"block-scalar-header",offset:i,indent:n,source:t}];return addEndtoBlockProps(r,l)||r.push({type:"newline",offset:-1,indent:n,source:"\n"}),{type:"block-scalar",offset:i,indent:n,props:r,source:s}}case'"':return{type:"double-quoted-scalar",offset:i,indent:n,source:c,end:l};case"'":return{type:"single-quoted-scalar",offset:i,indent:n,source:c,end:l};default:return{type:"scalar",offset:i,indent:n,source:c,end:l}}},t.resolveAsScalar=function resolveAsScalar(e,t=!0,s){if(e){const _onError=(e,t,n)=>{const r="number"==typeof e?e:Array.isArray(e)?e[0]:e.offset;if(!s)throw new i.YAMLParseError([r,r+1],t,n);s(r,t,n)};switch(e.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return r.resolveFlowScalar(e,t,_onError);case"block-scalar":return n.resolveBlockScalar({options:{strict:t}},e,_onError)}}return null},t.setScalarValue=function setScalarValue(e,t,s={}){let{afterKey:n=!1,implicitKey:r=!1,inFlow:i=!1,type:a}=s,c="indent"in e?e.indent:null;if(n&&"number"==typeof c&&(c+=2),!a)switch(e.type){case"single-quoted-scalar":a="QUOTE_SINGLE";break;case"double-quoted-scalar":a="QUOTE_DOUBLE";break;case"block-scalar":{const t=e.props[0];if("block-scalar-header"!==t.type)throw new Error("Invalid block scalar header");a=">"===t.source[0]?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:a="PLAIN"}const l=o.stringifyString({type:a,value:t},{implicitKey:r||null===c,indent:null!==c&&c>0?" ".repeat(c):"",inFlow:i,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":!function setBlockScalarValue(e,t){const s=t.indexOf("\n"),n=t.substring(0,s),r=t.substring(s+1)+"\n";if("block-scalar"===e.type){const t=e.props[0];if("block-scalar-header"!==t.type)throw new Error("Invalid block scalar header");t.source=n,e.source=r}else{const{offset:t}=e,s="indent"in e?e.indent:-1,i=[{type:"block-scalar-header",offset:t,indent:s,source:n}];addEndtoBlockProps(i,"end"in e?e.end:void 0)||i.push({type:"newline",offset:-1,indent:s,source:"\n"});for(const t of Object.keys(e))"type"!==t&&"offset"!==t&&delete e[t];Object.assign(e,{type:"block-scalar",indent:s,props:i,source:r})}}(e,l);break;case'"':setFlowScalarValue(e,l,"double-quoted-scalar");break;case"'":setFlowScalarValue(e,l,"single-quoted-scalar");break;default:setFlowScalarValue(e,l,"scalar")}}},5219:(e,t,s)=>{"use strict";var n=s(1736),r=s(484),i=s(9714);t.createNode=function createNode(e,t,s){if(r.isDocument(e)&&(e=e.contents),r.isNode(e))return e;if(r.isPair(e)){const t=s.schema[r.MAP].createNode?.(s.schema,null,s);return t.items.push(e),t}(e instanceof String||e instanceof Number||e instanceof Boolean||"undefined"!=typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:o,onAnchor:a,onTagObj:c,schema:l,sourceObjects:u}=s;let p;if(o&&e&&"object"==typeof e){if(p=u.get(e),p)return p.anchor??(p.anchor=a(e)),new n.Alias(p.anchor);p={anchor:null,node:null},u.set(e,p)}t?.startsWith("!!")&&(t="tag:yaml.org,2002:"+t.slice(2));let f=function findTagObject(e,t,s){if(t){const e=s.filter(e=>e.tag===t),n=e.find(e=>!e.format)??e[0];if(!n)throw new Error(`Tag ${t} not found`);return n}return s.find(t=>t.identify?.(e)&&!t.format)}(e,t,l.tags);if(!f){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){const t=new i.Scalar(e);return p&&(p.node=t),t}f=e instanceof Map?l[r.MAP]:Symbol.iterator in Object(e)?l[r.SEQ]:l[r.MAP]}c&&(c(f),delete s.onTagObj);const h=f?.createNode?f.createNode(s.schema,e,s):"function"==typeof f?.nodeClass?.from?f.nodeClass.from(s.schema,e,s):new i.Scalar(e);return t?h.tag=t:f.default||(h.tag=f.tag),p&&(p.node=h),h}},5437:(e,t,s)=>{"use strict";var n=s(3144);function parseSexagesimal(e,t){const s=e[0],n="-"===s||"+"===s?e.substring(1):e,num=e=>t?BigInt(e):Number(e),r=n.replace(/_/g,"").split(":").reduce((e,t)=>e*num(60)+num(t),num(0));return"-"===s?num(-1)*r:r}function stringifySexagesimal(e){let{value:t}=e,num=e=>e;if("bigint"==typeof t)num=e=>BigInt(e);else if(isNaN(t)||!isFinite(t))return n.stringifyNumber(e);let s="";t<0&&(s="-",t*=num(-1));const r=num(60),i=[t%r];return t<60?i.unshift(0):(t=(t-i[0])/r,i.unshift(t%r),t>=60&&(t=(t-i[0])/r,i.unshift(t))),s+i.map(e=>String(e).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const r={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:s})=>parseSexagesimal(e,s),stringify:stringifySexagesimal},i={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>parseSexagesimal(e,!1),stringify:stringifySexagesimal},o={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const t=e.match(o.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,s,n,r,i,a,c]=t.map(Number),l=t[7]?Number((t[7]+"00").substr(1,3)):0;let u=Date.UTC(s,n-1,r,i||0,a||0,c||0,l);const p=t[8];if(p&&"Z"!==p){let e=parseSexagesimal(p,!1);Math.abs(e)<30&&(e*=60),u-=6e4*e}return new Date(u)},stringify:({value:e})=>e?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""};t.floatTime=i,t.intTime=r,t.timestamp=o},5752:(e,t,s)=>{"use strict";var n=s(9112);function isEmpty(e){switch(e){case void 0:case" ":case"\n":case"\r":case"\t":return!0;default:return!1}}const r=new Set("0123456789ABCDEFabcdef"),i=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),o=new Set(",[]{}"),a=new Set(" ,[]{}\n\r\t"),isNotAnchorChar=e=>!e||a.has(e);t.Lexer=class Lexer{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){if(e){if("string"!=typeof e)throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!t;let s=this.next??"stream";for(;s&&(t||this.hasChars(1));)s=yield*this.parseNext(s)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;" "===t||"\t"===t;)t=this.buffer[++e];return!t||"#"===t||"\n"===t||"\r"===t&&"\n"===this.buffer[e+1]}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let s=0;for(;" "===t;)t=this.buffer[++s+e];if("\r"===t){const t=this.buffer[s+e+1];if("\n"===t||!t&&!this.atEnd)return e+s+1}return"\n"===t||s>=this.indentNext||!t&&!this.atEnd?e+s:-1}if("-"===t||"."===t){const t=this.buffer.substr(e,3);if(("---"===t||"..."===t)&&isEmpty(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return("number"!=typeof e||-1!==e&&e<this.pos)&&(e=this.buffer.indexOf("\n",this.pos),this.lineEndPos=e),-1===e?this.atEnd?this.buffer.substring(this.pos):null:("\r"===this.buffer[e-1]&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(null===e)return this.setNext("stream");if(e[0]===n.BOM&&(yield*this.pushCount(1),e=e.substring(1)),"%"===e[0]){let t=e.length,s=e.indexOf("#");for(;-1!==s;){const n=e[s-1];if(" "===n||"\t"===n){t=s-1;break}s=e.indexOf("#",s+1)}for(;;){const s=e[t-1];if(" "!==s&&"\t"!==s)break;t-=1}const n=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-n),this.pushNewline(),"stream"}if(this.atLineEnd()){const t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield n.DOCUMENT,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if("-"===e||"."===e){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const e=this.peek(3);if(("---"===e||"..."===e)&&isEmpty(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"---"===e?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!isEmpty(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if(("-"===e||"?"===e||":"===e)&&isEmpty(t)){const e=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=e,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(null===e)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(isNotAnchorChar),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=(yield*this.parseBlockScalarHeader()),t+=(yield*this.pushSpaces(!0)),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,s=-1;do{e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=s=t):t=0,t+=(yield*this.pushSpaces(!0))}while(e+t>0);const r=this.getLine();if(null===r)return this.setNext("flow");if(-1!==s&&s<this.indentNext&&"#"!==r[0]||0===s&&(r.startsWith("---")||r.startsWith("..."))&&isEmpty(r[3])){if(!(s===this.indentNext-1&&1===this.flowLevel&&("]"===r[0]||"}"===r[0])))return this.flowLevel=0,yield n.FLOW_END,yield*this.parseLineStart()}let i=0;for(;","===r[i];)i+=(yield*this.pushCount(1)),i+=(yield*this.pushSpaces(!0)),this.flowKey=!1;switch(i+=(yield*this.pushIndicators()),r[i]){case void 0:return"flow";case"#":return yield*this.pushCount(r.length-i),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(isNotAnchorChar),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const e=this.charAt(1);if(this.flowKey||isEmpty(e)||","===e)return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let t=this.buffer.indexOf(e,this.pos+1);if("'"===e)for(;-1!==t&&"'"===this.buffer[t+1];)t=this.buffer.indexOf("'",t+2);else for(;-1!==t;){let e=0;for(;"\\"===this.buffer[t-1-e];)e+=1;if(e%2==0)break;t=this.buffer.indexOf('"',t+1)}const s=this.buffer.substring(0,t);let n=s.indexOf("\n",this.pos);if(-1!==n){for(;-1!==n;){const e=this.continueScalar(n+1);if(-1===e)break;n=s.indexOf("\n",e)}-1!==n&&(t=n-("\r"===s[n-1]?2:1))}if(-1===t){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const t=this.buffer[++e];if("+"===t)this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if("-"!==t)break}return yield*this.pushUntil(e=>isEmpty(e)||"#"===e)}*parseBlockScalar(){let e,t=this.pos-1,s=0;e:for(let n=this.pos;e=this.buffer[n];++n)switch(e){case" ":s+=1;break;case"\n":t=n,s=0;break;case"\r":{const e=this.buffer[n+1];if(!e&&!this.atEnd)return this.setNext("block-scalar");if("\n"===e)break}default:break e}if(!e&&!this.atEnd)return this.setNext("block-scalar");if(s>=this.indentNext){-1===this.blockScalarIndent?this.indentNext=s:this.indentNext=this.blockScalarIndent+(0===this.indentNext?1:this.indentNext);do{const e=this.continueScalar(t+1);if(-1===e)break;t=this.buffer.indexOf("\n",e)}while(-1!==t);if(-1===t){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}let r=t+1;for(e=this.buffer[r];" "===e;)e=this.buffer[++r];if("\t"===e){for(;"\t"===e||" "===e||"\r"===e||"\n"===e;)e=this.buffer[++r];t=r-1}else if(!this.blockScalarKeep)for(;;){let e=t-1,n=this.buffer[e];"\r"===n&&(n=this.buffer[--e]);const r=e;for(;" "===n;)n=this.buffer[--e];if(!("\n"===n&&e>=this.pos&&e+1+s>r))break;t=e}return yield n.SCALAR,yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let t,s=this.pos-1,r=this.pos-1;for(;t=this.buffer[++r];)if(":"===t){const t=this.buffer[r+1];if(isEmpty(t)||e&&o.has(t))break;s=r}else if(isEmpty(t)){let n=this.buffer[r+1];if("\r"===t&&("\n"===n?(r+=1,t="\n",n=this.buffer[r+1]):s=r),"#"===n||e&&o.has(n))break;if("\n"===t){const e=this.continueScalar(r+1);if(-1===e)break;r=Math.max(r,e-2)}}else{if(e&&o.has(t))break;s=r}return t||this.atEnd?(yield n.SCALAR,yield*this.pushToIndex(s+1,!0),e?"flow":"doc"):this.setNext("plain-scalar")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){const s=this.buffer.slice(this.pos,e);return s?(yield s,this.pos+=s.length,s.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(isNotAnchorChar))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,t=this.charAt(1);if(isEmpty(t)||e&&o.has(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if("<"===this.charAt(1)){let e=this.pos+2,t=this.buffer[e];for(;!isEmpty(t)&&">"!==t;)t=this.buffer[++e];return yield*this.pushToIndex(">"===t?e+1:e,!1)}{let e=this.pos+1,t=this.buffer[e];for(;t;)if(i.has(t))t=this.buffer[++e];else{if("%"!==t||!r.has(this.buffer[e+1])||!r.has(this.buffer[e+2]))break;t=this.buffer[e+=3]}return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return"\n"===e?yield*this.pushCount(1):"\r"===e&&"\n"===this.charAt(1)?yield*this.pushCount(2):0}*pushSpaces(e){let t,s=this.pos-1;do{t=this.buffer[++s]}while(" "===t||e&&"\t"===t);const n=s-this.pos;return n>0&&(yield this.buffer.substr(this.pos,n),this.pos=s),n}*pushUntil(e){let t=this.pos,s=this.buffer[t];for(;!e(s);)s=this.buffer[++t];return yield*this.pushToIndex(t,!1)}}},5822:(e,t,s)=>{"use strict";var n=s(3334),r=s(6055),i=s(1919),o=s(8531),a=s(8080),c=s(7969),l=s(7191),u=s(6936),p=s(9637),f=s(692),h=s(8416),d=s(2557),m=s(5437);const g=[n.map,i.seq,o.string,r.nullTag,c.trueTag,c.falseTag,u.intBin,u.intOct,u.int,u.intHex,l.floatNaN,l.floatExp,l.float,a.binary,p.merge,f.omap,h.pairs,d.set,m.intTime,m.floatTime,m.timestamp];t.schema=g},5970:(e,t)=>{"use strict";const s=Symbol("break visit"),n=Symbol("skip children"),r=Symbol("remove item");function visit(e,t){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),_visit(Object.freeze([]),e,t)}function _visit(e,t,n){let i=n(t,e);if("symbol"==typeof i)return i;for(const o of["key","value"]){const a=t[o];if(a&&"items"in a){for(let t=0;t<a.items.length;++t){const i=_visit(Object.freeze(e.concat([[o,t]])),a.items[t],n);if("number"==typeof i)t=i-1;else{if(i===s)return s;i===r&&(a.items.splice(t,1),t-=1)}}"function"==typeof i&&"key"===o&&(i=i(t,e))}}return"function"==typeof i?i(t,e):i}visit.BREAK=s,visit.SKIP=n,visit.REMOVE=r,visit.itemAtPath=(e,t)=>{let s=e;for(const[e,n]of t){const t=s?.[e];if(!t||!("items"in t))return;s=t.items[n]}return s},visit.parentCollection=(e,t)=>{const s=visit.itemAtPath(e,t.slice(0,-1)),n=t[t.length-1][0],r=s?.[n];if(r&&"items"in r)return r;throw new Error("Parent collection not found")},t.visit=visit},6010:(e,t,s)=>{"use strict";var n=s(5219),r=s(81),i=s(1614),o=s(484),a=s(9714),c=s(3732);class YAMLSeq extends i.Collection{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(o.SEQ,e),this.items=[]}add(e){this.items.push(e)}delete(e){const t=asItemIndex(e);if("number"!=typeof t)return!1;return this.items.splice(t,1).length>0}get(e,t){const s=asItemIndex(e);if("number"!=typeof s)return;const n=this.items[s];return!t&&o.isScalar(n)?n.value:n}has(e){const t=asItemIndex(e);return"number"==typeof t&&t<this.items.length}set(e,t){const s=asItemIndex(e);if("number"!=typeof s)throw new Error(`Expected a valid index, not ${e}.`);const n=this.items[s];o.isScalar(n)&&a.isScalarValue(t)?n.value=t:this.items[s]=t}toJSON(e,t){const s=[];t?.onCreate&&t.onCreate(s);let n=0;for(const e of this.items)s.push(c.toJS(e,String(n++),t));return s}toString(e,t,s){return e?r.stringifyCollection(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:s,onComment:t}):JSON.stringify(this)}static from(e,t,s){const{replacer:r}=s,i=new this(e);if(t&&Symbol.iterator in Object(t)){let e=0;for(let o of t){if("function"==typeof r){const s=t instanceof Set?o:String(e++);o=r.call(t,s,o)}i.items.push(n.createNode(o,void 0,s))}}return i}}function asItemIndex(e){let t=o.isScalar(e)?e.value:e;return t&&"string"==typeof t&&(t=Number(t)),"number"==typeof t&&Number.isInteger(t)&&t>=0?t:null}t.YAMLSeq=YAMLSeq},6055:(e,t,s)=>{"use strict";var n=s(9714);const r={identify:e=>null==e,createNode:()=>new n.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new n.Scalar(null),stringify:({source:e},t)=>"string"==typeof e&&r.test.test(e)?e:t.options.nullStr};t.nullTag=r},6170:(e,t)=>{"use strict";const s="block",n="quoted";function consumeMoreIndentedLines(e,t,s){let n=t,r=t+1,i=e[r];for(;" "===i||"\t"===i;)if(t<r+s)i=e[++t];else{do{i=e[++t]}while(i&&"\n"!==i);n=t,r=t+1,i=e[r]}return n}t.FOLD_BLOCK=s,t.FOLD_FLOW="flow",t.FOLD_QUOTED=n,t.foldFlowLines=function foldFlowLines(e,t,r="flow",{indentAtStart:i,lineWidth:o=80,minContentWidth:a=20,onFold:c,onOverflow:l}={}){if(!o||o<0)return e;o<a&&(a=0);const u=Math.max(1+a,1+o-t.length);if(e.length<=u)return e;const p=[],f={};let h,d,m=o-t.length;"number"==typeof i&&(i>o-Math.max(2,a)?p.push(0):m=o-i);let g=!1,y=-1,b=-1,v=-1;r===s&&(y=consumeMoreIndentedLines(e,y,t.length),-1!==y&&(m=y+u));for(let i;i=e[y+=1];){if(r===n&&"\\"===i){switch(b=y,e[y+1]){case"x":y+=3;break;case"u":y+=5;break;case"U":y+=9;break;default:y+=1}v=y}if("\n"===i)r===s&&(y=consumeMoreIndentedLines(e,y,t.length)),m=y+t.length+u,h=void 0;else{if(" "===i&&d&&" "!==d&&"\n"!==d&&"\t"!==d){const t=e[y+1];t&&" "!==t&&"\n"!==t&&"\t"!==t&&(h=y)}if(y>=m)if(h)p.push(h),m=h+u,h=void 0;else if(r===n){for(;" "===d||"\t"===d;)d=i,i=e[y+=1],g=!0;const t=y>v+1?y-2:b-1;if(f[t])return e;p.push(t),f[t]=!0,m=t+u,h=void 0}else g=!0}d=i}if(g&&l&&l(),0===p.length)return e;c&&c();let w=e.slice(0,p[0]);for(let s=0;s<p.length;++s){const i=p[s],o=p[s+1]||e.length;0===i?w=`\n${t}${e.slice(0,o)}`:(r===n&&f[i]&&(w+=`${e[i]}\\`),w+=`\n${t}${e.slice(i+1,o)}`)}return w}},6247:(e,t,s)=>{"use strict";var n=s(932),r=s(9112),i=s(5752);function includesToken(e,t){for(let s=0;s<e.length;++s)if(e[s].type===t)return!0;return!1}function findNonEmptyIndex(e){for(let t=0;t<e.length;++t)switch(e[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function isFlowToken(e){switch(e?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function getPrevProps(e){switch(e.type){case"document":return e.start;case"block-map":{const t=e.items[e.items.length-1];return t.sep??t.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function getFirstKeyStartProps(e){if(0===e.length)return[];let t=e.length;e:for(;--t>=0;)switch(e[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;"space"===e[++t]?.type;);return e.splice(t,e.length)}function fixFlowSeqItems(e){if("flow-seq-start"===e.start.type)for(const t of e.items)!t.sep||t.value||includesToken(t.start,"explicit-key-ind")||includesToken(t.sep,"map-value-ind")||(t.key&&(t.value=t.key),delete t.key,isFlowToken(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}t.Parser=class Parser{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new i.Lexer,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&0===this.offset&&this.onNewLine(0);for(const s of this.lexer.lex(e,t))yield*this.next(s);t||(yield*this.end())}*next(e){if(this.source=e,n.env.LOG_TOKENS&&console.log("|",r.prettyToken(e)),this.atScalar)return this.atScalar=!1,yield*this.step(),void(this.offset+=e.length);const t=r.tokenType(e);if(t)if("scalar"===t)this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&" "===e[0]&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const t=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:t,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if("doc-end"!==this.type||"doc-end"===e?.type){if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}else{for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source})}}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(t)if(0===this.stack.length)yield t;else{const e=this.peek(1);switch("block-scalar"===t.type?t.indent="indent"in e?e.indent:0:"flow-collection"===t.type&&"document"===e.type&&(t.indent=0),"flow-collection"===t.type&&fixFlowSeqItems(t),e.type){case"document":e.value=t;break;case"block-scalar":e.props.push(t);break;case"block-map":{const s=e.items[e.items.length-1];if(s.value)return e.items.push({start:[],key:t,sep:[]}),void(this.onKeyLine=!0);if(!s.sep)return Object.assign(s,{key:t,sep:[]}),void(this.onKeyLine=!s.explicitKey);s.value=t;break}case"block-seq":{const s=e.items[e.items.length-1];s.value?e.items.push({start:[],value:t}):s.value=t;break}case"flow-collection":{const s=e.items[e.items.length-1];return void(!s||s.value?e.items.push({start:[],key:t,sep:[]}):s.sep?s.value=t:Object.assign(s,{key:t,sep:[]}))}default:yield*this.pop(),yield*this.pop(t)}if(!("document"!==e.type&&"block-map"!==e.type&&"block-seq"!==e.type||"block-map"!==t.type&&"block-seq"!==t.type)){const s=t.items[t.items.length-1];s&&!s.sep&&!s.value&&s.start.length>0&&-1===findNonEmptyIndex(s.start)&&(0===t.indent||s.start.every(e=>"comment"!==e.type||e.indent<t.indent))&&("document"===e.type?e.end=s.start:e.items.push({start:s.start}),t.items.splice(-1,1))}}else{const e="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:e}}}*stream(){switch(this.type){case"directive-line":return void(yield{type:"directive",offset:this.offset,source:this.source});case"byte-order-mark":case"space":case"comment":case"newline":return void(yield this.sourceToken);case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};return"doc-start"===this.type&&e.start.push(this.sourceToken),void this.stack.push(e)}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":return void(-1!==findNonEmptyIndex(e.start)?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken));case"anchor":case"tag":case"space":case"comment":case"newline":return void e.start.push(this.sourceToken)}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if("map-value-ind"===this.type){const t=getFirstKeyStartProps(getPrevProps(this.peek(2)));let s;e.end?(s=e.end,s.push(this.sourceToken),delete e.end):s=[this.sourceToken];const n={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:t,key:e,sep:s}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=n}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":return void e.props.push(this.sourceToken);case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf("\n")+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf("\n",e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){const s="end"in t.value?t.value.end:void 0,n=Array.isArray(s)?s[s.length-1]:void 0;"comment"===n?.type?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){const s=e.items[e.items.length-2],n=s?.value?.end;if(Array.isArray(n))return Array.prototype.push.apply(n,t.start),n.push(this.sourceToken),void e.items.pop()}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const s=!this.onKeyLine&&this.indent===e.indent,n=s&&(t.sep||t.explicitKey)&&"seq-item-ind"!==this.type;let r=[];if(n&&t.sep&&!t.value){const s=[];for(let n=0;n<t.sep.length;++n){const r=t.sep[n];switch(r.type){case"newline":s.push(n);break;case"space":break;case"comment":r.indent>e.indent&&(s.length=0);break;default:s.length=0}}s.length>=2&&(r=t.sep.splice(s[1]))}switch(this.type){case"anchor":case"tag":return void(n||t.value?(r.push(this.sourceToken),e.items.push({start:r}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken));case"explicit-key-ind":return t.sep||t.explicitKey?n||t.value?(r.push(this.sourceToken),e.items.push({start:r,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}):(t.start.push(this.sourceToken),t.explicitKey=!0),void(this.onKeyLine=!0);case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(includesToken(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]});else if(isFlowToken(t.key)&&!includesToken(t.sep,"newline")){const e=getFirstKeyStartProps(t.start),s=t.key,n=t.sep;n.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:s,sep:n}]})}else r.length>0?t.sep=t.sep.concat(r,this.sourceToken):t.sep.push(this.sourceToken);else if(includesToken(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{const e=getFirstKeyStartProps(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||n?e.items.push({start:r,key:null,sep:[this.sourceToken]}):includesToken(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return void(this.onKeyLine=!0);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const s=this.flowScalar(this.type);return void(n||t.value?(e.items.push({start:r,key:s,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(s):(Object.assign(t,{key:s,sep:[]}),this.onKeyLine=!0))}default:{const n=this.startBlockValue(e);if(n){if("block-seq"===n.type){if(!t.explicitKey&&t.sep&&!includesToken(t.sep,"newline"))return void(yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source}))}else s&&e.items.push({start:r});return void this.stack.push(n)}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){const s="end"in t.value?t.value.end:void 0,n=Array.isArray(s)?s[s.length-1]:void 0;"comment"===n?.type?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){const s=e.items[e.items.length-2],n=s?.value?.end;if(Array.isArray(n))return Array.prototype.push.apply(n,t.start),n.push(this.sourceToken),void e.items.pop()}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;return void t.start.push(this.sourceToken);case"seq-item-ind":if(this.indent!==e.indent)break;return void(t.value||includesToken(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken))}if(this.indent>e.indent){const t=this.startBlockValue(e);if(t)return void this.stack.push(t)}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if("flow-error-end"===this.type){let e;do{yield*this.pop(),e=this.peek(1)}while("flow-collection"===e?.type)}else if(0===e.end.length){switch(this.type){case"comma":case"explicit-key-ind":return void(!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken));case"map-value-ind":return void(!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]}));case"space":case"comment":case"newline":case"anchor":case"tag":return void(!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken));case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const s=this.flowScalar(this.type);return void(!t||t.value?e.items.push({start:[],key:s,sep:[]}):t.sep?this.stack.push(s):Object.assign(t,{key:s,sep:[]}))}case"flow-map-end":case"flow-seq-end":return void e.end.push(this.sourceToken)}const s=this.startBlockValue(e);s?this.stack.push(s):(yield*this.pop(),yield*this.step())}else{const t=this.peek(2);if("block-map"===t.type&&("map-value-ind"===this.type&&t.indent===e.indent||"newline"===this.type&&!t.items[t.items.length-1].sep))yield*this.pop(),yield*this.step();else if("map-value-ind"===this.type&&"flow-collection"!==t.type){const s=getFirstKeyStartProps(getPrevProps(t));fixFlowSeqItems(e);const n=e.end.splice(1,e.end.length);n.push(this.sourceToken);const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:n}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let e=this.source.indexOf("\n")+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf("\n",e)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=getFirstKeyStartProps(getPrevProps(e));return t.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const t=getFirstKeyStartProps(getPrevProps(e));return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return"comment"===this.type&&(!(this.indent<=t)&&e.every(e=>"newline"===e.type||"space"===e.type))}*documentEnd(e){"doc-mode"!==this.type&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop())}}}},6261:(e,t,s)=>{"use strict";var n=s(484),r=s(9125);function anchorNames(e){const t=new Set;return r.visit(e,{Value(e,s){s.anchor&&t.add(s.anchor)}}),t}function findNewAnchor(e,t){for(let s=1;;++s){const n=`${e}${s}`;if(!t.has(n))return n}}t.anchorIsValid=function anchorIsValid(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const t=JSON.stringify(e);throw new Error(`Anchor must not contain whitespace or control characters: ${t}`)}return!0},t.anchorNames=anchorNames,t.createNodeAnchors=function createNodeAnchors(e,t){const s=[],r=new Map;let i=null;return{onAnchor:n=>{s.push(n),i??(i=anchorNames(e));const r=findNewAnchor(t,i);return i.add(r),r},setAnchors:()=>{for(const e of s){const t=r.get(e);if("object"!=typeof t||!t.anchor||!n.isScalar(t.node)&&!n.isCollection(t.node)){const t=new Error("Failed to resolve repeated object (this should not happen)");throw t.source=e,t}t.node.anchor=t.anchor}},sourceObjects:r}},t.findNewAnchor=findNewAnchor},6845:(e,t)=>{"use strict";t.resolveEnd=function resolveEnd(e,t,s,n){let r="";if(e){let i=!1,o="";for(const a of e){const{source:e,type:c}=a;switch(c){case"space":i=!0;break;case"comment":{s&&!i&&n(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const t=e.substring(1)||" ";r?r+=o+t:r=t,o="";break}case"newline":r&&(o+=e),i=!0;break;default:n(a,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}t+=e.length}}return{comment:r,offset:t}}},6906:(e,t)=>{"use strict";t.applyReviver=function applyReviver(e,t,s,n){if(n&&"object"==typeof n)if(Array.isArray(n))for(let t=0,s=n.length;t<s;++t){const s=n[t],r=applyReviver(e,n,String(t),s);void 0===r?delete n[t]:r!==s&&(n[t]=r)}else if(n instanceof Map)for(const t of Array.from(n.keys())){const s=n.get(t),r=applyReviver(e,n,t,s);void 0===r?n.delete(t):r!==s&&n.set(t,r)}else if(n instanceof Set)for(const t of Array.from(n)){const s=applyReviver(e,n,t,t);void 0===s?n.delete(t):s!==t&&(n.delete(t),n.add(s))}else for(const[t,s]of Object.entries(n)){const r=applyReviver(e,n,t,s);void 0===r?delete n[t]:r!==s&&(n[t]=r)}return e.call(t,s,n)}},6928:e=>{"use strict";e.exports=require("path")},6936:(e,t,s)=>{"use strict";var n=s(3144);const intIdentify=e=>"bigint"==typeof e||Number.isInteger(e);function intResolve(e,t,s,{intAsBigInt:n}){const r=e[0];if("-"!==r&&"+"!==r||(t+=1),e=e.substring(t).replace(/_/g,""),n){switch(s){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}const t=BigInt(e);return"-"===r?BigInt(-1)*t:t}const i=parseInt(e,s);return"-"===r?-1*i:i}function intStringify(e,t,s){const{value:r}=e;if(intIdentify(r)){const e=r.toString(t);return r<0?"-"+s+e.substr(1):s+e}return n.stringifyNumber(e)}const r={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,s)=>intResolve(e,2,2,s),stringify:e=>intStringify(e,2,"0b")},i={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,s)=>intResolve(e,1,8,s),stringify:e=>intStringify(e,8,"0")},o={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,s)=>intResolve(e,0,10,s),stringify:n.stringifyNumber},a={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,s)=>intResolve(e,2,16,s),stringify:e=>intStringify(e,16,"0x")};t.int=o,t.intBin=r,t.intHex=a,t.intOct=i},7180:(e,t,s)=>{"use strict";var n=s(9714),r=s(6170);const getFoldOptions=(e,t)=>({indentAtStart:t?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),containsDocumentMarker=e=>/^(%|---|\.\.\.)/m.test(e);function doubleQuotedString(e,t){const s=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return s;const{implicitKey:n}=t,i=t.options.doubleQuotedMinMultiLineLength,o=t.indent||(containsDocumentMarker(e)?"  ":"");let a="",c=0;for(let e=0,t=s[e];t;t=s[++e])if(" "===t&&"\\"===s[e+1]&&"n"===s[e+2]&&(a+=s.slice(c,e)+"\\ ",e+=1,c=e,t="\\"),"\\"===t)switch(s[e+1]){case"u":{a+=s.slice(c,e);const t=s.substr(e+2,4);switch(t){case"0000":a+="\\0";break;case"0007":a+="\\a";break;case"000b":a+="\\v";break;case"001b":a+="\\e";break;case"0085":a+="\\N";break;case"00a0":a+="\\_";break;case"2028":a+="\\L";break;case"2029":a+="\\P";break;default:"00"===t.substr(0,2)?a+="\\x"+t.substr(2):a+=s.substr(e,6)}e+=5,c=e+1}break;case"n":if(n||'"'===s[e+2]||s.length<i)e+=1;else{for(a+=s.slice(c,e)+"\n\n";"\\"===s[e+2]&&"n"===s[e+3]&&'"'!==s[e+4];)a+="\n",e+=2;a+=o," "===s[e+2]&&(a+="\\"),e+=1,c=e+1}break;default:e+=1}return a=c?a+s.slice(c):s,n?a:r.foldFlowLines(a,o,r.FOLD_QUOTED,getFoldOptions(t,!1))}function singleQuotedString(e,t){if(!1===t.options.singleQuote||t.implicitKey&&e.includes("\n")||/[ \t]\n|\n[ \t]/.test(e))return doubleQuotedString(e,t);const s=t.indent||(containsDocumentMarker(e)?"  ":""),n="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&\n${s}`)+"'";return t.implicitKey?n:r.foldFlowLines(n,s,r.FOLD_FLOW,getFoldOptions(t,!1))}function quotedString(e,t){const{singleQuote:s}=t.options;let n;if(!1===s)n=doubleQuotedString;else{const t=e.includes('"'),r=e.includes("'");n=t&&!r?singleQuotedString:r&&!t?doubleQuotedString:s?singleQuotedString:doubleQuotedString}return n(e,t)}let i;try{i=new RegExp("(^|(?<!\n))\n+(?!\n|$)","g")}catch{i=/\n+(?!\n|$)/g}function blockString({comment:e,type:t,value:s},o,a,c){const{blockQuote:l,commentString:u,lineWidth:p}=o.options;if(!l||/\n[\t ]+$/.test(s))return quotedString(s,o);const f=o.indent||(o.forceBlockIndent||containsDocumentMarker(s)?"  ":""),h="literal"===l||"folded"!==l&&t!==n.Scalar.BLOCK_FOLDED&&(t===n.Scalar.BLOCK_LITERAL||!function lineLengthOverLimit(e,t,s){if(!t||t<0)return!1;const n=t-s,r=e.length;if(r<=n)return!1;for(let t=0,s=0;t<r;++t)if("\n"===e[t]){if(t-s>n)return!0;if(s=t+1,r-s<=n)return!1}return!0}(s,p,f.length));if(!s)return h?"|\n":">\n";let d,m;for(m=s.length;m>0;--m){const e=s[m-1];if("\n"!==e&&"\t"!==e&&" "!==e)break}let g=s.substring(m);const y=g.indexOf("\n");-1===y?d="-":s===g||y!==g.length-1?(d="+",c&&c()):d="",g&&(s=s.slice(0,-g.length),"\n"===g[g.length-1]&&(g=g.slice(0,-1)),g=g.replace(i,`$&${f}`));let b,v=!1,w=-1;for(b=0;b<s.length;++b){const e=s[b];if(" "===e)v=!0;else{if("\n"!==e)break;w=b}}let S=s.substring(0,w<b?w+1:b);S&&(s=s.substring(S.length),S=S.replace(/\n+/g,`$&${f}`));let E=(v?f?"2":"1":"")+d;if(e&&(E+=" "+u(e.replace(/ ?[\r\n]+/g," ")),a&&a()),!h){const e=s.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${f}`);let i=!1;const a=getFoldOptions(o,!0);"folded"!==l&&t!==n.Scalar.BLOCK_FOLDED&&(a.onOverflow=()=>{i=!0});const c=r.foldFlowLines(`${S}${e}${g}`,f,r.FOLD_BLOCK,a);if(!i)return`>${E}\n${f}${c}`}return`|${E}\n${f}${S}${s=s.replace(/\n+/g,`$&${f}`)}${g}`}t.stringifyString=function stringifyString(e,t,s,i){const{implicitKey:o,inFlow:a}=t,c="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)});let{type:l}=e;l!==n.Scalar.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(c.value)&&(l=n.Scalar.QUOTE_DOUBLE);const _stringify=e=>{switch(e){case n.Scalar.BLOCK_FOLDED:case n.Scalar.BLOCK_LITERAL:return o||a?quotedString(c.value,t):blockString(c,t,s,i);case n.Scalar.QUOTE_DOUBLE:return doubleQuotedString(c.value,t);case n.Scalar.QUOTE_SINGLE:return singleQuotedString(c.value,t);case n.Scalar.PLAIN:return function plainString(e,t,s,i){const{type:o,value:a}=e,{actualString:c,implicitKey:l,indent:u,indentStep:p,inFlow:f}=t;if(l&&a.includes("\n")||f&&/[[\]{},]/.test(a))return quotedString(a,t);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(a))return l||f||!a.includes("\n")?quotedString(a,t):blockString(e,t,s,i);if(!l&&!f&&o!==n.Scalar.PLAIN&&a.includes("\n"))return blockString(e,t,s,i);if(containsDocumentMarker(a)){if(""===u)return t.forceBlockIndent=!0,blockString(e,t,s,i);if(l&&u===p)return quotedString(a,t)}const h=a.replace(/\n+/g,`$&\n${u}`);if(c){const test=e=>e.default&&"tag:yaml.org,2002:str"!==e.tag&&e.test?.test(h),{compat:e,tags:s}=t.doc.schema;if(s.some(test)||e?.some(test))return quotedString(a,t)}return l?h:r.foldFlowLines(h,u,r.FOLD_FLOW,getFoldOptions(t,!1))}(c,t,s,i);default:return null}};let u=_stringify(l);if(null===u){const{defaultKeyType:e,defaultStringType:s}=t.options,n=o&&e||s;if(u=_stringify(n),null===u)throw new Error(`Unsupported default string type ${n}`)}return u}},7191:(e,t,s)=>{"use strict";var n=s(9714),r=s(3144);const i={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:r.stringifyNumber},o={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():r.stringifyNumber(e)}},a={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const t=new n.Scalar(parseFloat(e.replace(/_/g,""))),s=e.indexOf(".");if(-1!==s){const n=e.substring(s+1).replace(/_/g,"");"0"===n[n.length-1]&&(t.minFractionDigits=n.length)}return t},stringify:r.stringifyNumber};t.float=a,t.floatExp=o,t.floatNaN=i},7434:(e,t,s)=>{"use strict";var n=s(7902),r=s(1755),i=s(1386),o=s(9378),a=s(8644),c=s(8334);const l="All mapping items must start at the same column";t.resolveBlockMap=function resolveBlockMap({composeNode:e,composeEmptyNode:t},s,u,p,f){const h=new(f?.nodeClass??r.YAMLMap)(s.schema);s.atRoot&&(s.atRoot=!1);let d=u.offset,m=null;for(const r of u.items){const{start:f,key:g,sep:y,value:b}=r,v=i.resolveProps(f,{indicator:"explicit-key-ind",next:g??y?.[0],offset:d,onError:p,parentIndent:u.indent,startOnNewline:!0}),w=!v.found;if(w){if(g&&("block-seq"===g.type?p(d,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in g&&g.indent!==u.indent&&p(d,"BAD_INDENT",l)),!v.anchor&&!v.tag&&!y){m=v.end,v.comment&&(h.comment?h.comment+="\n"+v.comment:h.comment=v.comment);continue}(v.newlineAfterProp||o.containsNewline(g))&&p(g??f[f.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else v.found?.indent!==u.indent&&p(d,"BAD_INDENT",l);s.atKey=!0;const S=v.end,E=g?e(s,g,v,p):t(s,S,f,null,v,p);s.schema.compat&&a.flowIndentCheck(u.indent,g,p),s.atKey=!1,c.mapIncludes(s,h.items,E)&&p(S,"DUPLICATE_KEY","Map keys must be unique");const k=i.resolveProps(y??[],{indicator:"map-value-ind",next:b,offset:E.range[2],onError:p,parentIndent:u.indent,startOnNewline:!g||"block-scalar"===g.type});if(d=k.end,k.found){w&&("block-map"!==b?.type||k.hasNewline||p(d,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),s.options.strict&&v.start<k.found.offset-1024&&p(E.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const i=b?e(s,b,k,p):t(s,d,y,null,k,p);s.schema.compat&&a.flowIndentCheck(u.indent,b,p),d=i.range[2];const o=new n.Pair(E,i);s.options.keepSourceTokens&&(o.srcToken=r),h.items.push(o)}else{w&&p(E.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),k.comment&&(E.comment?E.comment+="\n"+k.comment:E.comment=k.comment);const e=new n.Pair(E);s.options.keepSourceTokens&&(e.srcToken=r),h.items.push(e)}}return m&&m<d&&p(m,"IMPOSSIBLE","Map comment with trailing content"),h.range=[u.offset,d,m??d],h}},7444:(e,t,s)=>{"use strict";var n=s(932);t.debug=function debug(e,...t){"debug"===e&&console.log(...t)},t.warn=function warn(e,t){"debug"!==e&&"warn"!==e||("function"==typeof n.emitWarning?n.emitWarning(t):console.warn(t))}},7571:(e,t,s)=>{"use strict";var n=s(9714),r=s(6845);function foldLines(e){let t,s;try{t=new RegExp("(.*?)(?<![ \t])[ \t]*\r?\n","sy"),s=new RegExp("[ \t]*(.*?)(?:(?<![ \t])[ \t]*)?\r?\n","sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,s=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=t.exec(e);if(!n)return e;let r=n[1],i=" ",o=t.lastIndex;for(s.lastIndex=o;n=s.exec(e);)""===n[1]?"\n"===i?r+=i:i="\n":(r+=i+n[1],i=" "),o=s.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=o,n=a.exec(e),r+i+(n?.[1]??"")}function foldNewline(e,t){let s="",n=e[t+1];for(;!(" "!==n&&"\t"!==n&&"\n"!==n&&"\r"!==n||"\r"===n&&"\n"!==e[t+2]);)"\n"===n&&(s+="\n"),n=e[(t+=1)+1];return s||(s=" "),{fold:s,offset:t}}const i={0:"\0",a:"",b:"\b",e:"",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v",N:"",_:"",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","\t":"\t"};function parseCharCode(e,t,s,n){const r=e.substr(t,s),i=r.length===s&&/^[0-9a-fA-F]+$/.test(r)?parseInt(r,16):NaN;if(isNaN(i)){const r=e.substr(t-2,s+2);return n(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${r}`),r}return String.fromCodePoint(i)}t.resolveFlowScalar=function resolveFlowScalar(e,t,s){const{offset:o,type:a,source:c,end:l}=e;let u,p;const _onError=(e,t,n)=>s(o+e,t,n);switch(a){case"scalar":u=n.Scalar.PLAIN,p=function plainValue(e,t){let s="";switch(e[0]){case"\t":s="a tab character";break;case",":s="flow indicator character ,";break;case"%":s="directive indicator character %";break;case"|":case">":s=`block scalar indicator ${e[0]}`;break;case"@":case"`":s=`reserved character ${e[0]}`}s&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${s}`);return foldLines(e)}(c,_onError);break;case"single-quoted-scalar":u=n.Scalar.QUOTE_SINGLE,p=function singleQuotedValue(e,t){"'"===e[e.length-1]&&1!==e.length||t(e.length,"MISSING_CHAR","Missing closing 'quote");return foldLines(e.slice(1,-1)).replace(/''/g,"'")}(c,_onError);break;case"double-quoted-scalar":u=n.Scalar.QUOTE_DOUBLE,p=function doubleQuotedValue(e,t){let s="";for(let n=1;n<e.length-1;++n){const r=e[n];if("\r"!==r||"\n"!==e[n+1])if("\n"===r){const{fold:t,offset:r}=foldNewline(e,n);s+=t,n=r}else if("\\"===r){let r=e[++n];const o=i[r];if(o)s+=o;else if("\n"===r)for(r=e[n+1];" "===r||"\t"===r;)r=e[1+ ++n];else if("\r"===r&&"\n"===e[n+1])for(r=e[1+ ++n];" "===r||"\t"===r;)r=e[1+ ++n];else if("x"===r||"u"===r||"U"===r){const i={x:2,u:4,U:8}[r];s+=parseCharCode(e,n+1,i,t),n+=i}else{const r=e.substr(n-1,2);t(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${r}`),s+=r}}else if(" "===r||"\t"===r){const t=n;let i=e[n+1];for(;" "===i||"\t"===i;)i=e[1+ ++n];"\n"===i||"\r"===i&&"\n"===e[n+2]||(s+=n>t?e.slice(t,n+1):r)}else s+=r}'"'===e[e.length-1]&&1!==e.length||t(e.length,"MISSING_CHAR",'Missing closing "quote');return s}(c,_onError);break;default:return s(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${a}`),{value:"",type:null,comment:"",range:[o,o+c.length,o+c.length]}}const f=o+c.length,h=r.resolveEnd(l,f,t,s);return{value:p,type:u,comment:h.comment,range:[o,f,h.offset]}}},7808:(e,t)=>{"use strict";function stringifyToken(e){switch(e.type){case"block-scalar":{let t="";for(const s of e.props)t+=stringifyToken(s);return t+e.source}case"block-map":case"block-seq":{let t="";for(const s of e.items)t+=stringifyItem(s);return t}case"flow-collection":{let t=e.start.source;for(const s of e.items)t+=stringifyItem(s);for(const s of e.end)t+=s.source;return t}case"document":{let t=stringifyItem(e);if(e.end)for(const s of e.end)t+=s.source;return t}default:{let t=e.source;if("end"in e&&e.end)for(const s of e.end)t+=s.source;return t}}}function stringifyItem({start:e,key:t,sep:s,value:n}){let r="";for(const t of e)r+=t.source;if(t&&(r+=stringifyToken(t)),s)for(const e of s)r+=e.source;return n&&(r+=stringifyToken(n)),r}t.stringify=e=>"type"in e?stringifyToken(e):stringifyItem(e)},7902:(e,t,s)=>{"use strict";var n=s(5219),r=s(8017),i=s(5139),o=s(484);class Pair{constructor(e,t=null){Object.defineProperty(this,o.NODE_TYPE,{value:o.PAIR}),this.key=e,this.value=t}clone(e){let{key:t,value:s}=this;return o.isNode(t)&&(t=t.clone(e)),o.isNode(s)&&(s=s.clone(e)),new Pair(t,s)}toJSON(e,t){const s=t?.mapAsMap?new Map:{};return i.addPairToJSMap(t,s,this)}toString(e,t,s){return e?.doc?r.stringifyPair(this,e,t,s):JSON.stringify(this)}}t.Pair=Pair,t.createPair=function createPair(e,t,s){const r=n.createNode(e,void 0,s),i=n.createNode(t,void 0,s);return new Pair(r,i)}},7969:(e,t,s)=>{"use strict";var n=s(9714);function boolStringify({value:e,source:t},s){return t&&(e?r:i).test.test(t)?t:e?s.options.trueStr:s.options.falseStr}const r={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new n.Scalar(!0),stringify:boolStringify},i={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new n.Scalar(!1),stringify:boolStringify};t.falseTag=i,t.trueTag=r},8017:(e,t,s)=>{"use strict";var n=s(484),r=s(9714),i=s(3793),o=s(248);t.stringifyPair=function stringifyPair({key:e,value:t},s,a,c){const{allNullValues:l,doc:u,indent:p,indentStep:f,options:{commentString:h,indentSeq:d,simpleKeys:m}}=s;let g=n.isNode(e)&&e.comment||null;if(m){if(g)throw new Error("With simple keys, key nodes cannot have comments");if(n.isCollection(e)||!n.isNode(e)&&"object"==typeof e){throw new Error("With simple keys, collection cannot be used as a key value")}}let y=!m&&(!e||g&&null==t&&!s.inFlow||n.isCollection(e)||(n.isScalar(e)?e.type===r.Scalar.BLOCK_FOLDED||e.type===r.Scalar.BLOCK_LITERAL:"object"==typeof e));s=Object.assign({},s,{allNullValues:!1,implicitKey:!y&&(m||!l),indent:p+f});let b,v,w,S=!1,E=!1,k=i.stringify(e,s,()=>S=!0,()=>E=!0);if(!y&&!s.inFlow&&k.length>1024){if(m)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");y=!0}if(s.inFlow){if(l||null==t)return S&&a&&a(),""===k?"?":y?`? ${k}`:k}else if(l&&!m||null==t&&y)return k=`? ${k}`,g&&!S?k+=o.lineComment(k,s.indent,h(g)):E&&c&&c(),k;S&&(g=null),y?(g&&(k+=o.lineComment(k,s.indent,h(g))),k=`? ${k}\n${p}:`):(k=`${k}:`,g&&(k+=o.lineComment(k,s.indent,h(g)))),n.isNode(t)?(b=!!t.spaceBefore,v=t.commentBefore,w=t.comment):(b=!1,v=null,w=null,t&&"object"==typeof t&&(t=u.createNode(t))),s.implicitKey=!1,y||g||!n.isScalar(t)||(s.indentAtStart=k.length+1),E=!1,d||!(f.length>=2)||s.inFlow||y||!n.isSeq(t)||t.flow||t.tag||t.anchor||(s.indent=s.indent.substring(2));let A=!1;const x=i.stringify(t,s,()=>A=!0,()=>E=!0);let O=" ";if(g||b||v){if(O=b?"\n":"",v){const e=h(v);O+=`\n${o.indentComment(e,s.indent)}`}""!==x||s.inFlow?O+=`\n${s.indent}`:"\n"===O&&w&&(O="\n\n")}else if(!y&&n.isCollection(t)){const e=x[0],n=x.indexOf("\n"),r=-1!==n,i=s.inFlow??t.flow??0===t.items.length;if(r||!i){let t=!1;if(r&&("&"===e||"!"===e)){let s=x.indexOf(" ");"&"===e&&-1!==s&&s<n&&"!"===x[s+1]&&(s=x.indexOf(" ",s+1)),(-1===s||n<s)&&(t=!0)}t||(O=`\n${s.indent}`)}}else""!==x&&"\n"!==x[0]||(O="");return k+=O+x,s.inFlow?A&&a&&a():w&&!A?k+=o.lineComment(k,s.indent,h(w)):E&&c&&c(),k}},8080:(e,t,s)=>{"use strict";var n=s(181),r=s(9714),i=s(7180);const o={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if("function"==typeof n.Buffer)return n.Buffer.from(e,"base64");if("function"==typeof atob){const t=atob(e.replace(/[\n\r]/g,"")),s=new Uint8Array(t.length);for(let e=0;e<t.length;++e)s[e]=t.charCodeAt(e);return s}return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:s},o,a,c){if(!s)return"";const l=s;let u;if("function"==typeof n.Buffer)u=l instanceof n.Buffer?l.toString("base64"):n.Buffer.from(l.buffer).toString("base64");else{if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");{let e="";for(let t=0;t<l.length;++t)e+=String.fromCharCode(l[t]);u=btoa(e)}}if(t??(t=r.Scalar.BLOCK_LITERAL),t!==r.Scalar.QUOTE_DOUBLE){const e=Math.max(o.options.lineWidth-o.indent.length,o.options.minContentWidth),s=Math.ceil(u.length/e),n=new Array(s);for(let t=0,r=0;t<s;++t,r+=e)n[t]=u.substr(r,e);u=n.join(t===r.Scalar.BLOCK_LITERAL?"\n":" ")}return i.stringifyString({comment:e,type:t,value:u},o,a,c)}};t.binary=o},8334:(e,t,s)=>{"use strict";var n=s(484);t.mapIncludes=function mapIncludes(e,t,s){const{uniqueKeys:r}=e.options;if(!1===r)return!1;const i="function"==typeof r?r:(e,t)=>e===t||n.isScalar(e)&&n.isScalar(t)&&e.value===t.value;return t.some(e=>i(e.key,s))}},8416:(e,t,s)=>{"use strict";var n=s(484),r=s(7902),i=s(9714),o=s(6010);function resolvePairs(e,t){if(n.isSeq(e))for(let s=0;s<e.items.length;++s){let o=e.items[s];if(!n.isPair(o)){if(n.isMap(o)){o.items.length>1&&t("Each pair must have its own sequence indicator");const e=o.items[0]||new r.Pair(new i.Scalar(null));if(o.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${o.commentBefore}\n${e.key.commentBefore}`:o.commentBefore),o.comment){const t=e.value??e.key;t.comment=t.comment?`${o.comment}\n${t.comment}`:o.comment}o=e}e.items[s]=n.isPair(o)?o:new r.Pair(o)}}else t("Expected a sequence for this tag");return e}function createPairs(e,t,s){const{replacer:n}=s,i=new o.YAMLSeq(e);i.tag="tag:yaml.org,2002:pairs";let a=0;if(t&&Symbol.iterator in Object(t))for(let e of t){let o,c;if("function"==typeof n&&(e=n.call(t,String(a++),e)),Array.isArray(e)){if(2!==e.length)throw new TypeError(`Expected [key, value] tuple: ${e}`);o=e[0],c=e[1]}else if(e&&e instanceof Object){const t=Object.keys(e);if(1!==t.length)throw new TypeError(`Expected tuple with one key, not ${t.length} keys`);o=t[0],c=e[o]}else o=e;i.items.push(r.createPair(o,c,s))}return i}const a={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:resolvePairs,createNode:createPairs};t.createPairs=createPairs,t.pairs=a,t.resolvePairs=resolvePairs},8523:(e,t,s)=>{"use strict";var n=s(3334),r=s(6055),i=s(1919),o=s(8531),a=s(5132),c=s(988),l=s(2891);const u=[n.map,i.seq,o.string,r.nullTag,a.boolTag,l.intOct,l.int,l.intHex,c.floatNaN,c.floatExp,c.float];t.schema=u},8531:(e,t,s)=>{"use strict";var n=s(7180);const r={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,t,s,r)=>(t=Object.assign({actualString:!0},t),n.stringifyString(e,t,s,r))};t.string=r},8644:(e,t,s)=>{"use strict";var n=s(9378);t.flowIndentCheck=function flowIndentCheck(e,t,s){if("flow-collection"===t?.type){const r=t.end[0];if(r.indent===e&&("]"===r.source||"}"===r.source)&&n.containsNewline(t)){s(r,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}}},8673:(e,t,s)=>{"use strict";var n=s(484),r=s(9125);const i={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},escapeTagName=e=>e.replace(/[!,[\]{}]/g,e=>i[e]);class Directives{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Directives.defaultYaml,e),this.tags=Object.assign({},Directives.defaultTags,t)}clone(){const e=new Directives(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new Directives(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Directives.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Directives.defaultTags)}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:Directives.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Directives.defaultTags),this.atNextDocument=!1);const s=e.trim().split(/[ \t]+/),n=s.shift();switch(n){case"%TAG":{if(2!==s.length&&(t(0,"%TAG directive should contain exactly two parts"),s.length<2))return!1;const[e,n]=s;return this.tags[e]=n,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==s.length)return t(0,"%YAML directive should contain exactly one part"),!1;const[e]=s;if("1.1"===e||"1.2"===e)return this.yaml.version=e,!0;return t(6,`Unsupported YAML version ${e}`,/^\d+\.\d+$/.test(e)),!1}default:return t(0,`Unknown directive ${n}`,!0),!1}}tagName(e,t){if("!"===e)return"!";if("!"!==e[0])return t(`Not a valid tag: ${e}`),null;if("<"===e[1]){const s=e.slice(2,-1);return"!"===s||"!!"===s?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&t("Verbatim tags must end with a >"),s)}const[,s,n]=e.match(/^(.*!)([^!]*)$/s);n||t(`The ${e} tag has no suffix`);const r=this.tags[s];if(r)try{return r+decodeURIComponent(n)}catch(e){return t(String(e)),null}return"!"===s?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,s]of Object.entries(this.tags))if(e.startsWith(s))return t+escapeTagName(e.substring(s.length));return"!"===e[0]?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],s=Object.entries(this.tags);let i;if(e&&s.length>0&&n.isNode(e.contents)){const t={};r.visit(e.contents,(e,s)=>{n.isNode(s)&&s.tag&&(t[s.tag]=!0)}),i=Object.keys(t)}else i=[];for(const[n,r]of s)"!!"===n&&"tag:yaml.org,2002:"===r||e&&!i.some(e=>e.startsWith(r))||t.push(`%TAG ${n} ${r}`);return t.join("\n")}}Directives.defaultYaml={explicit:!1,version:"1.2"},Directives.defaultTags={"!!":"tag:yaml.org,2002:"},t.Directives=Directives},8898:(e,t,s)=>{"use strict";var n=s(6906),r=s(484),i=s(3732);t.NodeBase=class NodeBase{constructor(e){Object.defineProperty(this,r.NODE_TYPE,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:s,onAnchor:o,reviver:a}={}){if(!r.isDocument(e))throw new TypeError("A document argument is required");const c={anchors:new Map,doc:e,keep:!0,mapAsMap:!0===t,mapKeyWarned:!1,maxAliasCount:"number"==typeof s?s:100},l=i.toJS(this,"",c);if("function"==typeof o)for(const{count:e,res:t}of c.anchors.values())o(t,e);return"function"==typeof a?n.applyReviver(a,{"":l},"",l):l}}},9031:e=>{"use strict";function isNumber(e){return"number"==typeof e||(!!/^0x[0-9a-f]+$/i.test(e)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(e))}function isConstructorOrProto(e,t){return"constructor"===t&&"function"==typeof e[t]||"__proto__"===t}e.exports=function(e,t){t||(t={});var s={bools:{},strings:{},unknownFn:null};"function"==typeof t.unknown&&(s.unknownFn=t.unknown),"boolean"==typeof t.boolean&&t.boolean?s.allBools=!0:[].concat(t.boolean).filter(Boolean).forEach(function(e){s.bools[e]=!0});var n={};function aliasIsBoolean(e){return n[e].some(function(e){return s.bools[e]})}Object.keys(t.alias||{}).forEach(function(e){n[e]=[].concat(t.alias[e]),n[e].forEach(function(t){n[t]=[e].concat(n[e].filter(function(e){return t!==e}))})}),[].concat(t.string).filter(Boolean).forEach(function(e){s.strings[e]=!0,n[e]&&[].concat(n[e]).forEach(function(e){s.strings[e]=!0})});var r=t.default||{},i={_:[]};function setKey(e,t,n){for(var r=e,i=0;i<t.length-1;i++){var o=t[i];if(isConstructorOrProto(r,o))return;void 0===r[o]&&(r[o]={}),r[o]!==Object.prototype&&r[o]!==Number.prototype&&r[o]!==String.prototype||(r[o]={}),r[o]===Array.prototype&&(r[o]=[]),r=r[o]}var a=t[t.length-1];isConstructorOrProto(r,a)||(r!==Object.prototype&&r!==Number.prototype&&r!==String.prototype||(r={}),r===Array.prototype&&(r=[]),void 0===r[a]||s.bools[a]||"boolean"==typeof r[a]?r[a]=n:Array.isArray(r[a])?r[a].push(n):r[a]=[r[a],n])}function setArg(e,t,r){if(!r||!s.unknownFn||function argDefined(e,t){return s.allBools&&/^--[^=]+$/.test(t)||s.strings[e]||s.bools[e]||n[e]}(e,r)||!1!==s.unknownFn(r)){var o=!s.strings[e]&&isNumber(t)?Number(t):t;setKey(i,e.split("."),o),(n[e]||[]).forEach(function(e){setKey(i,e.split("."),o)})}}Object.keys(s.bools).forEach(function(e){setArg(e,void 0!==r[e]&&r[e])});var o=[];-1!==e.indexOf("--")&&(o=e.slice(e.indexOf("--")+1),e=e.slice(0,e.indexOf("--")));for(var a=0;a<e.length;a++){var c,l,u=e[a];if(/^--.+=/.test(u)){var p=u.match(/^--([^=]+)=([\s\S]*)$/);c=p[1];var f=p[2];s.bools[c]&&(f="false"!==f),setArg(c,f,u)}else if(/^--no-.+/.test(u))setArg(c=u.match(/^--no-(.+)/)[1],!1,u);else if(/^--.+/.test(u))c=u.match(/^--(.+)/)[1],void 0===(l=e[a+1])||/^(-|--)[^-]/.test(l)||s.bools[c]||s.allBools||n[c]&&aliasIsBoolean(c)?/^(true|false)$/.test(l)?(setArg(c,"true"===l,u),a+=1):setArg(c,!s.strings[c]||"",u):(setArg(c,l,u),a+=1);else if(/^-[^-]+/.test(u)){for(var h=u.slice(1,-1).split(""),d=!1,m=0;m<h.length;m++)if("-"!==(l=u.slice(m+2))){if(/[A-Za-z]/.test(h[m])&&"="===l[0]){setArg(h[m],l.slice(1),u),d=!0;break}if(/[A-Za-z]/.test(h[m])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(l)){setArg(h[m],l,u),d=!0;break}if(h[m+1]&&h[m+1].match(/\W/)){setArg(h[m],u.slice(m+2),u),d=!0;break}setArg(h[m],!s.strings[h[m]]||"",u)}else setArg(h[m],l,u);c=u.slice(-1)[0],d||"-"===c||(!e[a+1]||/^(-|--)[^-]/.test(e[a+1])||s.bools[c]||n[c]&&aliasIsBoolean(c)?e[a+1]&&/^(true|false)$/.test(e[a+1])?(setArg(c,"true"===e[a+1],u),a+=1):setArg(c,!s.strings[c]||"",u):(setArg(c,e[a+1],u),a+=1))}else if(s.unknownFn&&!1===s.unknownFn(u)||i._.push(s.strings._||!isNumber(u)?u:Number(u)),t.stopEarly){i._.push.apply(i._,e.slice(a+1));break}}return Object.keys(r).forEach(function(e){(function hasKey(e,t){var s=e;return t.slice(0,-1).forEach(function(e){s=s[e]||{}}),t[t.length-1]in s})(i,e.split("."))||(setKey(i,e.split("."),r[e]),(n[e]||[]).forEach(function(t){setKey(i,t.split("."),r[e])}))}),t["--"]?i["--"]=o.slice():o.forEach(function(e){i._.push(e)}),i}},9046:(e,t,s)=>{"use strict";var n=s(1736),r=s(1614),i=s(484),o=s(7902),a=s(3732),c=s(625),l=s(1768),u=s(6261),p=s(6906),f=s(5219),h=s(8673);class Document{constructor(e,t,s){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,i.NODE_TYPE,{value:i.DOC});let n=null;"function"==typeof t||Array.isArray(t)?n=t:void 0===s&&t&&(s=t,t=void 0);const r=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},s);this.options=r;let{version:o}=r;s?._directives?(this.directives=s._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new h.Directives({version:o}),this.setSchema(o,s),this.contents=void 0===e?null:this.createNode(e,n,s)}clone(){const e=Object.create(Document.prototype,{[i.NODE_TYPE]:{value:i.DOC}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=i.isNode(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){assertCollection(this.contents)&&this.contents.add(e)}addIn(e,t){assertCollection(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const s=u.anchorNames(this);e.anchor=!t||s.has(t)?u.findNewAnchor(t||"a",s):t}return new n.Alias(e.anchor)}createNode(e,t,s){let n;if("function"==typeof t)e=t.call({"":e},"",e),n=t;else if(Array.isArray(t)){const keyToStr=e=>"number"==typeof e||e instanceof String||e instanceof Number,e=t.filter(keyToStr).map(String);e.length>0&&(t=t.concat(e)),n=t}else void 0===s&&t&&(s=t,t=void 0);const{aliasDuplicateObjects:r,anchorPrefix:o,flow:a,keepUndefined:c,onTagObj:l,tag:p}=s??{},{onAnchor:h,setAnchors:d,sourceObjects:m}=u.createNodeAnchors(this,o||"a"),g={aliasDuplicateObjects:r??!0,keepUndefined:c??!1,onAnchor:h,onTagObj:l,replacer:n,schema:this.schema,sourceObjects:m},y=f.createNode(e,p,g);return a&&i.isCollection(y)&&(y.flow=!0),d(),y}createPair(e,t,s={}){const n=this.createNode(e,null,s),r=this.createNode(t,null,s);return new o.Pair(n,r)}delete(e){return!!assertCollection(this.contents)&&this.contents.delete(e)}deleteIn(e){return r.isEmptyPath(e)?null!=this.contents&&(this.contents=null,!0):!!assertCollection(this.contents)&&this.contents.deleteIn(e)}get(e,t){return i.isCollection(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return r.isEmptyPath(e)?!t&&i.isScalar(this.contents)?this.contents.value:this.contents:i.isCollection(this.contents)?this.contents.getIn(e,t):void 0}has(e){return!!i.isCollection(this.contents)&&this.contents.has(e)}hasIn(e){return r.isEmptyPath(e)?void 0!==this.contents:!!i.isCollection(this.contents)&&this.contents.hasIn(e)}set(e,t){null==this.contents?this.contents=r.collectionFromPath(this.schema,[e],t):assertCollection(this.contents)&&this.contents.set(e,t)}setIn(e,t){r.isEmptyPath(e)?this.contents=t:null==this.contents?this.contents=r.collectionFromPath(this.schema,Array.from(e),t):assertCollection(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){let s;switch("number"==typeof e&&(e=String(e)),e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new h.Directives({version:"1.1"}),s={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new h.Directives({version:e}),s={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,s=null;break;default:{const t=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${t}`)}}if(t.schema instanceof Object)this.schema=t.schema;else{if(!s)throw new Error("With a null YAML version, the { schema: Schema } option is required");this.schema=new c.Schema(Object.assign(s,t))}}toJS({json:e,jsonArg:t,mapAsMap:s,maxAliasCount:n,onAnchor:r,reviver:i}={}){const o={anchors:new Map,doc:this,keep:!e,mapAsMap:!0===s,mapKeyWarned:!1,maxAliasCount:"number"==typeof n?n:100},c=a.toJS(this.contents,t??"",o);if("function"==typeof r)for(const{count:e,res:t}of o.anchors.values())r(t,e);return"function"==typeof i?p.applyReviver(i,{"":c},"",c):c}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return l.stringifyDocument(this,e)}}function assertCollection(e){if(i.isCollection(e))return!0;throw new Error("Expected a YAML collection as document contents")}t.Document=Document},9094:(e,t,s)=>{"use strict";var n=s(484),r=s(9714),i=s(4070),o=s(7571);t.composeScalar=function composeScalar(e,t,s,a){const{value:c,type:l,comment:u,range:p}="block-scalar"===t.type?i.resolveBlockScalar(e,t,a):o.resolveFlowScalar(t,e.options.strict,a),f=s?e.directives.tagName(s.source,e=>a(s,"TAG_RESOLVE_FAILED",e)):null;let h,d;h=e.options.stringKeys&&e.atKey?e.schema[n.SCALAR]:f?function findScalarTagByName(e,t,s,r,i){if("!"===s)return e[n.SCALAR];const o=[];for(const t of e.tags)if(!t.collection&&t.tag===s){if(!t.default||!t.test)return t;o.push(t)}for(const e of o)if(e.test?.test(t))return e;const a=e.knownTags[s];if(a&&!a.collection)return e.tags.push(Object.assign({},a,{default:!1,test:void 0})),a;return i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${s}`,"tag:yaml.org,2002:str"!==s),e[n.SCALAR]}(e.schema,c,f,s,a):"scalar"===t.type?function findScalarTagByTest({atKey:e,directives:t,schema:s},r,i,o){const a=s.tags.find(t=>(!0===t.default||e&&"key"===t.default)&&t.test?.test(r))||s[n.SCALAR];if(s.compat){const e=s.compat.find(e=>e.default&&e.test?.test(r))??s[n.SCALAR];if(a.tag!==e.tag){o(i,"TAG_RESOLVE_FAILED",`Value may be parsed as either ${t.tagString(a.tag)} or ${t.tagString(e.tag)}`,!0)}}return a}(e,c,t,a):e.schema[n.SCALAR];try{const i=h.resolve(c,e=>a(s??t,"TAG_RESOLVE_FAILED",e),e.options);d=n.isScalar(i)?i:new r.Scalar(i)}catch(e){const n=e instanceof Error?e.message:String(e);a(s??t,"TAG_RESOLVE_FAILED",n),d=new r.Scalar(c)}return d.range=p,d.source=c,l&&(d.type=l),f&&(d.tag=f),h.format&&(d.format=h.format),u&&(d.comment=u),d}},9112:(e,t,s)=>{"use strict";var n=s(5141),r=s(7808),i=s(5970);t.createScalarToken=n.createScalarToken,t.resolveAsScalar=n.resolveAsScalar,t.setScalarValue=n.setScalarValue,t.stringify=r.stringify,t.visit=i.visit,t.BOM="\ufeff",t.DOCUMENT="",t.FLOW_END="",t.SCALAR="",t.isCollection=e=>!!e&&"items"in e,t.isScalar=e=>!!e&&("scalar"===e.type||"single-quoted-scalar"===e.type||"double-quoted-scalar"===e.type||"block-scalar"===e.type),t.prettyToken=function prettyToken(e){switch(e){case"\ufeff":return"<BOM>";case"":return"<DOC>";case"":return"<FLOW_END>";case"":return"<SCALAR>";default:return JSON.stringify(e)}},t.tokenType=function tokenType(e){switch(e){case"\ufeff":return"byte-order-mark";case"":return"doc-mode";case"":return"flow-error-end";case"":return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case"\n":case"\r\n":return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"\t":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}},9125:(e,t,s)=>{"use strict";var n=s(484);const r=Symbol("break visit"),i=Symbol("skip children"),o=Symbol("remove node");function visit(e,t){const s=initVisitor(t);if(n.isDocument(e)){visit_(null,e.contents,s,Object.freeze([e]))===o&&(e.contents=null)}else visit_(null,e,s,Object.freeze([]))}function visit_(e,t,s,i){const a=callVisitor(e,t,s,i);if(n.isNode(a)||n.isPair(a))return replaceNode(e,i,a),visit_(e,a,s,i);if("symbol"!=typeof a)if(n.isCollection(t)){i=Object.freeze(i.concat(t));for(let e=0;e<t.items.length;++e){const n=visit_(e,t.items[e],s,i);if("number"==typeof n)e=n-1;else{if(n===r)return r;n===o&&(t.items.splice(e,1),e-=1)}}}else if(n.isPair(t)){i=Object.freeze(i.concat(t));const e=visit_("key",t.key,s,i);if(e===r)return r;e===o&&(t.key=null);const n=visit_("value",t.value,s,i);if(n===r)return r;n===o&&(t.value=null)}return a}async function visitAsync(e,t){const s=initVisitor(t);if(n.isDocument(e)){await visitAsync_(null,e.contents,s,Object.freeze([e]))===o&&(e.contents=null)}else await visitAsync_(null,e,s,Object.freeze([]))}async function visitAsync_(e,t,s,i){const a=await callVisitor(e,t,s,i);if(n.isNode(a)||n.isPair(a))return replaceNode(e,i,a),visitAsync_(e,a,s,i);if("symbol"!=typeof a)if(n.isCollection(t)){i=Object.freeze(i.concat(t));for(let e=0;e<t.items.length;++e){const n=await visitAsync_(e,t.items[e],s,i);if("number"==typeof n)e=n-1;else{if(n===r)return r;n===o&&(t.items.splice(e,1),e-=1)}}}else if(n.isPair(t)){i=Object.freeze(i.concat(t));const e=await visitAsync_("key",t.key,s,i);if(e===r)return r;e===o&&(t.key=null);const n=await visitAsync_("value",t.value,s,i);if(n===r)return r;n===o&&(t.value=null)}return a}function initVisitor(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function callVisitor(e,t,s,r){return"function"==typeof s?s(e,t,r):n.isMap(t)?s.Map?.(e,t,r):n.isSeq(t)?s.Seq?.(e,t,r):n.isPair(t)?s.Pair?.(e,t,r):n.isScalar(t)?s.Scalar?.(e,t,r):n.isAlias(t)?s.Alias?.(e,t,r):void 0}function replaceNode(e,t,s){const r=t[t.length-1];if(n.isCollection(r))r.items[e]=s;else if(n.isPair(r))"key"===e?r.key=s:r.value=s;else{if(!n.isDocument(r)){const e=n.isAlias(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${e} parent`)}r.contents=s}}visit.BREAK=r,visit.SKIP=i,visit.REMOVE=o,visitAsync.BREAK=r,visitAsync.SKIP=i,visitAsync.REMOVE=o,t.visit=visit,t.visitAsync=visitAsync},9243:(e,t,s)=>{const n=s(857),r=s(6928);e.exports={pickFirstString:function pickFirstString(...e){for(const t of e)if("string"==typeof t&&t.trim().length)return t},resolveConfiguredPath:function resolveConfiguredPath(e,t,s){if("string"!=typeof e)return;let i=e.trim();if(!i.length)return;const o=n.homedir();return i=i.replace(/^~(?=$|[\/])/,o),i=i.replace(/\$\{workspaceFolder\}/g,t||""),i=i.replace(/\$\{env:([^}]+)\}/g,(e,t)=>process.env[t]||""),i=i.replace(/\$\{([^}]+)\}/g,(e,s)=>"workspaceFolder"===s?t||"":Object.prototype.hasOwnProperty.call(process.env,s)?process.env[s]:e),r.isAbsolute(i)?r.normalize(i):t?r.normalize(r.resolve(t,i)):s?r.normalize(r.resolve(s,i)):r.normalize(r.resolve(process.cwd(),i))},normalizeExtension:function normalizeExtension(e){if("string"!=typeof e)return;const t=e.trim().toLowerCase();return t?t.startsWith(".")?t:`.${t}`:void 0}}},9378:(e,t)=>{"use strict";t.containsNewline=function containsNewline(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes("\n"))return!0;if(e.end)for(const t of e.end)if("newline"===t.type)return!0;return!1;case"flow-collection":for(const t of e.items){for(const e of t.start)if("newline"===e.type)return!0;if(t.sep)for(const e of t.sep)if("newline"===e.type)return!0;if(containsNewline(t.key)||containsNewline(t.value))return!0}return!1;default:return!0}}},9637:(e,t,s)=>{"use strict";var n=s(484),r=s(9714);const i="<<",o={identify:e=>e===i||"symbol"==typeof e&&e.description===i,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new r.Scalar(Symbol(i)),{addToJSMap:addMergeToJSMap}),stringify:()=>i};function addMergeToJSMap(e,t,s){if(s=e&&n.isAlias(s)?s.resolve(e.doc):s,n.isSeq(s))for(const n of s.items)mergeValue(e,t,n);else if(Array.isArray(s))for(const n of s)mergeValue(e,t,n);else mergeValue(e,t,s)}function mergeValue(e,t,s){const r=e&&n.isAlias(s)?s.resolve(e.doc):s;if(!n.isMap(r))throw new Error("Merge sources must be maps or map aliases");const i=r.toJSON(null,e,Map);for(const[e,s]of i)t instanceof Map?t.has(e)||t.set(e,s):t instanceof Set?t.add(e):Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{value:s,writable:!0,enumerable:!0,configurable:!0});return t}t.addMergeToJSMap=addMergeToJSMap,t.isMergeKey=(e,t)=>(o.identify(t)||n.isScalar(t)&&(!t.type||t.type===r.Scalar.PLAIN)&&o.identify(t.value))&&e?.doc.schema.tags.some(e=>e.tag===o.tag&&e.default),t.merge=o},9714:(e,t,s)=>{"use strict";var n=s(484),r=s(8898),i=s(3732);class Scalar extends r.NodeBase{constructor(e){super(n.SCALAR),this.value=e}toJSON(e,t){return t?.keep?this.value:i.toJS(this.value,e,t)}toString(){return String(this.value)}}Scalar.BLOCK_FOLDED="BLOCK_FOLDED",Scalar.BLOCK_LITERAL="BLOCK_LITERAL",Scalar.PLAIN="PLAIN",Scalar.QUOTE_DOUBLE="QUOTE_DOUBLE",Scalar.QUOTE_SINGLE="QUOTE_SINGLE",t.Scalar=Scalar,t.isScalarValue=e=>!e||"function"!=typeof e&&"object"!=typeof e},9896:e=>{"use strict";e.exports=require("fs")}},t={};function __webpack_require__(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={id:s,loaded:!1,exports:{}};return e[s](r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.c=t,__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var s=__webpack_require__(__webpack_require__.s=3307);module.exports=s})();